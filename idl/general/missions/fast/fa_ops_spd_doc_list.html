<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>general/missions/fast/fa_ops</TITLE>
</head>
 
<body>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help2</CODE>.
<br>
<P>
<STRONG>Last modified: </STRONG>Mon Dec 15 18:16:58 2025.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>Directory Listing of Routines</H1></A>
<UL>
<H1>general/missions/fast/fa_ops</H1>
<LI><A HREF="#ADD_BTOT">ADD_BTOT</A>
<LI><A HREF="#ALLOCATEARRAY">ALLOCATEARRAY</A>
<LI><A HREF="#ANGLE_TO_BIN">ANGLE_TO_BIN</A>
<br>Returns the angle bin numbers in &quot;dat&quot; nearest to &quot;an&quot;
<LI><A HREF="#ANIMA_SUMPLOT">ANIMA_SUMPLOT</A>
<LI><A HREF="#ATT_ANIM">ATT_ANIM</A>
<LI><A HREF="#BMEAN">BMEAN</A>
<LI><A HREF="#C_2D">C_2D</A>
<br>Returns the sum of the counts in dat.data
<LI><A HREF="#CALC_FA_ESA_GEOM">CALC_FA_ESA_GEOM</A>
<LI><A HREF="#COL_TO_ROW">COL_TO_ROW</A>
<br>`col_to_row' is used to switch the majority of a multi-dimensional
<LI><A HREF="#COMPARE_ORBITS">COMPARE_ORBITS</A>
<LI><A HREF="#COMPUTEEPOCH">COMPUTEEPOCH</A>
<br>`computeEPOCH' is used to compute a CDF_EPOCH value from its
<LI><A HREF="#CONVERT_TMS_UNITS">CONVERT_TMS_UNITS</A>
<LI><A HREF="#CONVERT_TMS_UNITS2">CONVERT_TMS_UNITS2</A>
<LI><A HREF="#CUMDIST">CUMDIST</A>
<LI><A HREF="#CUMDIST_COMPARE">CUMDIST_COMPARE</A>
<LI><A HREF="#CURVOUT">CURVOUT</A>
<br>Calls IDL's CURVEFIT iteratively, rejecting outliers at each
<LI><A HREF="#DATA_ONLY">DATA_ONLY</A>
<LI><A HREF="#DATE_DOY_SEC">DATE_DOY_SEC</A>
<LI><A HREF="#DATESEC">DATESEC</A>
<LI><A HREF="#DATESEC_VAR">DATESEC_VAR</A>
<LI><A HREF="#DATESTRUCT">DATESTRUCT</A>
<LI><A HREF="#DATETIMESEC">DATETIMESEC</A>
<LI><A HREF="#DATETIMESEC_VAR">DATETIMESEC_VAR</A>
<LI><A HREF="#DEFAULT_DC_LIMITS">DEFAULT_DC_LIMITS</A>
<LI><A HREF="#DELTAS">DELTAS</A>
<LI><A HREF="#EB_CONFIG_TEST">EB_CONFIG_TEST</A>
<LI><A HREF="#EC_2D">EC_2D</A>
<br>Returns the characteristic energy, Ec, eV
<LI><A HREF="#EIESA_UNPACK_SURV_HDR">EIESA_UNPACK_SURV_HDR</A>
<LI><A HREF="#ENCODEEPOCH">ENCODEEPOCH</A>
<br>`encodeEPOCH' is used to encode a CDF_EPOCH value into a standard
<LI><A HREF="#ENCODEEPOCH1">ENCODEEPOCH1</A>
<br>`encodeEPOCH1' is used to encode a CDF_EPOCH value into an alternate
<LI><A HREF="#ENCODEEPOCH2">ENCODEEPOCH2</A>
<br>`encodeEPOCH2' is used to encode a CDF_EPOCH value into an alternate
<LI><A HREF="#ENCODEEPOCH3">ENCODEEPOCH3</A>
<br>`encodeEPOCH3' is used to encode a CDF_EPOCH value into an alternate
<LI><A HREF="#EPOCHBREAKDOWN">EPOCHBREAKDOWN</A>
<br>`EPOCHbreakdown' is used to break down a CDF_EPOCH value into its
<LI><A HREF="#ESA_ANODE_CALIB">ESA_ANODE_CALIB</A>
<LI><A HREF="#FA_ALMANAC_DIR">FA_ALMANAC_DIR</A>
<LI><A HREF="#FA_CDF_FILE_TEST">FA_CDF_FILE_TEST</A>
<br>Checks the current working directory for CDF files related to
<LI><A HREF="#FA_DESPIN_PROCESS[2]">FA_DESPIN_PROCESS[2]</A>
<br>For a given orbit or time interval, grab fields data already loaded
<LI><A HREF="#FA_DESPIN_PROCESS_VATT">FA_DESPIN_PROCESS_VATT</A>
<br>Fills variable attributes for FAST despun Electric Field variables.
<LI><A HREF="#FA_DESPIN_PROCESS[1]">FA_DESPIN_PROCESS[1]</A>
<br>For a given orbit or time interval, grab fields data already loaded
<LI><A HREF="#FA_EFI_PROBEDATAFILE">FA_EFI_PROBEDATAFILE</A>
<br>Creates a file /disks/data/fast/l2/fa_efi_probedata.csv
<LI><A HREF="#FA_FIELDS_BUFS">FA_FIELDS_BUFS</A>
<LI><A HREF="#FA_FIELDS_COMBINE">FA_FIELDS_COMBINE</A>
<LI><A HREF="#FA_FIELDS_CROSS">FA_FIELDS_CROSS</A>
<LI><A HREF="#FA_FIELDS_CYCLOTRON">FA_FIELDS_CYCLOTRON</A>
<LI><A HREF="#FA_FIELDS_DESPIN">FA_FIELDS_DESPIN</A>
<LI><A HREF="#FA_FIELDS_DESPIN2">FA_FIELDS_DESPIN2</A>
<LI><A HREF="#FA_FIELDS_DESPIN3">FA_FIELDS_DESPIN3</A>
<LI><A HREF="#FA_FIELDS_DESPIN3A">FA_FIELDS_DESPIN3A</A>
<LI><A HREF="#FA_FIELDS_DESPIN_16K">FA_FIELDS_DESPIN_16K</A>
<LI><A HREF="#FA_FIELDS_DESPIN_4K">FA_FIELDS_DESPIN_4K</A>
<LI><A HREF="#FA_FIELDS_DESPIN_HG">FA_FIELDS_DESPIN_HG</A>
<LI><A HREF="#FA_FIELDS_DESPIN_HSBM">FA_FIELDS_DESPIN_HSBM</A>
<LI><A HREF="#FA_FIELDS_DSP">FA_FIELDS_DSP</A>
<br>A high level routine which acquires
<LI><A HREF="#FA_FIELDS_FFT">FA_FIELDS_FFT</A>
<LI><A HREF="#FA_FIELDS_FILTER">FA_FIELDS_FILTER</A>
<LI><A HREF="#FA_FIELDS_MAGDC">FA_FIELDS_MAGDC</A>
<LI><A HREF="#FA_FIELDS_PHASE">FA_FIELDS_PHASE</A>
<LI><A HREF="#FA_FIELDS_PWT">FA_FIELDS_PWT</A>
<LI><A HREF="#FA_FIELDS_SFA">FA_FIELDS_SFA</A>
<LI><A HREF="#FA_FIELDS_SPEC">FA_FIELDS_SPEC</A>
<LI><A HREF="#FA_FIELDS_SPIN_AVE">FA_FIELDS_SPIN_AVE</A>
<LI><A HREF="#FA_FIELDS_SPINFIT">FA_FIELDS_SPINFIT</A>
<LI><A HREF="#FA_FIELDS_STORE">FA_FIELDS_STORE</A>
<LI><A HREF="#FA_FIELDS_UNITS">FA_FIELDS_UNITS</A>
<LI><A HREF="#FA_NADIR_FROM_HORIZ">FA_NADIR_FROM_HORIZ</A>
<br>Calculate the earth nadir from horizon crossing times for FAST.
<LI><A HREF="#FA_NADIR_SUN_AZIM">FA_NADIR_SUN_AZIM</A>
<br>For FAST, Get azimuthal angles in the spin plane between the
<LI><A HREF="#FA_OUTPUT_PATH">FA_OUTPUT_PATH</A>
<LI><A HREF="#FA_SHADOW">FA_SHADOW</A>
<LI><A HREF="#FA_SPEC_PROCESS">FA_SPEC_PROCESS</A>
<br>For a given orbit or time interval, grab fields spectral data (DSP,
<LI><A HREF="#FA_SPEC_PROCESS_VATT">FA_SPEC_PROCESS_VATT</A>
<br>Fills variable attributes for FAST SFa, Dsp variables.
<LI><A HREF="#FA_SUN_PULSE_FROM_AZIM">FA_SUN_PULSE_FROM_AZIM</A>
<br>For the FAST satellite, calculates the time of a sun pulse
<LI><A HREF="#FA_TS_EFF">FA_TS_EFF</A>
<LI><A HREF="#FA_TS_EFF_EQ">FA_TS_EFF_EQ</A>
<LI><A HREF="#FA_TTOF_CALIBRATION">FA_TTOF_CALIBRATION</A>
<LI><A HREF="#FA_WEB_PATH">FA_WEB_PATH</A>
<LI><A HREF="#FAIRB_FAST_CONJ">FAIRB_FAST_CONJ</A>
<LI><A HREF="#FAST_BATCH">FAST_BATCH</A>
<LI><A HREF="#FAST_E_BATCH">FAST_E_BATCH</A>
<LI><A HREF="#FAST_E_SUMMARY">FAST_E_SUMMARY</A>
<br>Generates ps, gif, cdf summary plots of FAST electron data.
<LI><A HREF="#FAST_EF_SUMMARY">FAST_EF_SUMMARY</A>
<br>Generates ps, gif, cdf summary plots of FAST electron data.
<LI><A HREF="#FAST_ELEC_SUMMARY">FAST_ELEC_SUMMARY</A>
<br>Generates a summary plot of FAST electron data for tplot.
<LI><A HREF="#FAST_ESA_BATCH">FAST_ESA_BATCH</A>
<LI><A HREF="#FAST_ESOLO_BATCH">FAST_ESOLO_BATCH</A>
<LI><A HREF="#FAST_FIELDS_BATCH">FAST_FIELDS_BATCH</A>
<LI><A HREF="#FAST_I_BATCH">FAST_I_BATCH</A>
<LI><A HREF="#FAST_I_SUMMARY">FAST_I_SUMMARY</A>
<br>Generates ps, gif, cdf summary plots of FAST ion data.
<LI><A HREF="#FAST_IE_BATCH">FAST_IE_BATCH</A>
<LI><A HREF="#FAST_IF_SUMMARY">FAST_IF_SUMMARY</A>
<br>Generates ps, gif, cdf summary plots of FAST ion data.
<LI><A HREF="#FAST_T_BATCH">FAST_T_BATCH</A>
<LI><A HREF="#FAST_T_SUMMARY">FAST_T_SUMMARY</A>
<br>Generates ps, gif, cdf summary plots of FAST teams data.
<LI><A HREF="#FASTHELP">FASTHELP</A>
<LI><A HREF="#FDF_ORB_WRITE">FDF_ORB_WRITE</A>
<LI><A HREF="#FF_DAT_TO_PTR">FF_DAT_TO_PTR</A>
<LI><A HREF="#FF_DCE_FIX">FF_DCE_FIX</A>
<LI><A HREF="#FF_DESPIN_HSBM">FF_DESPIN_HSBM</A>
<LI><A HREF="#FF_DESPIN_SVY_LONG">FF_DESPIN_SVY_LONG</A>
<LI><A HREF="#FF_DSP">FF_DSP</A>
<LI><A HREF="#FF_DSP_POWER">FF_DSP_POWER</A>
<br>computes integrated spectral density in a given frequency interval
<LI><A HREF="#FF_FIXTIME">FF_FIXTIME</A>
<LI><A HREF="#FF_INFO">FF_INFO</A>
<LI><A HREF="#FF_INTERP">FF_INTERP</A>
<LI><A HREF="#FF_MAG_BUFS">FF_MAG_BUFS</A>
<LI><A HREF="#FF_MAG_EXTEND">FF_MAG_EXTEND</A>
<LI><A HREF="#FF_MAG_REJECT">FF_MAG_REJECT</A>
<LI><A HREF="#FF_MAG_SPEED">FF_MAG_SPEED</A>
<LI><A HREF="#FF_MAG_SUN">FF_MAG_SUN</A>
<LI><A HREF="#FF_MAG_TORQUE">FF_MAG_TORQUE</A>
<LI><A HREF="#FF_MAG_TWC">FF_MAG_TWC</A>
<LI><A HREF="#FF_MAG_TWD">FF_MAG_TWD</A>
<LI><A HREF="#FF_MAG_TWKDAT">FF_MAG_TWKDAT</A>
<LI><A HREF="#FF_MAG_TWKFIT">FF_MAG_TWKFIT</A>
<LI><A HREF="#FF_MAGFIT">FF_MAGFIT</A>
<LI><A HREF="#FF_MAGFIT_SM">FF_MAGFIT_SM</A>
<LI><A HREF="#FF_MAGFIX">FF_MAGFIX</A>
<LI><A HREF="#FF_NOTCH">FF_NOTCH</A>
<LI><A HREF="#FF_PDQFIT">FF_PDQFIT</A>
<LI><A HREF="#FF_PHASE_ZC">FF_PHASE_ZC</A>
<LI><A HREF="#FF_POTENTIAL">FF_POTENTIAL</A>
<br>Estimate spacecraft floating potential using spin plane
<LI><A HREF="#FF_PTR_TO_DAT">FF_PTR_TO_DAT</A>
<LI><A HREF="#FF_QFIT">FF_QFIT</A>
<LI><A HREF="#FF_QUICKFIT">FF_QUICKFIT</A>
<LI><A HREF="#FF_REDUCE">FF_REDUCE</A>
<LI><A HREF="#FF_SHIFT_POLE">FF_SHIFT_POLE</A>
<LI><A HREF="#FF_SMOOTH">FF_SMOOTH</A>
<LI><A HREF="#FF_YLIM">FF_YLIM</A>
<LI><A HREF="#FILES_EXIST">FILES_EXIST</A>
<br>returns array of strings corresponding to input array of file specs
<LI><A HREF="#FILL_FA_ESA_FROM_TS_GET">FILL_FA_ESA_FROM_TS_GET</A>
<LI><A HREF="#FIND_LAST_EPOCH">FIND_LAST_EPOCH</A>
<LI><A HREF="#FRAC_INDICES">FRAC_INDICES</A>
<LI><A HREF="#GCLOSE">GCLOSE</A>
<LI><A HREF="#GEN_FA_K0_EES_GIFPS">GEN_FA_K0_EES_GIFPS</A>
<br>Generates gif and ps FAST electron key parameter data.
<LI><A HREF="#GEN_FA_K0_IES_GIFPS">GEN_FA_K0_IES_GIFPS</A>
<br>Generates gif and ps FAST ion key parameter data.
<LI><A HREF="#GEN_FA_K0_TMS_GIFPS">GEN_FA_K0_TMS_GIFPS</A>
<br>Generates gif and ps FAST TEAMS key parameter data.
<LI><A HREF="#GEOC2GEOD">GEOC2GEOD</A>
<LI><A HREF="#GEOMAG">GEOMAG</A>
<br>Gets geomag data kp, ap, and dsp for given times.
<LI><A HREF="#GET_1D_FROM_SDT_TEMPLATE">GET_1D_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_2D_FROM_SDT_TEMPLATE">GET_2D_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_2DT_TS">GET_2DT_TS</A>
<br>To generate time series data for &quot;tplot.pro&quot;
<LI><A HREF="#GET_3D_FROM_SDT_TEMPLATE">GET_3D_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_ARRAY_STRUC">GET_ARRAY_STRUC</A>
<br>Gets a structure from the common array_struc_com, see make_array_struc.pro
<LI><A HREF="#GET_CACHE_MD_FROM_SDT">GET_CACHE_MD_FROM_SDT</A>
<LI><A HREF="#GET_CACHE_TS_1P_FROM_SDT">GET_CACHE_TS_1P_FROM_SDT</A>
<LI><A HREF="#GET_DENSITY">GET_DENSITY</A>
<LI><A HREF="#GET_DQDS">GET_DQDS</A>
<LI><A HREF="#GET_DQI_INFO">GET_DQI_INFO</A>
<LI><A HREF="#GET_EN_SPEC_TS">GET_EN_SPEC_TS</A>
<br>Generates energy-time spectrogram data structures for tplot
<LI><A HREF="#GET_ESS">GET_ESS</A>
<br>To generate fast eesa survey data structures averaged over one spin.
<LI><A HREF="#GET_FA_2D_FIELDS">GET_FA_2D_FIELDS</A>
<LI><A HREF="#GET_FA_ATT_DIAG">GET_FA_ATT_DIAG</A>
<LI><A HREF="#GET_FA_ATTITUDE">GET_FA_ATTITUDE</A>
<LI><A HREF="#GET_FA_BDC">GET_FA_BDC</A>
<LI><A HREF="#GET_FA_EDC_LONG">GET_FA_EDC_LONG</A>
<LI><A HREF="#GET_FA_EEB">GET_FA_EEB</A>
<LI><A HREF="#GET_FA_EEB_C">GET_FA_EEB_C</A>
<LI><A HREF="#GET_FA_EEB_HDR">GET_FA_EEB_HDR</A>
<LI><A HREF="#GET_FA_EEB_TS">GET_FA_EEB_TS</A>
<LI><A HREF="#GET_FA_EES">GET_FA_EES</A>
<LI><A HREF="#GET_FA_EES_C">GET_FA_EES_C</A>
<LI><A HREF="#GET_FA_EES_HDR">GET_FA_EES_HDR</A>
<LI><A HREF="#GET_FA_EES_SP">GET_FA_EES_SP</A>
<br>To generate fast eesa survey data structures averaged over one spin.
<LI><A HREF="#GET_FA_EES_TS">GET_FA_EES_TS</A>
<LI><A HREF="#GET_FA_FDF_ATT">GET_FA_FDF_ATT</A>
<br>Get the spin attidude vector for the given time from
<LI><A HREF="#GET_FA_FIELDS">GET_FA_FIELDS</A>
<LI><A HREF="#GET_FA_FLDS">GET_FA_FLDS</A>
<LI><A HREF="#GET_FA_IEB">GET_FA_IEB</A>
<LI><A HREF="#GET_FA_IEB_C">GET_FA_IEB_C</A>
<LI><A HREF="#GET_FA_IEB_HDR">GET_FA_IEB_HDR</A>
<LI><A HREF="#GET_FA_IEB_TS">GET_FA_IEB_TS</A>
<LI><A HREF="#GET_FA_IES">GET_FA_IES</A>
<LI><A HREF="#GET_FA_IES_C">GET_FA_IES_C</A>
<LI><A HREF="#GET_FA_IES_HDR">GET_FA_IES_HDR</A>
<LI><A HREF="#GET_FA_IES_SP">GET_FA_IES_SP</A>
<br>To generate fast iesa survey data structures averaged over one spin.
<LI><A HREF="#GET_FA_IES_TS">GET_FA_IES_TS</A>
<LI><A HREF="#GET_FA_MSCRUB_MULTERRS">GET_FA_MSCRUB_MULTERRS</A>
<LI><A HREF="#GET_FA_MSCRUB_SINGERRS">GET_FA_MSCRUB_SINGERRS</A>
<LI><A HREF="#GET_FA_ORBATT">GET_FA_ORBATT</A>
<LI><A HREF="#GET_FA_ORBIT">GET_FA_ORBIT</A>
<br>Computes orbit vectors for a set of times extending over a given timespan.
<LI><A HREF="#GET_FA_ORBIT_GEOMAG">GET_FA_ORBIT_GEOMAG</A>
<br>Gets geomag data kp, ap, and dsp for given orbit.  Data are
<LI><A HREF="#GET_FA_ORBIT_TIMES">GET_FA_ORBIT_TIMES</A>
<LI><A HREF="#GET_FA_ORBIT_TIMES_DB">GET_FA_ORBIT_TIMES_DB</A>
<br>Obtains orbit start, stop, north and south pole crossing times
<LI><A HREF="#GET_FA_POTENTIAL">GET_FA_POTENTIAL</A>
<br>To obtain the spacecraft potential for FAST in fa_fields
<LI><A HREF="#GET_FA_SEB">GET_FA_SEB</A>
<LI><A HREF="#GET_FA_SEB1">GET_FA_SEB1</A>
<LI><A HREF="#GET_FA_SEB1_C">GET_FA_SEB1_C</A>
<LI><A HREF="#GET_FA_SEB1_HDR">GET_FA_SEB1_HDR</A>
<LI><A HREF="#GET_FA_SEB1_TS">GET_FA_SEB1_TS</A>
<LI><A HREF="#GET_FA_SEB2">GET_FA_SEB2</A>
<LI><A HREF="#GET_FA_SEB2_C">GET_FA_SEB2_C</A>
<LI><A HREF="#GET_FA_SEB2_HDR">GET_FA_SEB2_HDR</A>
<LI><A HREF="#GET_FA_SEB2_TS">GET_FA_SEB2_TS</A>
<LI><A HREF="#GET_FA_SEB3">GET_FA_SEB3</A>
<LI><A HREF="#GET_FA_SEB3_C">GET_FA_SEB3_C</A>
<LI><A HREF="#GET_FA_SEB3_HDR">GET_FA_SEB3_HDR</A>
<LI><A HREF="#GET_FA_SEB3_TS">GET_FA_SEB3_TS</A>
<LI><A HREF="#GET_FA_SEB4">GET_FA_SEB4</A>
<LI><A HREF="#GET_FA_SEB4_C">GET_FA_SEB4_C</A>
<LI><A HREF="#GET_FA_SEB4_HDR">GET_FA_SEB4_HDR</A>
<LI><A HREF="#GET_FA_SEB4_TS">GET_FA_SEB4_TS</A>
<LI><A HREF="#GET_FA_SEB5">GET_FA_SEB5</A>
<LI><A HREF="#GET_FA_SEB5_C">GET_FA_SEB5_C</A>
<LI><A HREF="#GET_FA_SEB5_HDR">GET_FA_SEB5_HDR</A>
<LI><A HREF="#GET_FA_SEB5_TS">GET_FA_SEB5_TS</A>
<LI><A HREF="#GET_FA_SEB6">GET_FA_SEB6</A>
<LI><A HREF="#GET_FA_SEB6_C">GET_FA_SEB6_C</A>
<LI><A HREF="#GET_FA_SEB6_HDR">GET_FA_SEB6_HDR</A>
<LI><A HREF="#GET_FA_SEB6_TS">GET_FA_SEB6_TS</A>
<LI><A HREF="#GET_FA_SEB_C">GET_FA_SEB_C</A>
<LI><A HREF="#GET_FA_SEB_HDR">GET_FA_SEB_HDR</A>
<LI><A HREF="#GET_FA_SEB_TS">GET_FA_SEB_TS</A>
<LI><A HREF="#GET_FA_SES">GET_FA_SES</A>
<LI><A HREF="#GET_FA_SES_C">GET_FA_SES_C</A>
<LI><A HREF="#GET_FA_SES_HDR">GET_FA_SES_HDR</A>
<LI><A HREF="#GET_FA_SES_TS">GET_FA_SES_TS</A>
<LI><A HREF="#GET_FA_SPIN_RATE">GET_FA_SPIN_RATE</A>
<LI><A HREF="#GET_FA_SUNNADIR">GET_FA_SUNNADIR</A>
<br>For the FAST satellite, calculates the the simulated sun pulse
<LI><A HREF="#GET_FA_TB_3D_EQ">GET_FA_TB_3D_EQ</A>
<LI><A HREF="#GET_FA_TB_EQ">GET_FA_TB_EQ</A>
<LI><A HREF="#GET_FA_TB_HDR">GET_FA_TB_HDR</A>
<LI><A HREF="#GET_FA_TBA">GET_FA_TBA</A>
<LI><A HREF="#GET_FA_TBA_3D">GET_FA_TBA_3D</A>
<LI><A HREF="#GET_FA_TBA_EQ">GET_FA_TBA_EQ</A>
<LI><A HREF="#GET_FA_TBALL_TS">GET_FA_TBALL_TS</A>
<LI><A HREF="#GET_FA_TBH">GET_FA_TBH</A>
<LI><A HREF="#GET_FA_TBH_3D">GET_FA_TBH_3D</A>
<LI><A HREF="#GET_FA_TBH_EQ">GET_FA_TBH_EQ</A>
<LI><A HREF="#GET_FA_TBO">GET_FA_TBO</A>
<LI><A HREF="#GET_FA_TBO_3D">GET_FA_TBO_3D</A>
<LI><A HREF="#GET_FA_TBO_EQ">GET_FA_TBO_EQ</A>
<LI><A HREF="#GET_FA_TBP">GET_FA_TBP</A>
<LI><A HREF="#GET_FA_TBP_3D">GET_FA_TBP_3D</A>
<LI><A HREF="#GET_FA_TBP_EQ">GET_FA_TBP_EQ</A>
<LI><A HREF="#GET_FA_TH">GET_FA_TH</A>
<LI><A HREF="#GET_FA_TH_3D">GET_FA_TH_3D</A>
<LI><A HREF="#GET_FA_TH_3D_EQ">GET_FA_TH_3D_EQ</A>
<LI><A HREF="#GET_FA_TH_HDR">GET_FA_TH_HDR</A>
<LI><A HREF="#GET_FA_TPA">GET_FA_TPA</A>
<LI><A HREF="#GET_FA_TPAH_HDR">GET_FA_TPAH_HDR</A>
<LI><A HREF="#GET_FA_TPH">GET_FA_TPH</A>
<LI><A HREF="#GET_FA_TPO">GET_FA_TPO</A>
<LI><A HREF="#GET_FA_TPOP_HDR">GET_FA_TPOP_HDR</A>
<LI><A HREF="#GET_FA_TPP">GET_FA_TPP</A>
<LI><A HREF="#GET_FA_TSA">GET_FA_TSA</A>
<LI><A HREF="#GET_FA_TSA_EQ">GET_FA_TSA_EQ</A>
<LI><A HREF="#GET_FA_TSAH_HDR">GET_FA_TSAH_HDR</A>
<LI><A HREF="#GET_FA_TSH_EQ">GET_FA_TSH_EQ</A>
<LI><A HREF="#GET_FA_TSO_EQ">GET_FA_TSO_EQ</A>
<LI><A HREF="#GET_FA_TSO_EQ_SP">GET_FA_TSO_EQ_SP</A>
<LI><A HREF="#GET_FA_TSO_SP">GET_FA_TSO_SP</A>
<LI><A HREF="#GET_FA_TSOP_HDR">GET_FA_TSOP_HDR</A>
<LI><A HREF="#GET_FA_TSP">GET_FA_TSP</A>
<LI><A HREF="#GET_FA_TSP_EQ">GET_FA_TSP_EQ</A>
<LI><A HREF="#GET_FA_TSP_EQ_SP">GET_FA_TSP_EQ_SP</A>
<LI><A HREF="#GET_FA_TSP_SP">GET_FA_TSP_SP</A>
<LI><A HREF="#GET_FA_V158">GET_FA_V158</A>
<LI><A HREF="#GET_FIELDS_MODE">GET_FIELDS_MODE</A>
<LI><A HREF="#GET_ISS">GET_ISS</A>
<br>To generate fast iesa survey data structures averaged over one spin.
<LI><A HREF="#GET_MD_FROM_SDT">GET_MD_FROM_SDT</A>
<LI><A HREF="#GET_MD_TS_FROM_SDT">GET_MD_TS_FROM_SDT</A>
<LI><A HREF="#GET_MD_TS_FROM_SDT_TEMPLATE">GET_MD_TS_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_ORBFILE_EPOCH">GET_ORBFILE_EPOCH</A>
<LI><A HREF="#GET_PA_SPEC_TS">GET_PA_SPEC_TS</A>
<br>Generates pitch angle vs. time spectrogram data structures for tplot
<LI><A HREF="#GET_PO_ORBIT">GET_PO_ORBIT</A>
<LI><A HREF="#GET_SDT_TIMESPAN">GET_SDT_TIMESPAN</A>
<LI><A HREF="#GET_TMS_ANG">GET_TMS_ANG</A>
<LI><A HREF="#GET_TMS_HM_SPEC">GET_TMS_HM_SPEC</A>
<br>Generates energy-time spectrogram data structures for tplot
<LI><A HREF="#GET_TS_1P_FROM_SDT">GET_TS_1P_FROM_SDT</A>
<LI><A HREF="#GET_TS_1P_FROM_SDT_TEMPLATE">GET_TS_1P_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_TS_FROM_SDT">GET_TS_FROM_SDT</A>
<LI><A HREF="#GET_TS_FROM_SDT_TEMPLATE">GET_TS_FROM_SDT_TEMPLATE</A>
<LI><A HREF="#GET_V1_V4_SURV">GET_V1_V4_SURV</A>
<LI><A HREF="#GETSPEC">GETSPEC</A>
<LI><A HREF="#GOPEN">GOPEN</A>
<br>Prepare to put out a GIF file.
<LI><A HREF="#GOPEN_COM">GOPEN_COM</A>
<LI><A HREF="#GTS">GTS</A>
<LI><A HREF="#GTS_BATCH">GTS_BATCH</A>
<LI><A HREF="#GTS_CONCATENATE">GTS_CONCATENATE</A>
<LI><A HREF="#HEAD">HEAD</A>
<LI><A HREF="#HELPFAST">HELPFAST</A>
<LI><A HREF="#HIST">HIST</A>
<LI><A HREF="#HIST_NORM">HIST_NORM</A>
<LI><A HREF="#ICON_CROSSING_IDL5">ICON_CROSSING_IDL5</A>
<br>Add a small plot to the summary plots showing the auroral region and
<LI><A HREF="#INREAL">INREAL</A>
<LI><A HREF="#INT_UP_TO">INT_UP_TO</A>
<LI><A HREF="#IS_LEAP_YEAR">IS_LEAP_YEAR</A>
<LI><A HREF="#ISIN">ISIN</A>
<LI><A HREF="#J_2D">J_2D</A>
<br>Returns the field aligned flux, Jz, #/cm^2-sec
<LI><A HREF="#J_2D_B">J_2D_B</A>
<br>Returns the field aligned flux, Jz, #/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#J_2D_FS">J_2D_FS</A>
<br>Returns the field aligned flux, Jz, #/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam.
<LI><A HREF="#JE_2D">JE_2D</A>
<br>Returns the field aligned energy flux, JEz, ergs/cm^2-sec
<LI><A HREF="#JE_2D_B">JE_2D_B</A>
<br>Returns the field aligned energy flux, JEz, ergs/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#JE_2D_FS">JE_2D_FS</A>
<br>Returns the field aligned energy flux, JEz, ergs/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#KILL_RKL">KILL_RKL</A>
<LI><A HREF="#KILLSDT0">KILLSDT0</A>
<LI><A HREF="#KILLSDT_ALL">KILLSDT_ALL</A>
<LI><A HREF="#LEGENDRE">LEGENDRE</A>
<LI><A HREF="#LOAD_FA_K0_ACF">LOAD_FA_K0_ACF</A>
<br>Load summary data from the FAST AC fields instrument into TPLOT
<LI><A HREF="#LOAD_FA_K0_DCF">LOAD_FA_K0_DCF</A>
<br>Load summary data from the FAST DC fields instrument into TPLOT
<LI><A HREF="#LOAD_FA_K0_EES">LOAD_FA_K0_EES</A>
<br>Load summary data from the FAST electron experiment into tplot structure.
<LI><A HREF="#LOAD_FA_K0_EES_DAY">LOAD_FA_K0_EES_DAY</A>
<br>Load daily summary data from the FAST electron experiment into tplot structure.
<LI><A HREF="#LOAD_FA_K0_IES">LOAD_FA_K0_IES</A>
<br>Load summary data from the FAST ion experiment into tplot structure.
<LI><A HREF="#LOAD_FA_K0_IES_DAY">LOAD_FA_K0_IES_DAY</A>
<br>Load daily summary data from the FAST ion experiment into tplot structure.
<LI><A HREF="#LOAD_FA_K0_TMS">LOAD_FA_K0_TMS</A>
<br>Load summary data from the FAST TEAMS experiment into tplot structure.
<LI><A HREF="#MAKE5SEC">MAKE5SEC</A>
<LI><A HREF="#MAKE_ARRAY_STRUC">MAKE_ARRAY_STRUC</A>
<br>Makes an array of structures from input function, output used by get_array_struc.pro
<LI><A HREF="#MAKE_DATA_DOUBLE">MAKE_DATA_DOUBLE</A>
<LI><A HREF="#MAKE_FA_ESA_STRUCT">MAKE_FA_ESA_STRUCT</A>
<LI><A HREF="#MAKE_QUALITY">MAKE_QUALITY</A>
<LI><A HREF="#MATFROMBAS">MATFROMBAS</A>
<LI><A HREF="#MAXWELLIAN_1">MAXWELLIAN_1</A>
<br>Procedure returns maxwellian function f(x,a) and df/da, where f=a0*exp(a1*x), x-vector of energies.
<LI><A HREF="#MCP">MCP</A>
<br>MCP (Map CDF Parameter) is used to map (look up) the numeric value
<LI><A HREF="#MD_DIMS_OK">MD_DIMS_OK</A>
<LI><A HREF="#MII">MII</A>
<br>MII (Map Internal Interface) is used to map (look up) the numeric value
<LI><A HREF="#MINMAX_RANGE">MINMAX_RANGE</A>
<LI><A HREF="#MISSING_DQDS">MISSING_DQDS</A>
<LI><A HREF="#MISSING_TAGS">MISSING_TAGS</A>
<LI><A HREF="#MONTHYRFROM">MONTHYRFROM</A>
<LI><A HREF="#MSC">MSC</A>
<br>MSC (Map Status Code) is used to map (look up) the numeric value
<LI><A HREF="#N_2D">N_2D</A>
<br>Returns the density, n, 1/cm^3
<LI><A HREF="#N_2D_B">N_2D_B</A>
<br>Returns the density, n, 1/cm^3, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#N_2D_FS">N_2D_FS</A>
<br>Returns the density, n, 1/cm^3, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#NAN_GAP">NAN_GAP</A>
<LI><A HREF="#NOISE">NOISE</A>
<LI><A HREF="#NORMN3">NORMN3</A>
<LI><A HREF="#NOTIN">NOTIN</A>
<br>Function to return an array of values in array &quot;a&quot; that are exclusive
<LI><A HREF="#P_2D">P_2D</A>
<br>Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3
<LI><A HREF="#P_2D_B">P_2D_B</A>
<br>Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3, z along B, off diagonal terms are zero
<LI><A HREF="#P_2D_FS">P_2D_FS</A>
<br>Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3, z along B, off diagonal terms are zero
<LI><A HREF="#PARSEEPOCH">PARSEEPOCH</A>
<br>`parseEPOCH' is used to parse a CDF_EPOCH value from the standard
<LI><A HREF="#PDQPLOT">PDQPLOT</A>
<LI><A HREF="#PLOT_FA_ATT">PLOT_FA_ATT</A>
<LI><A HREF="#PLOT_FA_K0_EES">PLOT_FA_K0_EES</A>
<br>Plots FAST electron key parameter data.
<LI><A HREF="#PLOT_FA_K0_IES">PLOT_FA_K0_IES</A>
<br>Plots FAST ion key parameter data.
<LI><A HREF="#PLOT_FA_K0_TMS">PLOT_FA_K0_TMS</A>
<br>Plots FAST TEAMS key parameter data.
<LI><A HREF="#PLOT_ORBIT2">PLOT_ORBIT2</A>
<LI><A HREF="#PLOT_PO_OVERLAY">PLOT_PO_OVERLAY</A>
<LI><A HREF="#PLOT_TMS_COUNTS[1]">PLOT_TMS_COUNTS[1]</A>
<LI><A HREF="#PLOT_TMS_COUNTS[2]">PLOT_TMS_COUNTS[2]</A>
<LI><A HREF="#POLY_OUT">POLY_OUT</A>
<LI><A HREF="#POWER_SPEC">POWER_SPEC</A>
<LI><A HREF="#RAVEN_SUN_POS">RAVEN_SUN_POS</A>
<LI><A HREF="#READ_ASCII_NONX">READ_ASCII_NONX</A>
<br>Read data from an ASCII file into IDL. (Identical to
<LI><A HREF="#READ_AU_ULAW">READ_AU_ULAW</A>
<LI><A HREF="#REDUCE_RESOLUTION">REDUCE_RESOLUTION</A>
<LI><A HREF="#ROTMAT">ROTMAT</A>
<br>generates rotation matrices for coordinate transformations for a given time
<LI><A HREF="#ROW_TO_COL">ROW_TO_COL</A>
<br>`row_to_col' is used to switch the majority of a multi-dimensional
<LI><A HREF="#RUN_CMD_FILE">RUN_CMD_FILE</A>
<LI><A HREF="#RUN_DESPIN_TEST">RUN_DESPIN_TEST</A>
<LI><A HREF="#RUN_PROCESS_DESPIN_E16K">RUN_PROCESS_DESPIN_E16K</A>
<LI><A HREF="#RUN_PROCESS_DESPIN_E4K">RUN_PROCESS_DESPIN_E4K</A>
<LI><A HREF="#RUN_PROCESS_DESPIN_ESV">RUN_PROCESS_DESPIN_ESV</A>
<LI><A HREF="#RUN_PROCESS_DESPIN_ESV_LONG">RUN_PROCESS_DESPIN_ESV_LONG</A>
<LI><A HREF="#RUN_PROCESS_DSP">RUN_PROCESS_DSP</A>
<LI><A HREF="#RUN_PROCESS_SFA">RUN_PROCESS_SFA</A>
<LI><A HREF="#SDT_DATA_CACHE_DEFS">SDT_DATA_CACHE_DEFS</A>
<LI><A HREF="#SEARCH_FA_INDEX">SEARCH_FA_INDEX</A>
<LI><A HREF="#SECDATE">SECDATE</A>
<LI><A HREF="#SECDATETIME">SECDATETIME</A>
<LI><A HREF="#SECTIME">SECTIME</A>
<LI><A HREF="#SELECT_RANGE">SELECT_RANGE</A>
<LI><A HREF="#SERIES_COMPRESS">SERIES_COMPRESS</A>
<LI><A HREF="#SHOW_DQIS">SHOW_DQIS</A>
<LI><A HREF="#SOLAR_POS">SOLAR_POS</A>
<LI><A HREF="#STARTUP">STARTUP</A>
<LI><A HREF="#STR_TO_TIME">STR_TO_TIME</A>
<LI><A HREF="#STRARR_TO_ARRSTR">STRARR_TO_ARRSTR</A>
<br>convert a structure of time-based arrays to a time-based array of structures
<LI><A HREF="#SUBSTR">SUBSTR</A>
<br>a function for replacing substrings inside strings.
<LI><A HREF="#SUM3D_HDR">SUM3D_HDR</A>
<LI><A HREF="#SVDOUT">SVDOUT</A>
<LI><A HREF="#SYBCON">SYBCON</A>
<br>Create an instance of the sybcon class to manage
<LI><A HREF="#SYBCON__FETCH">SYBCON__FETCH</A>
<LI><A HREF="#SYBCON__RESULTS">SYBCON__RESULTS</A>
<LI><A HREF="#SYBCON__SEND">SYBCON__SEND</A>
<LI><A HREF="#T_2D">T_2D</A>
<br>Returns the temperature, [Tx,Ty,Tz,Tavg], eV
<LI><A HREF="#T_2D_B">T_2D_B</A>
<br>Returns the temperature, [Tx,Ty,Tz,Tavg], eV, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#T_2D_FS">T_2D_FS</A>
<br>Returns the temperature, [Tx,Ty,Tz,Tavg], eV, assumes a narrow (&lt; 5 deg) field aligned beam
<LI><A HREF="#TAIL">TAIL</A>
<LI><A HREF="#TIME_ALIGN">TIME_ALIGN</A>
<LI><A HREF="#TIME_TO_STR">TIME_TO_STR</A>
<LI><A HREF="#TIMESEC">TIMESEC</A>
<LI><A HREF="#TIMETICK">TIMETICK</A>
<LI><A HREF="#TMS_HIMASS_GET_ANGLES">TMS_HIMASS_GET_ANGLES</A>
<LI><A HREF="#TMS_HIMASS_GET_MASSES">TMS_HIMASS_GET_MASSES</A>
<LI><A HREF="#TMS_SURV_GET_ANGLES">TMS_SURV_GET_ANGLES</A>
<LI><A HREF="#TOTAL_TRAILING_DIMS">TOTAL_TRAILING_DIMS</A>
<LI><A HREF="#UCLA_MAG_DESPIN">UCLA_MAG_DESPIN</A>
<LI><A HREF="#[6]">[6]</A>
<LI><A HREF="#[7]">[7]</A>
<LI><A HREF="#[8]">[8]</A>
<LI><A HREF="#[9]">[9]</A>
<LI><A HREF="#SVDFIT4">SVDFIT4</A>
<br>Perform a general least squares fit with optional error estimates.
<LI><A HREF="#UNWRAP">UNWRAP</A>
<br>This function unwraps things that have been modulo'd by x, (like the
<LI><A HREF="#UPDATE_FA_ATT">UPDATE_FA_ATT</A>
<br>Update attitude rows in database with level 0 attitude from FDF files.
<LI><A HREF="#V_2D">V_2D</A>
<br>Returns the velocity, [Vx,Vy,Vz], km/s
<LI><A HREF="#V_2D_B">V_2D_B</A>
<br>Returns the velocity, [Vx,Vy,Vz], km/s
<LI><A HREF="#V_2D_FS">V_2D_FS</A>
<br>Returns the velocity, [Vx,Vy,Vz], km/s
<LI><A HREF="#VAR_RANGE">VAR_RANGE</A>
<LI><A HREF="#VEL_DISP_FIT">VEL_DISP_FIT</A>
<LI><A HREF="#VTH_2D">VTH_2D</A>
<br>Returns the thermal velocity, [Vthx,Vthy,Vthz,Vthavg], km/s
<LI><A HREF="#VTH_2D_FS">VTH_2D_FS</A>
<br>Returns the thermal velocity, [Vthx,Vthy,Vthz,Vthavg], km/s
<LI><A HREF="#WCOPY">WCOPY</A>
<LI><A HREF="#WHAT_FA_SEES">WHAT_FA_SEES</A>
<LI><A HREF="#WHAT_ORBIT_IS">WHAT_ORBIT_IS</A>
<LI><A HREF="#WRITE_AU_ULAW">WRITE_AU_ULAW</A>
<LI><A HREF="#XYOUTS2">XYOUTS2</A>
<br>Same as xyouts except will normalize to the current plot box
<LI><A HREF="#YRFROM">YRFROM</A>
<br>
</UL><P>
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="ADD_BTOT">
<H2>ADD_BTOT</H2></A>
<A HREF="#ALLOCATEARRAY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PRO: ADD_BTOT



 PURPOSE: Adds Btot and B_Spin_angle to MagDC structure.

 CALLING: add_btot, MagDC
 	   Pretty simple! 
                         
 INPUTS: A valid MadDC structure, ie MagDC = get_fa_fields('MagDC, /all).
       
 KEYWORD PARAMETERS:  	NSMOOTH, set to 0 if you do not want to smooth.

 OUTPUTS: Added th MagDC structure.

 SIDE EFFECTS: May blow memory.

 INITIAL VERSION: REE 96-11-20
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/add_btot.pro">general/missions/fast/fa_ops/add_btot.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ALLOCATEARRAY">
<H2>ALLOCATEARRAY</H2></A>
<A HREF="#ADD_BTOT">[Previous Routine]</A>
<A HREF="#ANGLE_TO_BIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 ALLOCATEARRAY

 DESCRIPTION:

	function to allocate an array of a given type and size.  The
 	types are those defined for the FAST SDT to IDL interface.

 CALLING SEQUENCE:

 	data = allocatearray (type, nDims, dim(3))

 ARGUMENTS:

	type: Specifies the type of array to allocate:
		1 = BYTE
		2 = INT
		3 = LONG
		4 = FLOAT
		5 = DOUBLE
	nDims: gives the number of dimensions for the output array, 3 max.
	dims(3): gives the size of each dimension.

 RETURN VALUE:

	Upon success, the resulting array is returned, filled with 0's.
	Upon failure, scaler INT is returned set to -1 

 REVISION HISTORY:

	@(#)allocatearray.pro	1.1 06/15/95
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/allocatearray.pro">general/missions/fast/fa_ops/allocatearray.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ANGLE_TO_BIN">
<H2>ANGLE_TO_BIN</H2></A>
<A HREF="#ALLOCATEARRAY">[Previous Routine]</A>
<A HREF="#ANIMA_SUMPLOT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	angle_to_bin(dat,an)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_eeb, etc.
	an:	real,fltarr(i),	2D - real or float array of pitch angle values 
		fltarr(i,2),	3D - theta=fltarr(*,0), phi=fltarr(*,1)
KEYWORD:
	EBIN	int,intarr(i)	optional, energy bins corresponding to &quot;an&quot;
				used when angles depend upon energy bin
PURPOSE:
	Returns the angle bin numbers in &quot;dat&quot; nearest to &quot;an&quot;

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-4-23		J.McFadden
	96-8-27		J.McFadden	Changed algorithm to include (mod 360.) and
					handle arbitrary order in dat.theta or dat.phi
	98-4-24		J.McFadden	Corrected typos in documentation
</PRE><P>
<STRONG>(See <A href="fa_ops/angle_to_bin.pro">general/missions/fast/fa_ops/angle_to_bin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ANIMA_SUMPLOT">
<H2>ANIMA_SUMPLOT</H2></A>
<A HREF="#ANGLE_TO_BIN">[Previous Routine]</A>
<A HREF="#ATT_ANIM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

 anima_sumplot

 PURPOSE:

 The fastest CDF viewer in the west.  Saves a series of summary plots
 in memory for later rolodex-style viewing using the widget-based
 routine xinteranimate.

 USAGE:

 After invoking anima_sumplot, minimize the window until the
 procedure is ready to display all plots.  Three beeps means it is
 ready.  Restore the window and hit any key to start viewing.  Pause
 the animation, click on the frame slider, and then use the cursor
 keys to flip through the plots.  Pixmaps are purged from memory upon
 quitting.

 You can view eESA and iESA plots separately (qty='ees' or 'ies') or
 together (qty='esa').  The latter method will display eESA and iESA
 sequentially for each orbit.

 ACF and DCF may not be presented in tandem like the ESA plots.
 
 You cannot change the plot interval of the static frames using
 tlimit.

 Note well the functionality of the ZOOM keyword.  It is very useful.

 INPUTS:

    qty       A string: 'ees', 'ies', 'esa', 'tms', 'acf', 'dcf'

    firstorb  The first orbit in the display sequence.

    lastorb   The last orbit.

 KEYWORDS:

    ZOOM      Set this keyword to check for two data collection
              periods per orbit.  If two distinct intervals of data
              are detected, the data is divided into two frames,
              eliminating the gap.  An 'N' or 'S' will be placed in
              the upper right corner of the frame depending on
              whether the frame is the first or second in a pair.

              Setting this keyword when viewing CDFs containing only
              one data collection period wastes memory.  For this,
              zoom is not recommended for orbits prior to 2493.

              This keyword does not work when viewing ACF plots.

 CREATED:
    
    1997/7/17
    by J. Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/anima_sumplot.pro">general/missions/fast/fa_ops/anima_sumplot.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ATT_ANIM">
<H2>ATT_ANIM</H2></A>
<A HREF="#ANIMA_SUMPLOT">[Previous Routine]</A>
<A HREF="#BMEAN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

 att_anim.pro

 PURPOSE:

   Animates the orientation of the FAST spacecraft.  Shows model
   magnetic field, spacecraft velocity, and Sun direction in the s/c
   spin plane.  Also tells the angles of these vectors out of the
   spin plane as well as other orbit quantities.

 INPUTS:

   TIME     Array or scalar.  Scalar may be string or double float.
            If scalar, then time array is constructed from 30 points
            over ten seconds centered on the time argument.

 KEYWORDS:

   NOTEXT   Set this to suppress printing of textual info so the output
            image may be used as an icon.

   N_FRAMES The number of frames in the animation.  Default is 30.
            Has no effect if TIME is an array.

 NOTES:

   Created: 98-4-8
   Creator: J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/att_anim.pro">general/missions/fast/fa_ops/att_anim.pro</A>)</STRONG><P>
<HR>
 
<A NAME="BMEAN">
<H2>BMEAN</H2></A>
<A HREF="#ATT_ANIM">[Previous Routine]</A>
<A HREF="#CALC_FA_ESA_GEOM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 BMEAN - plots the mean of y in a set of x bins.

    I believe all the keywords that can be passed to HISTOGRAM can
  also be passed to BMEAN. By default, BMEAN makes a plot with an
  error bar, you can use NO_PLOT and/or NO_ERROR to avoid this. 
 
 OTHER KEYWORDS: 

   MEDIAN - comupute binned median instead of mean

   TOTAL - don't divide by number of points per bin!

   XRANGE - the [min, max] xvalues to consider in the binning. 

   M**_YVALUE - The min and max y values to consider in the mean,
                median or total. 

   YRANGE - the range of y to *plot*. Y's outside this range will
            still be used in the calculation. 

   BMEAN, SIGMA, NPTS - named variables for returning &quot;the answer&quot;,
                        the error bar, and the number of points per
                        bin, respectively.

   
 
</PRE><P>
<STRONG>(See <A href="fa_ops/bmean.pro">general/missions/fast/fa_ops/bmean.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CALC_FA_ESA_GEOM">
<H2>CALC_FA_ESA_GEOM</H2></A>
<A HREF="#BMEAN">[Previous Routine]</A>
<A HREF="#COL_TO_ROW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 CALC_ESA_GEOM

 DESCRIPTION:

	function to get esa geometry factors

 CALLING SEQUENCE:

 	data =  calc_esa_geom(esa_data_struct)

 ARGUMENTS:

	esa_data_struct	This is a struct return by a get_?esa_* ()
			routine.  This must contain the header_bytes
			and time structure tag.

 RETURN VALUE:

	Upon success, an array of floats containing the geometry
	factor for each energy bin.  else a scaler -1 is returned.

 REVISION HISTORY:

	@(#)calc_fa_esa_geom.pro	1.2 03/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '96
</PRE><P>
<STRONG>(See <A href="fa_ops/calc_fa_esa_geom.pro">general/missions/fast/fa_ops/calc_fa_esa_geom.pro</A>)</STRONG><P>
<HR>
 
<A NAME="COL_TO_ROW">
<H2>COL_TO_ROW</H2></A>
<A HREF="#CALC_FA_ESA_GEOM">[Previous Routine]</A>
<A HREF="#COMPARE_ORBITS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       col_to_row

 PURPOSE:
       `col_to_row' is used to switch the majority of a multi-dimensional
       array from column-major to row-major.  This function would be used
       before writing an array of values (created by IDL) to a row-major
       CDF using `CDFvarHyperPut' (or `CDFlib').

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       status = col_to_row (iBuffer, oBuffer, numDims, dimSizes, numBytes, $
                            numRecs)

 INPUTS:
       iBuffer:        DATA TYPE DEPENDENT.  The multi-dimensional array
                       (IDL variable) whose majority is to be reversed.
       numDims:        LONG.  The number of dimensions (in each record).
       dimSizes:       LONG array.  The dimension sizes (in each record).
       numBytes:       LONG.  The number of bytes per value.
       numRecs:        LONG.  The number of CDF records in the buffer.
                       Note that the majority is only changed within each
                       record - the ordering of the records remains the
                       same (the last dimension of the IDL variable is not
                       affected).

       All input variables must have been created/initialized before calling
       `col_to_row'.

 OUTPUTS:
       oBuffer:        DATA TYPE DEPENDENT.  A newly created/recreated IDL
                       variable (with the same dimensionality as `iBuffer')
                       with reversed (row-major) majority.

       status:         LONG.  A completion status code.  CDF_OK indicates
                       success.  The possible status codes are defined by
                       `cdf0x.pro'.

       All output variables are (re)created/assigned by `col_to_row'.

 EXAMPLE:
       Assume that 5 records are to be written to an rVariable whose
       dimensionality is 2:[10,30] in a CDF with row-major majority.
       The records are to be written from an IDL variable named `iBuffer'
       which was created using `fltarr(10,30,5)' and then loaded with
       data.  If the data type of the rVariable is CDF_REAL4 (4-byte
       floating-point), the majority would be reversed as follows...

       IDL&gt; @cdf0x.pro
       IDL&gt; dimSizes = lonarr(2)
       IDL&gt; dimSizes(0) = 10
       IDL&gt; dimSizes(1) = 30
       IDL&gt; status = col_to_row (iBuffer, oBuffer, 2L, dimSizes, 4L, 5L)
       IDL&gt; if (status lt CDFx.CDF_WARN) print, 'col_to_row failed.'

       `oBuffer' would also be created/recreated as `fltarr(10,30,5)' by
       `col_to_row'.

 RESTRICTIONS:
       None.

 REVISION HISTORY:
        7-Nov-94        Original version.
       26-Jun-95        IDL 4.0.
       21-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/col_to_row.pro">general/missions/fast/fa_ops/col_to_row.pro</A>)</STRONG><P>
<HR>
 
<A NAME="COMPARE_ORBITS">
<H2>COMPARE_ORBITS</H2></A>
<A HREF="#COL_TO_ROW">[Previous Routine]</A>
<A HREF="#COMPUTEEPOCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:      compare_orbits
               
 PURPOSE:        Propagates multiple orbits.  Used to compare evolution
                 of nearby orbits.
               
 INPUTS:         Accepts any of three classes of input:

                 DEFAULT           KEPLER               VECTOR
                 -------           ------               ------
                 apogee            semi-major axis        X
                 perigee           eccentricity           Y
                 inclination       inclination            Z
                 ascending node    ascending node         VX
                 arg of perigee    arg of perigee         VY
                 mean anomaly      mean anomaly           VZ

                 Input is received through ASCII files or interactive
                 prompting.  See INPUT_FILES keyword. Set
                 KEPLER_INPUT or VECTOR_INPUT to use a parameter set
                 other than the default.  The only difference between
                 the default and Keplerian sets is that apogee and
                 perigee are traded for semi-major axis and
                 eccentricity.

                 Apogee and perigee are in kilometers relative to the
                 Earth's surface.  Semi-major axis is in kilometers.
                 Inclination, ascending node, argument of perigee,
                 and mean anomaly are all in degrees.  Position and
                 velocity are in Geocentric Equatorial Inertial (GEI)
                 kilometers.

 OUTPUTS:        Files containing position and velocity vectors (in
                 GEI km) over the requested timespan.  There will be
                 one file for each orbit requested. See OUTPUT_FILES
                 keyword.

                 Also, unless the NO_STORE keyword is set, all
                 quantities available from get_fa_orbit.pro will be
                 stored in tplot structures with numbered suffixes
                 appended to their names.  (This process must have
                 permission to create files in the current
                 directory.)

 ARGUMENTS:      

 (none)


 KEYWORDS:

 KEPLER_INPUT    Set this keyword if inputs are Keplerian orbit elements.
 VECTOR_INPUT    Set this keyword if inputs are position and velocity vectors.
 NO_STORE        Disables storage of tplot structures.
 NO_FILES        Disables writing of propagated vectors to ASCII files.
 DURATION        The orbits will be propagated DURATION seconds.
 DELTA_T         Spacing in seconds of computed orbit vectors (default=20s).
 REFERENCE       Set this to a string or double float time.  It will
                 be used as the starting point for the propagation.
                 Since time is arbitrary and has no bearing on the
                 calculation, this keyword is optional and defaults
                 to '2000-1-1/00:00:00.000'.

 OUTPUT_FILES    Set this to a scalar string to be used for constructing
                 the names of the output files.  An index number will
                 be appended to the name to designate which orbit the
                 file corresponds to.  The default is 'propagation.n'

                 The output files will contain a one-line header
                 followed by rows containing the following fields:
                 TIME     X     Y     Z     VX     VY     VZ
                 (Position and velocity are in GEI km.)

 INPUT_FILES     Scalar string or string array.  Set this keyword to the
                 names of files containing the input parameters.  The
                 wildcard character `*' is acceptible.  There should
                 be one file for each orbit to be propagated.  There
                 are three possible file formats, described below.

                 (If this keyword is unset, the user will be prompted
                 interactively for the input parameters.)

                 Default File Format:

                 With the KEPLER_INPUT and VECTOR_INPUT keywords both
                 unset, the input files should be similar to the
                 following:

                 ; Orbital elements
                 Apogee: 4179.70
                 Perigee: 352.270
                 Inclination: 82.9672945710076
                 Ascending Node: 178.334008234324
                 Arg of Perigee: 161.781356303097
                 Mean Anomaly: 207.607698658954
                 
                 CAUTION: It is the order of the entries that matters
                 -- not the labels.  The labels are totally arbitrary
                 and optional, included for the user's sake.  The
                 colon delimits the label from the value.  Empty
                 lines and those beginning with `;' are ignored.

                 Apogee and perigee are in kilometers relative to
                 Earth's surface.  Inclination, ascending node,
                 argument of perigee, and mean anomaly are in
                 degrees.

                 Keplerian File Format:

                 With the KEPLER_INPUT keyword set, the input files
                 should be similar to this:

                 ; Keplerian elements
                 Semi-major axis: 8644.08502992716
                 Eccentricity: 0.221390443436394
                 Inclination: 82.9672945710076
                 Ascending Node: 178.334008234324
                 Arg of Perigee: 161.781356303097
                 Mean Anomaly: 207.607698658954

                 Vector File Format:
 
                 This file should contain two lines.  The first
                 consists of the position vector elements delimited
                 by whitespace, the second consists of the velocity
                 vector elements.  Both vectors are in Geocentric
                 Equatorial Inertial (GEI) kilometers.  Empty lines
                 and those beginning with `;' are ignored.

                 ; Initial position and velocity vectors
                 -5507.04834742092  -3977.33940791809   1.16138517269934e-05
                 0.998998200041123  -0.546989517973328  8.35870064323739

</PRE><P>
<STRONG>(See <A href="fa_ops/compare_orbits.pro">general/missions/fast/fa_ops/compare_orbits.pro</A>)</STRONG><P>
<HR>
 
<A NAME="COMPUTEEPOCH">
<H2>COMPUTEEPOCH</H2></A>
<A HREF="#COMPARE_ORBITS">[Previous Routine]</A>
<A HREF="#CONVERT_TMS_UNITS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       computeEPOCH

 PURPOSE:
       `computeEPOCH' is used to compute a CDF_EPOCH value from its
       component parts.

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       epoch = computeEPOCH (year, month, day, hour, minute, second, msec)

 INPUTS:
       year:           LONG.  The year component (AD).
       month:          LONG.  The month component (1-12).
       day:            LONG.  The day component (1-31).
       hour:           LONG.  The hour component (0-23).
       minute:         LONG.  The minute component (0-59).
       second:         LONG.  The second component (0-59).
       millisecond:    LONG.  The millisecond component (0-999).

       All input variables must have been created/initialized before calling
       `computeEPOCH'.

 OUTPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       computed CDF_EPOCH value.

       All output variables are (re)created/assigned by `computeEPOCH'.

 EXAMPLE:
       IDL&gt; year = 1993L
       IDL&gt; month = 5L
       IDL&gt; day = 20L
       IDL&gt; epoch = computeEPOCH (year, month, day, 0L, 0L, 0L, 0L)

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        1-Nov-94        CDF V2.5.
       26-Jun-95        IDL 4.0.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/computeepoch.pro">general/missions/fast/fa_ops/computeepoch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CONVERT_TMS_UNITS">
<H2>CONVERT_TMS_UNITS</H2></A>
<A HREF="#COMPUTEEPOCH">[Previous Routine]</A>
<A HREF="#CONVERT_TMS_UNITS2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	convert_tms_units
PURPOSE:	to convert units of data from the teams
		instruments.
INPUT:		
	data:	A 3d structure such as those generated by get_fa_th,etc.
	units:	A string telling the procedure which units to convert to, such
		as ncounts,rate,nrate,eflux,flux

KEYWORDS:
	scale:	A named variable that will return the scale used to convert

 REVISION HISTORY:

   Made from convert_esa_units.pro
   Last modification:     Li Tang   Univ. of New Hampshire.   8/22/96
			   3D data(himass) added.
</PRE><P>
<STRONG>(See <A href="fa_ops/convert_tms_units.pro">general/missions/fast/fa_ops/convert_tms_units.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CONVERT_TMS_UNITS2">
<H2>CONVERT_TMS_UNITS2</H2></A>
<A HREF="#CONVERT_TMS_UNITS">[Previous Routine]</A>
<A HREF="#CUMDIST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	convert_tms_units2
PURPOSE:	to convert units of data from the teams instruments.
		
INPUT:		
	data:	A 3d structure such as those generated by get_el,get_pl,etc.
	units:	A string telling the procedure which units to convert to, such
		as ncounts,rate,nrate,eflux,flux,df

KEYWORDS:
	scale:	A named variable that will return the scale used to convert

 REVISION HISTORY:

   Made from convert_esa_units.pro
   Last modification:     Li Tang   Univ. of New Hampshire.   8/22/96
			    3D data(himass) added.
</PRE><P>
<STRONG>(See <A href="fa_ops/convert_tms_units2.pro">general/missions/fast/fa_ops/convert_tms_units2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CUMDIST">
<H2>CUMDIST</H2></A>
<A HREF="#CONVERT_TMS_UNITS2">[Previous Routine]</A>
<A HREF="#CUMDIST_COMPARE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 plots a cumulative distribution of DATA. Many keywords in common
 with other HISTOGRAM functions.
</PRE><P>
<STRONG>(See <A href="fa_ops/cumdist.pro">general/missions/fast/fa_ops/cumdist.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CUMDIST_COMPARE">
<H2>CUMDIST_COMPARE</H2></A>
<A HREF="#CUMDIST">[Previous Routine]</A>
<A HREF="#CURVOUT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 compare cumulative distributions of X1 and X2. 
</PRE><P>
<STRONG>(See <A href="fa_ops/cumdist_compare.pro">general/missions/fast/fa_ops/cumdist_compare.pro</A>)</STRONG><P>
<HR>
 
<A NAME="CURVOUT">
<H2>CURVOUT</H2></A>
<A HREF="#CUMDIST_COMPARE">[Previous Routine]</A>
<A HREF="#C_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: CURVOUT

 PURPOSE:
 Calls IDL's CURVEFIT iteratively, rejecting outliers at each
 iteration, until the fit converges or too many points are thrown
 away.

 INPUTS: X - the independent variable
         Y - the dependent variable
         WEIGHTS - the relative importance of each point in
                   determining goodness of fit
         APAR - a vector of parameters for evaluating the model
             function. This should be a good guess on input.
       
 KEYWORD PARAMETERS:
    FUNCTION_NAME - a string naming a user supplied procedure which
                    will be called by CURVEFIT.

    ITMAX: maximum number of CURVEFIT iterations. CURVOUT will
           iterate until it's done.
    
    ITER: the number of iterations actually performed. This will
          apply only to the last cycle of CURVOUT. 

    TOL: convergence tolerance. The routine returns when the relative
         decrease in chi-squared is less than TOL in an
         interation. Default = 1.e-3.

    CHI2: The value of chi-squared on exit (obsolete)

    CHISQ: The value of reduced chi-squared on exit

    NODERIVATIVE: If this keyword is set then the user procedure will
                  not be requested to provide partial
                  derivatives. The partial derivatives will be
                  estimated in CURVEFIT using forward differences. If
                  analytical derivatives are available they should
                  always be used.
    
    USED - a named variable in which the indices of the data
    used for the final fit are returned. 

    TOSSED - a named variable in which the indices of the data
    removed from the final fit are returned.

    MAX_TOSS - the maximum allowable fraction of the data represented
               by outliers. Up to MAX_TOSS*(number of points) may be
               thrown away to acheive a good fit. Default is 0.5. 

    SHOW - if set, causes successive fits to be plotted
           interactively.


 OUTPUTS: A - the vector of parameters at which the model function
          most closely matches the data Y.

          SIGMA - standard deviations of APAR

 EXAMPLE: phase_diff = curveout(tdiff,pdiff,weights,ang,sigma,
                                funct='sun_mag_diff',/noderiv)

 MODIFICATION HISTORY: 

</PRE><P>
<STRONG>(See <A href="fa_ops/curvout.pro">general/missions/fast/fa_ops/curvout.pro</A>)</STRONG><P>
<HR>
 
<A NAME="C_2D">
<H2>C_2D</H2></A>
<A HREF="#CURVOUT">[Previous Routine]</A>
<A HREF="#DATA_ONLY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	c_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_eeb, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the sum of the counts in dat.data
NOTES:	
	Function normally called by &quot;get_2dt&quot; to generate 
	time series data for &quot;tplot&quot;.

CREATED BY:
	J.McFadden	96-12-13	
LAST MODIFICATION:
	
</PRE><P>
<STRONG>(See <A href="fa_ops/c_2d.pro">general/missions/fast/fa_ops/c_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATA_ONLY">
<H2>DATA_ONLY</H2></A>
<A HREF="#C_2D">[Previous Routine]</A>
<A HREF="#DATESEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:

data_only

PURPOSE:

 To find non-empty invervals in data.  Good for selecting the
 N. hem. and S. hem. passes out of an orbit's worth of data.  Given
 the string name of a preloaded tplot structure, will return an array
 containing pairs of times designating data intervals.  

 array(0,0) contains the start time of the first data interval and 
 array(1,0) contains the end time of the first data interval.

 Returns either one or two pairs of times.  Only works with 2-D data.

ARGUMENTS:

 qty      Name of tplot data structure: 'Je', 'Ji', etc.

KEYWORDS:

 thresh   minimum number of seconds between data intervals.  By
          default this is set to 900 which should be enough to
          discern the northern and southern passes.

</PRE><P>
<STRONG>(See <A href="fa_ops/data_only.pro">general/missions/fast/fa_ops/data_only.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATESEC">
<H2>DATESEC</H2></A>
<A HREF="#DATA_ONLY">[Previous Routine]</A>
<A HREF="#DATESEC_VAR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 DATESEC

 DESCRIPTION:

	function to parse out a date string of either the form [YY]YY-MM-DD 
	(e.g. '1989-10-1' or '89-10-1), DD/MM/YY (e.g. '1/10/89'), DD MMM YY
	(e.g. '1 Oct 89' or '1 OCT 89', case ingnored) or YYYY/MM/DD 
	(e.g. 1989/10/01, where the first field is greater than 31).  The
	RETURN value is double float in seconds since 1 Jan 1970, 00:00 UT.

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	string_date = '21 Mar 91'
    
    ; convert to string    
    
	seconds_date = datesec(string_date)
    
    ; print it out
    
	PRINT, seconds_date

 --- Sample output would be 
    
	6.6951720e+08
    

 NOTES:

	If conversion fails, this function returns -1.

	For the forth input format to work (YYYY/MM/DD), the year
	specified must be greater than 31, otherwise the DD/MM/YY
	format assumed.

 	Note that NO combination of of input formats will work.  Also, all
 	three fields must be present.  

	If any of the fields is to large then a carry operation will occur.  
 	i.e. 34/13/89 would come out to year 90, month 2, day 3.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings and remainders will be returned.


 REVISION HISTORY:

	@(#)datesec.pro	1.6 08/17/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Jan. '92
</PRE><P>
<STRONG>(See <A href="fa_ops/datesec.pro">general/missions/fast/fa_ops/datesec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATESEC_VAR">
<H2>DATESEC_VAR</H2></A>
<A HREF="#DATESEC">[Previous Routine]</A>
<A HREF="#DATESTRUCT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 DATESEC_VAR

 DESCRIPTION:

	function to return seconds since 1 Jan 1970, 00:00 UT corresponding
	to beginning of given day.

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	day = 21
	month = 3
	year = 91
    
    ; convert to string    
    
	seconds_date = datesec_var(day, month, year)
    
    ; print it out
    
	PRINT, seconds_date

 --- Sample output would be 
    
	6.6951360e+08
    

 NOTES:

	If conversion fails, this function returns -1.
 

	If any of the fields is to large then a carry operation will occur.  
 	i.e. 34/13/89 would come out to year 90, month 2, day 3.

	If inputs are arrays, then an array of 
	N_ELEMENTS(inputs vals) of times will be returned


 REVISION HISTORY:

	@(#)datesec_var.pro	1.2 06/07/95 	
 	Originally written by Ken Bromund,  University of 
 	California at Berkeley, Space Sciences Lab.   May, '92
	made to give results equivalent to datesec by Jon Loran
	
</PRE><P>
<STRONG>(See <A href="fa_ops/datesec_var.pro">general/missions/fast/fa_ops/datesec_var.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATESTRUCT">
<H2>DATESTRUCT</H2></A>
<A HREF="#DATESEC_VAR">[Previous Routine]</A>
<A HREF="#DATETIMESEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 DATESTRUCT

 DESCRIPTION:

	function to parse out a date string of either the form DD-MM-YY 
	(e.g. '1-10-89'), DD/MM/YY (e.g. '1/10/89'), DD MMM YY (e.g. 
 	'1 Oct 89' or '1 OCT 89', case ingnored) or YYYY/MM/DD (e.g.
	1989/10/01, where the year is greater than 31). 

 	The return value is a structure of the format:

	 {date_str                     $
	             ,year:      1970  $   ; year component of the date
	             ,month:     01    $   ; month component of the date
	             ,monthday:  01    $   ; day of month component of the date
	             ,secs:      0.D   $   ; seconds since 1 Jan 1970 00:00:00
	             ,valid:     1     $   ; contents are valid
	 }

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	string_date = '21 Mar 91'
    
    ; convert to string    
    
	date_struct = datestruct(string_date)
    
    ; print it out
    
	PRINT, date_struct

 --- Sample output would be 
    
	{1991, 03, 21,  6.6951720e+08, 1}
    

 NOTES:

	If conversion fails, this function returns a date_str with the valid
	tag set to 0.
 
	For the forth input format to work (YYYY/MM/DD), the year
	specified must be greater than 31, otherwise the DD/MM/YY
	format assumed.

 	Note that NO combination of of input formats will work.  Also, all
 	three fields must be present.  

	If any of the fields is to large then a carry operation will occur.  
 	i.e. 34/13/89 would come out to year 90, month 2, day 3.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of dat estrings and remainders will be
	returned.


 REVISION HISTORY:

	@(#)datesec.pro	1.2 04 Jun 1995 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June. '95

</PRE><P>
<STRONG>(See <A href="fa_ops/datestruct.pro">general/missions/fast/fa_ops/datestruct.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATETIMESEC">
<H2>DATETIMESEC</H2></A>
<A HREF="#DATESTRUCT">[Previous Routine]</A>
<A HREF="#DATETIMESEC_VAR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 DATETIMESEC

 DESCRIPTION:

	function to parse out a date/time string with date format of
	either the form DD-MM-YY (e.g. '1-10-89'), DD/MM/YY (e.g. '1/10/89'),
	DD MMM YY (e.g. '1 Oct 89' or '1 OCT 89', case ingnored) or YYYY/MM/DD
	OR YYYY-MM-DD (e.g. 1989/10/01, where the first field is greater than
	31), and time format of with format HH:MM:SS.MSC where the least
 	significant entries may be omitted (e.g. HH:MM is legal), but at least
	one colon must remain.  There must be some delimiter between the date
	and the time, which must be different than the delimiter between the
	fields within the date string portion.  The RETURN value is double
	float in seconds since 1 Jan 1970, 00:00 UT.

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	string_date_time = '1991-03-21/04:04:04'
    
    ; convert to string    
    
	seconds_date = datetimesec(string_date_time)
    
    ; print it out
    
	PRINT, seconds_date

 --- Sample output would be 
    
	6.6952824e+08
    

 NOTES:

	If conversion fails, this function returns -1.
 
	For the forth date input format to work (YYYY/MM/DD), the year
	specified must be greater than 31, otherwise the DD/MM/YY
	format assumed.

 	Note that NO combination of date input formats will work.  Also, all
 	three date fields must be present.  

	If any of the fields is to large then a carry operation will
	occur.  i.e. 34/13/89 would come out to year 90, month 2, day 3.
	The same is true of the time portion.

	If the date or time portion of the input string are omitted, then
	this function will behave like the datesec() or timesec() respectively.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings and remainders will be
	returned.


 REVISION HISTORY:

	@(#)datetimesec.pro	1.2 07/20/95 
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Jan. '92
</PRE><P>
<STRONG>(See <A href="fa_ops/datetimesec.pro">general/missions/fast/fa_ops/datetimesec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATETIMESEC_VAR">
<H2>DATETIMESEC_VAR</H2></A>
<A HREF="#DATETIMESEC">[Previous Routine]</A>
<A HREF="#DATE_DOY_SEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 DATETIMESEC_VAR

 DESCRIPTION:

	function to return seconds since 1/1/1970 00:00 UT, from date and 
 	time given as day, month, year, hour, minute, second, millisecond. 

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; set up a date and time (21 Mar '91, 00:01:01.000)

	day = 21
	month = 3
	year = 91
	hour = 0
	min = 1
	sec = 1
	msc = 0	
    
    ; convert to seconds
    
	sec_date_time = datetimesec_var(day, month, year, hour, min, sec, msc)
    
    ; print it out
    
	PRINT, sec_date_time

 --- Sample output would be 
    
	669517261
    

 NOTES:

	If any of the fields are are out of range, the value will be carried.
	e.g. given date and time of 31/12/90, 25:01:00.1001, this will be
	converted to   1/1/91, 01:01:01: 001
	If any of the input values are negitive, this is an error and -1 will
 
	This function can return seconds of days, or seconds since 1970 only
	by calling it with dates or times set to zero.

	If input values are arrays, then an array of N_ELEMENTS(inputs vals) 
	of date strings and remainders will be returned.  The number of
	array elements for all input parameters must be the same


 REVISION HISTORY:

	@(#)datetimesec_var.pro	1.2 07/20/95 
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Mar. '92
</PRE><P>
<STRONG>(See <A href="fa_ops/datetimesec_var.pro">general/missions/fast/fa_ops/datetimesec_var.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DATE_DOY_SEC">
<H2>DATE_DOY_SEC</H2></A>
<A HREF="#DATETIMESEC_VAR">[Previous Routine]</A>
<A HREF="#DEFAULT_DC_LIMITS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE

 date_doy_sec.pro

 PURPOSE

 Given a standard format date/time (string or double float), returns
 the year, day of year, and seconds into day.

 INPUTS

 time     String or double float.

 OUTPUTS

 year     Four-digit year.
 doy      Day of year.
 sec      Seconds into day.

</PRE><P>
<STRONG>(See <A href="fa_ops/date_doy_sec.pro">general/missions/fast/fa_ops/date_doy_sec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DEFAULT_DC_LIMITS">
<H2>DEFAULT_DC_LIMITS</H2></A>
<A HREF="#DATE_DOY_SEC">[Previous Routine]</A>
<A HREF="#DELTAS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 This code contains the default limits for DC fields summary
 plots. There are separate limits for electric field, magnetic field,
 probe current, spin angle, and spacecraft potential. Within those
 categories, the limits are all the same. 

 There are several choices for each limit, the data determine which
 choice is used. At least MIN_ON_SCALE of the points must be on
 scale, otherwise the next larger choice is tried. 

</PRE><P>
<STRONG>(See <A href="fa_ops/default_dc_limits.pro">general/missions/fast/fa_ops/default_dc_limits.pro</A>)</STRONG><P>
<HR>
 
<A NAME="DELTAS">
<H2>DELTAS</H2></A>
<A HREF="#DEFAULT_DC_LIMITS">[Previous Routine]</A>
<A HREF="#EB_CONFIG_TEST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 returns 3-point derivative of a 1-d array.
</PRE><P>
<STRONG>(See <A href="fa_ops/deltas.pro">general/missions/fast/fa_ops/deltas.pro</A>)</STRONG><P>
<HR>
 
<A NAME="EB_CONFIG_TEST">
<H2>EB_CONFIG_TEST</H2></A>
<A HREF="#DELTAS">[Previous Routine]</A>
<A HREF="#EC_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/eb_config_test.pro">general/missions/fast/fa_ops/eb_config_test.pro</A>)</STRONG><P>
<HR>
 
<A NAME="EC_2D">
<H2>EC_2D</H2></A>
<A HREF="#EB_CONFIG_TEST">[Previous Routine]</A>
<A HREF="#EIESA_UNPACK_SURV_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	ec_2d((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the characteristic energy, Ec, eV
NOTES:	
	Function calls j_2d.pro and je_2d.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-5		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/ec_2d.pro">general/missions/fast/fa_ops/ec_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="EIESA_UNPACK_SURV_HDR">
<H2>EIESA_UNPACK_SURV_HDR</H2></A>
<A HREF="#EC_2D">[Previous Routine]</A>
<A HREF="#ENCODEEPOCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 EIESA_UNPACK_SURV_HDR

 DESCRIPTION:

	function to unpack the Eesa and Iesa packet headers

	A structure of the following format is returned:

	   DATA_NAME     			STRING  'E[I]esa Survey Header'
	   VALID         			INT       1
 	   PROJECT_NAME  			STRING    'FAST'
 	   UNITS_NAME    			STRING    'Raw'
	   TIME          			DOUBLE    8.0118726e+08
	   SPIN_NUMBER				INT       0
	   SPIN_PHASE				INT       0
	   MAG_PHASE				INT       0
	   SWEEP_MODE    			INT       0 
	   RETRACE       			INT       0 
	   TOP_ENERGY    			INT       0
	   DIRECTION     			INT       0               
	   AMPLITUDE     			INT       0
	   CALIBRATE_MODE  			INT       0     
	   LOW_ENERGY    			INT       0
	   DWELL         			INT       0
	   ACCUM         			INT       0
	   MODE          			INT       0
	   NENERGY_MODE  			INT       0
	   DESPUN        			INT       0
	   SWEEPS_PER_AVERAGE 			INT       0
	   BLOCKS_PER_PACKET 			INT       0
	   NENERGY       			INT       0
	   NANGLE        			INT       0
	   NBINS         			INT       0
	   TYPE         			INT       0
	   SC       	  			INT       0
	   MARRAY_HDR_IDX 	  		INT       0
	   MARRAY_HDR_SUBCNT 	  		INT       0
	   BLKS_FROM_OLD_SWP 	  		INT       0
	   BLKS_REM_IN_PNDING_SWP 		INT       0
	   NON_TTAGED_DATA_IDX 	  		INT       0
	   DATA_INDICES 	  		INTARR(32)
	   SECS_PER_BLOCK 	  		DOUBLE    0
	   SPIN_RATE 	  			DOUBLE    0
	
 CALLING SEQUENCE:

 	data = eiesa_unpack_surv_hdr (eiesa_surv_data_struct)

 ARGUMENTS:

	eiesa_surv_data_struct	This is a struct return by get_eesa_surv ()
				for Eesa data, or get_iesa_surv () for
 				Iesa data.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)eiesa_unpack_surv_hdr.pro	1.3 03/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/eiesa_unpack_surv_hdr.pro">general/missions/fast/fa_ops/eiesa_unpack_surv_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ENCODEEPOCH">
<H2>ENCODEEPOCH</H2></A>
<A HREF="#EIESA_UNPACK_SURV_HDR">[Previous Routine]</A>
<A HREF="#ENCODEEPOCH1">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       encodeEPOCH

 PURPOSE:
       `encodeEPOCH' is used to encode a CDF_EPOCH value into a standard
       EPOCH character string.

       This procedure is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       encodeEPOCH, epoch, epString

 INPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       CDF_EPOCH value to be encoded.

       All input variables must have been created/initialized before calling
       `encodeEPOCH'.

 OUTPUTS:
       epString:       STRING.  The standard EPOCH character string.  The
                       syntax of this string is `dd-mmm-yyyy hh:mm:ss.ccc'
                       where `dd' is the day of the month (1-31), `mmm' is
                       the month (`Jan', `Feb', `Mar', `Apr', `May', `Jun',
                       `Jul', `Aug', `Sep', `Oct', `Nov', or `Dec'), `yyyy'
                       is the year, `hh' is the hour (0-23), `mm' is the
                       minute (0-59), `ss' is the second (0-59), and `ccc'
                       is the millisecond (0-999).

       All output variables are (re)created/assigned by `encodeEPOCH'.

 EXAMPLE:
       IDL&gt; epoch = 6d13
       IDL&gt; encodeEPOCH, epoch, epString

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        7-Nov-94        CDF V2.5.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/encodeepoch.pro">general/missions/fast/fa_ops/encodeepoch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ENCODEEPOCH1">
<H2>ENCODEEPOCH1</H2></A>
<A HREF="#ENCODEEPOCH">[Previous Routine]</A>
<A HREF="#ENCODEEPOCH2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       encodeEPOCH1

 PURPOSE:
       `encodeEPOCH1' is used to encode a CDF_EPOCH value into an alternate
       EPOCH character string.

       This procedure is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       encodeEPOCH1, epoch, epString

 INPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       CDF_EPOCH value to be encoded.

       All input variables must have been created/initialized before calling
       `encodeEPOCH1'.

 OUTPUTS:
       epString:       STRING.  The alternate EPOCH character string.  The
                       syntax of this string is `yyyymmdd.ttttttt' where
                       `yyyy' is the year, `mm' is the month (1-12), `dd'
                       is the day of the month (1-31), and `ttttttt' is the
                       fraction of the day (eg. `5000000' is 12 o'clock noon).

       All output variables are (re)created/assigned by `encodeEPOCH1'.

 EXAMPLE:
       IDL&gt; epoch = 6d13
       IDL&gt; encodeEPOCH1, epoch, epString

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        7-Nov-94        CDF V2.5.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/encodeepoch1.pro">general/missions/fast/fa_ops/encodeepoch1.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ENCODEEPOCH2">
<H2>ENCODEEPOCH2</H2></A>
<A HREF="#ENCODEEPOCH1">[Previous Routine]</A>
<A HREF="#ENCODEEPOCH3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       encodeEPOCH2

 PURPOSE:
       `encodeEPOCH2' is used to encode a CDF_EPOCH value into an alternate
       EPOCH character string.

       This procedure is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       encodeEPOCH2, epoch, epString

 INPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       CDF_EPOCH value to be encoded.

       All input variables must have been created/initialized before calling
       `encodeEPOCH2'.

 OUTPUTS:
       epString:       STRING.  The alternate EPOCH character string.  The
                       syntax of this string is `yyyymmddhhmmss' where `yyyy'
                       is the year, `mm' is the month (1-12), `dd' is the day
                       of the month (1-31), `hh' is the hour (0-23), `mm' is
                       minute (0-59), and `ss' is the second (0-59).

       All output variables are (re)created/assigned by `encodeEPOCH2'.

 EXAMPLE:
       IDL&gt; epoch = 6d13
       IDL&gt; encodeEPOCH2, epoch, epString

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        7-Nov-94        CDF V2.5.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/encodeepoch2.pro">general/missions/fast/fa_ops/encodeepoch2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ENCODEEPOCH3">
<H2>ENCODEEPOCH3</H2></A>
<A HREF="#ENCODEEPOCH2">[Previous Routine]</A>
<A HREF="#EPOCHBREAKDOWN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       encodeEPOCH3

 PURPOSE:
       `encodeEPOCH3' is used to encode a CDF_EPOCH value into an alternate
       EPOCH character string.

       This procedure is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       encodeEPOCH3, epoch, epString

 INPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       CDF_EPOCH value to be encoded.

       All input variables must have been created/initialized before calling
       `encodeEPOCH3'.

 OUTPUTS:
       epString:       STRING.  The alternate EPOCH character string.  The
                       syntax of this string is `yyyy-mn-ddThh:mm:ss.cccZ'
                       where `yyyy' is the year, `mn' is the month (1-12),
                       `dd' is the day of the month (1-31), `hh' is the hour
                       (0-23), `mm' is the minute (0-59), `ss' is the second
                       (0-59), and `ccc' is the millisecond (0-999).

       All output variables are (re)created/assigned by `encodeEPOCH3'.

 EXAMPLE:
       IDL&gt; epoch = 6d13
       IDL&gt; encodeEPOCH3, epoch, epString

 RESTRICTIONS:
       None.

 REVISION HISTORY:
        7-Nov-94       Original version.
       16-Aug-96       CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/encodeepoch3.pro">general/missions/fast/fa_ops/encodeepoch3.pro</A>)</STRONG><P>
<HR>
 
<A NAME="EPOCHBREAKDOWN">
<H2>EPOCHBREAKDOWN</H2></A>
<A HREF="#ENCODEEPOCH3">[Previous Routine]</A>
<A HREF="#ESA_ANODE_CALIB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       EPOCHbreakdown

 PURPOSE:
       `EPOCHbreakdown' is used to break down a CDF_EPOCH value into its
       component parts.

       This procedure is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       EPOCHbreakdown, epoch, year, month, day, hour, minute, second, msec

 INPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       CDF_EPOCH value to be broken down.

       All input variables must have been created/initialized before calling
       `EPOCHbreakdown'.

 OUTPUTS:
       year:           LONG.  The year component (AD).
       month:          LONG.  The month component (1-12).
       day:            LONG.  The day component (1-31).
       hour:           LONG.  The hour component (0-23).
       minute:         LONG.  The minute component (0-59).
       second:         LONG.  The second component (0-59).
       millisecond:    LONG.  The millisecond component (0-999).

       All output variables are (re)created/assigned by `EPOCHbreakdown'.

 EXAMPLE:
       IDL&gt; epoch = 6d13
       IDL&gt; EPOCHbreakdown, epoch, year, month, day, hour, minute, second, $
       IDL&gt;                 msec

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        1-Nov-94        CDF V2.5.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/epochbreakdown.pro">general/missions/fast/fa_ops/epochbreakdown.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ESA_ANODE_CALIB">
<H2>ESA_ANODE_CALIB</H2></A>
<A HREF="#EPOCHBREAKDOWN">[Previous Routine]</A>
<A HREF="#FAIRB_FAST_CONJ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: esa_anode_calib,orbit

 reads in data from individual angle bins from esa burst data,
 asks user to click on boundaries of loss cone, and averages
 remaining points

 INPUT:
  orbit  the orbit number (used in the filename) which you are calibrating

 OUTPUT:
  prints calibration values (nomalized to 1.0) for 32 angle bins

 KEYWORDS:

 ENERGY  passed onto get_2dt.  If not set, default is [1000,20000]
 DIR     set this keyword to the directory in which tplot files
         are stored.  Default is current directory.
 DATASRC set this keyword to the string passed by get_2dt (i.e. 'fa_eeb',
         'fa_ieb', 'fa_seb1','fa_seb2', etc) If this keyword is
         not set it defaults to 'fa_eeb'
 SHOW4   set this keyword to show plots of 4 bins and the losscones
 SHOW8   set this keyword to show plots of 8 bins and the losscones
 SHOWALL set this keyword to show plots of all bins and the losscones
 SDT     set this keyword to get esa data directly from SDT 
     (default is to read in tplot files)  Note that SDT needs to
     be running anyways, because of the fa_fields_phase

 Need to have phase (1032) in SDT.  If SDT keyword set, need also to
 have EesaBurstAggregate in SDT.

 Written 97-4-15   by Y-K Tung
 Modified 98-2-11  by Y-K Tung  added keyword DIR
 Modified 98-2-20  by Y-K Tung  added keyword ENERGY

</PRE><P>
<STRONG>(See <A href="fa_ops/esa_anode_calib.pro">general/missions/fast/fa_ops/esa_anode_calib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAIRB_FAST_CONJ">
<H2>FAIRB_FAST_CONJ</H2></A>
<A HREF="#ESA_ANODE_CALIB">[Previous Routine]</A>
<A HREF="#FASTHELP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

 fairbanks.pro

 PURPOSE:

 Finds times when FAST has a conjunction with a ground point near
 MLT=0000.

 OUTPUT:

 times

 An array of times within the designated interval for which FAST
 satisfies the conjunction criteria.

 KEYWORDS:

 LAT, LNG

 The geographic lattitude and longitude of the ground point FAST is
 to intersect. Default is Fairbanks. May not work so well for other
 ground points.

 MLTTOL, LATTOL, LNGTOL

 Tolerance in hours for MLT or in degrees for LAT and LNG. (Default
 2.0, 15.0, 20.0)

 FOOT

 Look for a magnetic conjunction instead of an optical one.

 DRAG

 Include drag factor when propagating the orbit into the future.

 NOLOAD

 Don't bother reloading the orbit data; use the data already loaded.

 FILE

 Set this keyword to the name of a file in which to save the conjunction
 times and MLTs.

</PRE><P>
<STRONG>(See <A href="fa_ops/fairb_fast_conj.pro">general/missions/fast/fa_ops/fairb_fast_conj.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FASTHELP">
<H2>FASTHELP</H2></A>
<A HREF="#FAIRB_FAST_CONJ">[Previous Routine]</A>
<A HREF="#FAST_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 see HELPFAST
</PRE><P>
<STRONG>(See <A href="fa_ops/fasthelp.pro">general/missions/fast/fa_ops/fasthelp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_BATCH">
<H2>FAST_BATCH</H2></A>
<A HREF="#FASTHELP">[Previous Routine]</A>
<A HREF="#FAST_EF_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_batch.pro">general/missions/fast/fa_ops/fast_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_EF_SUMMARY">
<H2>FAST_EF_SUMMARY</H2></A>
<A HREF="#FAST_BATCH">[Previous Routine]</A>
<A HREF="#FAST_ELEC_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_ef_summary.pro
INPUT:	none

PURPOSE:
	Generates ps, gif, cdf summary plots of FAST electron data.

	Plot 1: Electron Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Electron Differential Energy Flux vs Energy, 60-120  deg pitch angle 
	Plot 3: Electron Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Electron Differential Energy Flux vs Pitch Angle, .1-1 keV  
	Plot 5: Electron Differential Energy Flux vs Pitch Angle, 1-30 keV  
	Plot 6: Electron Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Electron Flux - mapped to 100 km, positive earthward  

KEYWORDS
	BW	Set bw=1 to get black/white postscript
	k0	keyword passed to gen_fa_k0_ees_gifps.pro

CREATED BY:	J.McFadden		96/11/7
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:	
		96/11/7		made from fast_e_summary.pro
		 		uses &quot;make_array_struc.pro&quot; to speed it up
		97/03/04	Je,JEe mapped to 100 km, positive for earthward
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_ef_summary.pro">general/missions/fast/fa_ops/fast_ef_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_ELEC_SUMMARY">
<H2>FAST_ELEC_SUMMARY</H2></A>
<A HREF="#FAST_EF_SUMMARY">[Previous Routine]</A>
<A HREF="#FAST_ESA_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_elec_summary.pro
PURPOSE:
	Generates a summary plot of FAST electron data for tplot.

	Plot 1: Electron Differential Energy Flux vs Energy, 0-45    deg pitch angle 
	Plot 2: Electron Differential Energy Flux vs Energy, 45-135  deg pitch angle 
	Plot 3: Electron Differential Energy Flux vs Energy, 135-180 deg pitch angle 
	Plot 4: Electron Differential Energy Flux vs Pitch Angle, &lt; 1 keV  
	Plot 5: Electron Differential Energy Flux vs Pitch Angle, &gt; 1 keV  
	Plot 6: Electron Energy Flux  
	Plot 7: Electron Flux  

CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  96/06/20
MOD HISTORY:
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_elec_summary.pro">general/missions/fast/fa_ops/fast_elec_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_ESA_BATCH">
<H2>FAST_ESA_BATCH</H2></A>
<A HREF="#FAST_ELEC_SUMMARY">[Previous Routine]</A>
<A HREF="#FAST_ESOLO_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_I_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for ion and electron summary
	plots. 
	It is meant to be called from sdt.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_i_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.3 24 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_esa_batch.pro">general/missions/fast/fa_ops/fast_esa_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_ESOLO_BATCH">
<H2>FAST_ESOLO_BATCH</H2></A>
<A HREF="#FAST_ESA_BATCH">[Previous Routine]</A>
<A HREF="#FAST_E_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for electron summary
	plots.  It is meant to called from sdt.  
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_e_batch

 REVISION HISTORY:

	@(#)fast_e_batch.pro	1.2 08/15/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_esolo_batch.pro">general/missions/fast/fa_ops/fast_esolo_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_E_BATCH">
<H2>FAST_E_BATCH</H2></A>
<A HREF="#FAST_ESOLO_BATCH">[Previous Routine]</A>
<A HREF="#FAST_E_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for electron summary
	plots.  It is meant to called from sdt.  
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_e_batch

 REVISION HISTORY:

	@(#)fast_e_batch.pro	1.2 08/15/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_e_batch.pro">general/missions/fast/fa_ops/fast_e_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_E_SUMMARY">
<H2>FAST_E_SUMMARY</H2></A>
<A HREF="#FAST_E_BATCH">[Previous Routine]</A>
<A HREF="#FAST_FIELDS_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_e_summary.pro
INPUT:	none

PURPOSE:
	Generates ps, gif, cdf summary plots of FAST electron data.

	Plot 1: Electron Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Electron Differential Energy Flux vs Energy, 60-120  deg pitch angle 
	Plot 3: Electron Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Electron Differential Energy Flux vs Pitch Angle, .1-1 keV  
	Plot 5: Electron Differential Energy Flux vs Pitch Angle, 1-30 keV  
	Plot 6: Electron Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Electron Flux - mapped to 100 km, positive earthward  

KEYWORDS
	BW	Set bw=1 to get black/white postscript
	k0	keyword passed to gen_fa_k0_ees_gifps.pro

CREATED BY:	J.McFadden		96-6-20
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:
		96-8-6		get_fa_orbit, gopen added
		96-8-9		return when no data, changed to a procedure
		96/10/08	bw,k0 keywords added
		97/03/04	Je,JEe mapped to 100 km, positive for earthward
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_e_summary.pro">general/missions/fast/fa_ops/fast_e_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_FIELDS_BATCH">
<H2>FAST_FIELDS_BATCH</H2></A>
<A HREF="#FAST_E_SUMMARY">[Previous Routine]</A>
<A HREF="#FAST_IE_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_FIELDS_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file, for fields summary
	plots.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_fields_batch

 REVISION HISTORY:

	@(#)fast_fields_batch.pro	1.3 24 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_fields_batch.pro">general/missions/fast/fa_ops/fast_fields_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_IE_BATCH">
<H2>FAST_IE_BATCH</H2></A>
<A HREF="#FAST_FIELDS_BATCH">[Previous Routine]</A>
<A HREF="#FAST_IF_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_IE_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for electron summary
	plots.  It is meant to called from sdt.  
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_ie_batch

 REVISION HISTORY:

	@(#)fast_ie_batch.pro	1.2 08/15/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_ie_batch.pro">general/missions/fast/fa_ops/fast_ie_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_IF_SUMMARY">
<H2>FAST_IF_SUMMARY</H2></A>
<A HREF="#FAST_IE_BATCH">[Previous Routine]</A>
<A HREF="#FAST_I_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_if_summary.pro
INPUT:	none

PURPOSE:
	Generates ps, gif, cdf summary plots of FAST ion data.

	Plot 1: Ion Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Ion Differential Energy Flux vs Energy, 40-140  deg pitch angle 
	Plot 3: Ion Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Ion Differential Energy Flux vs Pitch Angle, .05-1. keV  
	Plot 5: Ion Differential Energy Flux vs Pitch Angle, 1.-25. keV  
	Plot 6: Ion Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Ion Flux - mapped to 100 km, positive earthward  

KEYWORDS
	BW	Set bw=1 to get black/white postscript
	k0	keyword passed to gen_fa_k0_ies_gifps.pro

CREATED BY:	J.McFadden		96/11/7
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:	
		96/11/7		made from fast_i_summary.pro
				uses &quot;make_array_struc.pro&quot; to speed it up
		97/03/04	Ji,JEi mapped to 100 km, positive for earthward
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_if_summary.pro">general/missions/fast/fa_ops/fast_if_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_I_BATCH">
<H2>FAST_I_BATCH</H2></A>
<A HREF="#FAST_IF_SUMMARY">[Previous Routine]</A>
<A HREF="#FAST_I_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_I_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for ion summary
	plots. 
	It is meant to be called from sdt.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_i_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.3 24 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_i_batch.pro">general/missions/fast/fa_ops/fast_i_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_I_SUMMARY">
<H2>FAST_I_SUMMARY</H2></A>
<A HREF="#FAST_I_BATCH">[Previous Routine]</A>
<A HREF="#FAST_T_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_i_summary.pro
INPUT:	none

PURPOSE:
	Generates ps, gif, cdf summary plots of FAST ion data.

	Plot 1: Ion Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Ion Differential Energy Flux vs Energy, 40-140  deg pitch angle 
	Plot 3: Ion Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Ion Differential Energy Flux vs Pitch Angle, .05-1. keV  
	Plot 5: Ion Differential Energy Flux vs Pitch Angle, 1.-25. keV  
	Plot 6: Ion Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Ion Flux - mapped to 100 km, positive earthward  

KEYWORDS
	BW	Set bw=1 to get black/white postscript
	k0	keyword passed to gen_fa_k0_ies_gifps.pro

CREATED BY:	J.McFadden		96-8-9
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:	
		96/8/9		made from fast_e_summary.pro
		96/10/08	bw,k0 keywords added
		97/03/04	Ji,JEi mapped to 100 km, positive for earthward
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_i_summary.pro">general/missions/fast/fa_ops/fast_i_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_T_BATCH">
<H2>FAST_T_BATCH</H2></A>
<A HREF="#FAST_I_SUMMARY">[Previous Routine]</A>
<A HREF="#FAST_T_SUMMARY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file for electron summary
	plots.  It is meant to called from sdt.  
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_e_batch

 REVISION HISTORY:

	@(#)fast_e_batch.pro	1.2 08/15/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '96
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_t_batch.pro">general/missions/fast/fa_ops/fast_t_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FAST_T_SUMMARY">
<H2>FAST_T_SUMMARY</H2></A>
<A HREF="#FAST_T_BATCH">[Previous Routine]</A>
<A HREF="#FA_ALMANAC_DIR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	fast_t_summary.pro
INPUT:	none

PURPOSE:
	Generates ps, gif, cdf summary plots of FAST teams data.

	Plot 1: Hydrogen Differential Energy Flux vs Energy, 0-360    deg pitch angle
	Plot 2: Oxygen   Differential Energy Flux vs Energy, 0-360  deg pitch angle
	Plot 3: Hydrogen Differential Energy Flux vs Pitch Angle, &lt; 1 keV
	Plot 4: Hydrogen Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Plot 5: Oxygen   Differential Energy Flux vs Pitch Angle, &lt; 1 keV
	Plot 6: Oxygen   Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Plot 7: MassSpectrum Counts Rate vs Mass, 1eV - 12keV, 4*Pi angles

 KEYWORDS
	BW	Set bw=1 to get black/white postscript
	k0	keyword passed to gen_fa_k0_tms_gifps.pro

CREATED BY:	J.McFadden		96-8-15
VERSION:	3.0
LAST MODIFICATION:        00-06-05
MOD HISTORY:
		E.Lund     00-06-05	use all pixels, not just equator
					pixels, in energy spectrograms
		E.Lund     97-06-09	fixed crash on data end mismatch
		E.Lund     97-06-04	added He+ to cdf's
		J.Loran    97-03-01	re-removed asum, esum keywords that
					got put back in accidentally
		L.Tang     96-11-19	removed asum, esum keywords in
					routine get_tms_hm_spec
		J.McFadden 96-08-30	added BW keyword, error print statements
</PRE><P>
<STRONG>(See <A href="fa_ops/fast_t_summary.pro">general/missions/fast/fa_ops/fast_t_summary.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_ALMANAC_DIR">
<H2>FA_ALMANAC_DIR</H2></A>
<A HREF="#FAST_T_SUMMARY">[Previous Routine]</A>
<A HREF="#FA_CDF_FILE_TEST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 FA_ALMANAC_DIR

 DESCRIPTION:

	Function to read fast_archive.conf a parse out the almanac directory

 RETURN VALUE:

	If successful, The almanac directory, else the string: '-error-'

 REVISION HISTORY:

	@(#)fa_almanac_dir.pro	1.1 03/04/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Mar. '97

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_almanac_dir.pro">general/missions/fast/fa_ops/fa_almanac_dir.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_CDF_FILE_TEST">
<H2>FA_CDF_FILE_TEST</H2></A>
<A HREF="#FA_ALMANAC_DIR">[Previous Routine]</A>
<A HREF="#FA_DESPIN_PROCESS[1]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_cdf_file_test
PURPOSE:
Checks the current working directory for CDF files related to
orbit_process for a given orbit, and an SDT variable.
Returns the file size if available, or -1 for no file.
COMMAND SEQUENCE:
fsize = fa_cdf_file_test(orbit, dqd)
INPUT:
orbit = orbit number
dqd = SDT DQD for a given data quantity, eg: 'V1-V4_16k' for 16k data
      for booms 1 and 4. These are available in the process programs
      such as fa_fields_despin3.pro
OUTPUT:
fsize = file size in bytes, generally a file size less than 1600
        bytes has no data; a missing file returns a file size of -1
HISTORY:
2025-12-09, jmm, jimm@ssl.berkeley.edu
 $LastChangedBy: $
 $LastChangedDate: $
 $LastChangedRevision: $
 $URL: $
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_cdf_file_test.pro">general/missions/fast/fa_ops/fa_cdf_file_test.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_DESPIN_PROCESS[1]">
<H2>FA_DESPIN_PROCESS[1]</H2></A>
<A HREF="#FA_CDF_FILE_TEST">[Previous Routine]</A>
<A HREF="#FA_DESPIN_PROCESS[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_despin_process
PURPOSE:
For a given orbit or time interval, grab fields data already loaded
into sdt, via sdt_batch, run fa_fields_despin, and write out a CDF
file with the data.
CALLING SEQUENCE:
fa_despin_process, full_database_management = full_database_management, $
                   datatype = datatype
INPUT:
None, the data are assumed to have been loaded in an sdt_batch call
OUTPUT:
No explicit output
KEYWORDS:
full_database_management = if set, will handle deletion of a lock
file created by the shell script that calles the program, and
increment the file 'orbit.txt'. Also writes CDF file with proper
orbit and datetime in filename. Otherwise a generic CDF is produced.
datatype = 'S', 'svy' (same as S), '4k', '16k', the default is survey
data.
nocatch = run without the catch error block, so that you can debug
directory = if set, the data will be put in a subdirectory of this,
arranged by datatype and orbit number. The default is
/disks/data/fast/l2/. Only used for full_database_management option,
otherwise, the file is written to the current directory

HISTORY:
 19-mar-2024, jmm, jimm@ssl.berkeley.edu
 16-apr-2024, jmm, adds sc/potential to output
 5-sep-2024, jmm, added E_0_S_GSE, GSM, DSC, and all probe
                  potentials, version 3
 16-sep-2024, jmm, added spin axis direction in GSE, GSM, prepended
                   FAST_ to variables that didn't have
                   it. Dropped spinfit variables
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_despin_processa.pro">general/missions/fast/fa_ops/fa_despin_processa.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_DESPIN_PROCESS[2]">
<H2>FA_DESPIN_PROCESS[2]</H2></A>
<A HREF="#FA_DESPIN_PROCESS[1]">[Previous Routine]</A>
<A HREF="#FA_DESPIN_PROCESS_VATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_despin_process
PURPOSE:
For a given orbit or time interval, grab fields data already loaded
into sdt, via sdt_batch, run fa_fields_despin, and write out a CDF
file with the data.
CALLING SEQUENCE:
fa_despin_process, full_database_management = full_database_management, $
                   datatype = datatype
INPUT:
None, the data are assumed to have been loaded in an sdt_batch call
OUTPUT:
No explicit output
KEYWORDS:
full_database_management = if set, will handle deletion of a lock
file created by the shell script that calles the program, and
increment the file 'orbit.txt'. Also writes CDF file with proper
orbit and datetime in filename. Otherwise a generic CDF is produced.
datatype = 'S', 'svy' (same as S), '4k', '16k', the default is survey
data.
nocatch = run without the catch error block, so that you can debug
directory = if set, the data will be put in a subdirectory of this,
arranged by datatype and orbit number. The default is
/disks/data/fast/l2/. Only used for full_database_management option,
otherwise, the file is written to the current directory

HISTORY:
 19-mar-2024, jmm, jimm@ssl.berkeley.edu
 16-apr-2024, jmm, adds sc/potential to output
 5-sep-2024, jmm, added E_0_S_GSE, GSM, DSC, and all probe
                  potentials, version 3
 16-sep-2024, jmm, added spin axis direction in GSE, GSM, prepended
                   FAST_ to variables that didn't have
                   it. Dropped spinfit variables.
 10-dec-2025, jmm, Added dqds_to_check; this will check to see if
                   files were created by SDT for the given DQDs, and
                   writes the orbit number to a file, if there is no
                   useful data for that orbit. This is an aid to
                   reprocessing if an orbit does not show up in the
                   database.
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_despin_process.pro">general/missions/fast/fa_ops/fa_despin_process.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_DESPIN_PROCESS_VATT">
<H2>FA_DESPIN_PROCESS_VATT</H2></A>
<A HREF="#FA_DESPIN_PROCESS[2]">[Previous Routine]</A>
<A HREF="#FA_EFI_PROBEDATAFILE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_despin_process_vatt
PURPOSE:
Fills variable attributes for FAST despun Electric Field variables.
Note that this includes Survey (esv), e4k and e16k variables
CALLING SEQUENCE:
vatt = fa_despin_process_vatt(var)
INPUT:
var = a variable name
OUTPUT:
vatt = variable attributes, suitable for ISTPc compliant CDF files
      E.G.
     vatt_str = {CATDESC:'NA', $
                 DISPLAY_TYPE:'time_series', $
                 FIELDNAM:'NA', $
                 FORMAT:'E25.18', $
                 LABLAXIS:'NA', $;
                 UNITS:'undefined', $
                 VAR_TYPE:'data', $
                 FILLVAL:!values.d_nan, $
                 VALIDMIN:-10000.0, $
                 VALIDMAX:10000.0, $
                 DEPEND_0:'Epoch'}
HISTORY:
 2025-09-16, jmm, Hacked from fa_dsepin_process.pro
 jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_despin_process_vatt.pro">general/missions/fast/fa_ops/fa_despin_process_vatt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_EFI_PROBEDATAFILE">
<H2>FA_EFI_PROBEDATAFILE</H2></A>
<A HREF="#FA_DESPIN_PROCESS_VATT">[Previous Routine]</A>
<A HREF="#FA_FIELDS_BUFS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_efi_probedatafile
PURPOSE:
Creates a file /disks/data/fast/l2/fa_efi_probedata.csv
with probe data, distance from payload and phase angle with respect to
the sun phase
CALLING SEQUENCE:
fa_probedatafile
INPUT:
none
OUTPUT:
filename = creates a file with columns for FAST EFI probe phase and
           distances
HISTORY:
2024-11-20, jmm, jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_efi_probedatafile.pro">general/missions/fast/fa_ops/fa_efi_probedatafile.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_BUFS">
<H2>FA_FIELDS_BUFS</H2></A>
<A HREF="#FA_EFI_PROBEDATAFILE">[Previous Routine]</A>
<A HREF="#FA_FIELDS_COMBINE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FA_FIELDS_BUFS, dat, n, delta_t=delta_t,
                           buf_starts=buf_starts, buf_ends=buf_ends

 PURPOSE: Shows stretches of data with n or more points in a 
          row with no change in dt.

 INPUT:   
	dat  -     Fast fields data structure or data.
	     -     Or the time array
       n    -     OPTIONAL: Minimum number of points to make a buffer.
	     -     Default = 1024.

 KEYWORDS: 
	delta_t    - Allowable error in time steps. Default = 1.0e-6 s.
	buf_starts - OUTPUT. A list of starting indecies of good streaks.
	buf_ends   - OUTPUT. A list of ending indecies of good streaks.

 CALLING: fa_fields_bufs,dat               ; Survey data.

 OUTPUT: 
	buf_starts - A list of starting indecies of good streaks.
	buf_ends   - A list of ending indecies of good streaks.

 SEE: fa_fields_filter, etc.

 INITIAL VERSION: REE 97-03-17
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_bufs.pro">general/missions/fast/fa_ops/fa_fields_bufs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_COMBINE">
<H2>FA_FIELDS_COMBINE</H2></A>
<A HREF="#FA_FIELDS_BUFS">[Previous Routine]</A>
<A HREF="#FA_FIELDS_CROSS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_COMBINE, dat1, dat2, result=result, add=add, $
                   delt_t=delt_t, interp=interp, spline=spline, 
                   tag_2=tag_2, talk=talk 
                   tag_1=tag_1, time_offset=time_offset, svy=svy

 PURPOSE: Combines two time series data structures into one for dcE
          analysis or cross-spectral analysis, etc.

 INPUT:   
	dat1 -     MASTER data. dat1.time is used if /interp or dt options
                  are used
	dat2 -     .comp1 is put into result or are added to dat1 as 
                  comp(n+1) if /add. For now, no
                  multi-component data.

 KEYWORDS: 
       result -      dat2.comp1 time aligned with dat1.time.
       add -         Will cause result to be added to dat1 structure.
                     Using /add is very slow!
       delt_t -      Allowable delta t to determine a time match.
                     This is interpreted as allowable gap in interpolate 
                     and spline modes.
       interp -      Interpolate dat2 values to dat1 times. 
       spline -      Spline dat2 values to dat1 times. will not extrapolate.
       tag_1 -       The new component label in dat1 such as 'phase'.
                     If blank 'comp(n+1)' is used.
       tag_2 -       The tag name in dat2 to be added (e.g. 'comp3') to
                     dat1 structure. If not given, 'comp1' is assumed.
       time_offset - Subtract time_offset from dat2.time to help match time.
       svy -         Survey data. delt_t set to 0.9 of time step in dat1.
       talk -        Prints out diagnostic messages.

 CALLING: fa_fields_combine,V58,V12,/svy,/add          ; Survey data.
          Add phase to V58.
          fa_fields_combine,V58,PHI,tag1='PHASE',/interp,delt_t=100., /add

 OUTPUT: Result or comp(n+1) in dat1: IDL fields time series data 
         structure with multiple components. 

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-03
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_combine.pro">general/missions/fast/fa_ops/fa_fields_combine.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_CROSS">
<H2>FA_FIELDS_CROSS</H2></A>
<A HREF="#FA_FIELDS_COMBINE">[Previous Routine]</A>
<A HREF="#FA_FIELDS_CYCLOTRON">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FA_FIELDS_CROSS
       

 PURPOSE: A high level routine which produces FFT spectrum of 
          time series data. Result is a spectrogram as a function of
          time.  

 INPUT: 
       dat1        : A time series data structure. 
       dat2        : A second time series data structure.

 KEYWORDS: 
       store       : Store data as a tplot file. DEFAULT = 0
       npts        : OPTIONAL. The number of points in each FFT. 
                     DEFAULT = 1024
       nave        : OPTIONAL. The number FFTs to average.
                     DEFAULT = 4
       dt          : OPTIONAL. For time series data with different
                     time axes, this is the maximum time difference
                     allowable between two points before they are
                     time aligned. See FA_FIELDS_COMBINE for more
                     info. Ignored when CHAN2 is not used.
       slide       : OPTIONAL. Overlap between FFTs. DEFAULT = 0.5
       svy         : OPTIONAL. Ignores changes in the time axis due
                     to varying sample rates. (Not working yet.)
       structure   : OPTIONAL. When using /STORE, the output to the
                     user is a string (no actual data) in order to
                     save memory. If both stored tplot data and
                     explicit user-level data are desired, set the
                     structure keyword to a data name when using
                     /STORE.  
       tags        : OPTIONAL. An array of strings designating the
                     two tag names in DAT1 that should be used in the
                     cross-spectra. If CHAN2 is specified, the first
                     tag name corresponds to the DAT1 tag to be used,
                     and the second tag name corresponds to the tag
                     within CHAN2 to be used.
       talk        : OPTIONAL. Tells user some useful info during
                     processing. 


 CALLING: result = fa_fields_cross(dat)

 EXAMPLE: You have COMP1, COMP2 in a structure DAT:
          result = FA_FIELDS_CROSS(DAT) 
          Two structures DAT1 and DAT2:
          result = FA_FIELDS_CROSS(DAT1,chan2=DAT2)
          Tag names other than 'COMP1': Takes elements of TAGS -
          result = FA_FIELDS_CROSS(DAT1, chan2=DAT2, tags=['data1','data2']


 OUTPUT: RESULT is a data structure simlar to SFA or DSP. Function
         returns -1 on some errors.

 SIDE EFFECTS: May need lots of memory.

 INITIAL VERSION: ver 1.0 GTD 04-16-97
 MODIFICATION HISTORY: v1.1 GTD 07-21-97
 Space Sciences Lab, UC Berkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_cross.pro">general/missions/fast/fa_ops/fa_fields_cross.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_CYCLOTRON">
<H2>FA_FIELDS_CYCLOTRON</H2></A>
<A HREF="#FA_FIELDS_CROSS">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:   FA_FIELDS_CYCLOTRON, mag, filt=filt, t1=t1, t2=t2
		       
PURPOSE:   Stores as tplot arrays:
		(1) electron cyclotron frequency 	FCE
		(2) H+ cyclotron frequency 		FCH
		(3) He+ cyclotron frequency 		FCHe
		(4) O+ cyclotron frequency 		FCO
		(5) |B|					B_abs
		(6) B to Spin plane angle		B_SP_ang
 
INPUT:   
	mag - NOT NEEDED. PROGRAM WILL GET IF NOT SUPPLIED.
             Fast DQD = 'MagDC' 

 KEYWORDS: 
       filt    - Filter frequency in Hz. DEFAULT = 0.1
       t1      - Begin time.
       t2      - End time.

 USE: fa_fields_cyclotron

 ASSUMPTIONS: 
;
CREATED BY:	REE, 97-05-13
FILE:  fa_fields_cyclotron.pro
VERSION:  0.0
LAST MODIFICATION:  
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_cyclotron.pro">general/missions/fast/fa_ops/fa_fields_cyclotron.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN">
<H2>FA_FIELDS_DESPIN</H2></A>
<A HREF="#FA_FIELDS_CYCLOTRON">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN, V58, V12, T1 = t1, T2 = t2, 
                 PHASE = phase, USE_V158 = Use_V158, 
                 SHADOW_NOTCH = shadow_notch, 
                 MAG_NOTCH = mag_notch, STORE=store, SLOW=slow 

 PURPOSE: A high-level routine which produces despun DC electric field
          data for FAST.

 INPUT: 
    V58 -         If blank, program will get V5-V8_S. If you want
                  to run this program on burst data, use 
                  V58=get_fa_fields('V5-V8_4k',/all), for example.
    V12 -         If blank, program will get V1-V2_S
                  to run this program on burst data, use 
                  V12=get_fa_fields('V1-V2_4k',/all), for example.

 KEYWORDS: 
    USE_V158       If set, use V158, otherwise V1-V2. DEFAULT = 0
                   Note: be sure to set this if you supply V1-58!

    SHADOW_NOTCH - Notch out shadow spikes (also known as &quot;sun
                   spikes&quot;). These are set to NaN's, unless the
                   Sinterp keyword is set. The default is
                   SHADOW_NOTCH = 0, in which case the sun spikes are
                   left alone.

    MAG_NOTCH - Notch out mag pulses. These will be interpolated
                across, unless the Bnan keyword is set.The default is
                MAG_NOTCH = 1, so you must say ...,mag_notch=0,... if
                you want to see the mag spikes.

    STORE -        Store data for tplot.        DEFAULT = 1

    SLOW -         Uses FA_FIELDS_SPINFIT instead
                      of FF_QUICKFIT.  DEFAULT = 0

    T1, T2 -       Start and stop time, if other than that
                   contained in V58 and V12, (or if those 
                   quantities are not defined). 

 CALLING: fa_fields_despin,t1='1997-09-27/01:32',t2='1997-09-27/01:34'

       That's easy! Now you can plot E_near_B and E_equatorward.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V2_S (or V1-V4_S, V4_S
                       and V8_S), 1032_spinPhase

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin.pro">general/missions/fast/fa_ops/fa_fields_despin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN2">
<H2>FA_FIELDS_DESPIN2</H2></A>
<A HREF="#FA_FIELDS_DESPIN">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN, V58, V12, T1 = t1, T2 = t2, 
                 PHASE = phase, USE_V158 = Use_V158, 
                 SHADOW_NOTCH = shadow_notch, 
                 MAG_NOTCH = mag_notch, STORE=store, SLOW=slow 

 PURPOSE: A high-level routine which produces despun DC electric field
          data for FAST.

 INPUT: 
    V58 -         If blank, program will get V5-V8_S. If you want
                  to run this program on burst data, use 
                  V58=get_fa_fields('V5-V8_4k',/all), for example.
    V12 -         If blank, program will get V1-V2_S
                  to run this program on burst data, use 
                  V12=get_fa_fields('V1-V2_4k',/all), for example.

 KEYWORDS: 
    USE_V158       If set, use V158, otherwise V1-V2. DEFAULT = 0
                   Note: be sure to set this if you supply V1-58!

    SHADOW_NOTCH - Notch out shadow spikes (also known as &quot;sun
                   spikes&quot;). These are set to NaN's, unless the
                   Sinterp keyword is set. The default is
                   SHADOW_NOTCH = 0, in which case the sun spikes are
                   left alone.

    MAG_NOTCH - Notch out mag pulses. These will be interpolated
                across, unless the Bnan keyword is set.The default is
                MAG_NOTCH = 1, so you must say ...,mag_notch=0,... if
                you want to see the mag spikes.

    STORE -        Store data for tplot.        DEFAULT = 1

    SLOW -         Uses FA_FIELDS_SPINFIT instead
                      of FF_QUICKFIT.  DEFAULT = 0

    T1, T2 -       Start and stop time, if other than that
                   contained in V58 and V12, (or if those 
                   quantities are not defined). 

 CALLING: fa_fields_despin,t1='1997-09-27/01:32',t2='1997-09-27/01:34'

       That's easy! Now you can plot E_near_B and E_equatorward.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V2_S (or V1-V4_S, V4_S
                       and V8_S), 1032_spinPhase

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 Added quality flag variable, 2024-05-21, jmm, jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin2.pro">general/missions/fast/fa_ops/fa_fields_despin2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN3">
<H2>FA_FIELDS_DESPIN3</H2></A>
<A HREF="#FA_FIELDS_DESPIN2">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN3A">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN, V58, V12, T1 = t1, T2 = t2, 
                 PHASE = phase, USE_V158 = Use_V158, 
                 SHADOW_NOTCH = shadow_notch, 
                 MAG_NOTCH = mag_notch, STORE=store, SLOW=slow 

 PURPOSE: A high-level routine which produces despun DC electric field
          data for FAST.

 INPUT: 
    V58 -         If blank, program will get V5-V8_S. If you want
                  to run this program on burst data, use 
                  V58=get_fa_fields('V5-V8_4k',/all), for example.
    V12 -         If blank, program will get V1-V2_S
                  to run this program on burst data, use 
                  V12=get_fa_fields('V1-V2_4k',/all), for example.

 KEYWORDS: 
    USE_V158       If set, use V158, otherwise V1-V2. DEFAULT = 0
                   Note: be sure to set this if you supply V1-58!

    SHADOW_NOTCH - Notch out shadow spikes (also known as &quot;sun
                   spikes&quot;). These are set to NaN's, unless the
                   Sinterp keyword is set. The default is
                   SHADOW_NOTCH = 0, in which case the sun spikes are
                   left alone.

    MAG_NOTCH - Notch out mag pulses. These will be interpolated
                across, unless the Bnan keyword is set.The default is
                MAG_NOTCH = 1, so you must say ...,mag_notch=0,... if
                you want to see the mag spikes.

    STORE -        Store data for tplot.        DEFAULT = 1

    SLOW -         Uses FA_FIELDS_SPINFIT instead
                      of FF_QUICKFIT.  DEFAULT = 0

    T1, T2 -       Start and stop time, if other than that
                   contained in V58 and V12, (or if those 
                   quantities are not defined). 

 CALLING: fa_fields_despin,t1='1997-09-27/01:32',t2='1997-09-27/01:34'

       That's easy! Now you can plot E_near_B and E_equatorward.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V2_S (or V1-V4_S, V4_S
                       and V8_S), 1032_spinPhase

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 Added quality flag variable, 2024-05-21, jmm, jimm@ssl.berkeley.edu
 Updated qflag, to give more information about the notches
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin3.pro">general/missions/fast/fa_ops/fa_fields_despin3.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN3A">
<H2>FA_FIELDS_DESPIN3A</H2></A>
<A HREF="#FA_FIELDS_DESPIN3">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN_16K">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN, V58, V12, T1 = t1, T2 = t2, 
                 PHASE = phase, USE_V158 = Use_V158, 
                 SHADOW_NOTCH = shadow_notch, 
                 MAG_NOTCH = mag_notch, STORE=store, SLOW=slow 

 PURPOSE: A high-level routine which produces despun DC electric field
          data for FAST.

 INPUT: 
    V58 -         If blank, program will get V5-V8_S. If you want
                  to run this program on burst data, use 
                  V58=get_fa_fields('V5-V8_4k',/all), for example.
    V12 -         If blank, program will get V1-V2_S
                  to run this program on burst data, use 
                  V12=get_fa_fields('V1-V2_4k',/all), for example.

 KEYWORDS: 
    USE_V158       If set, use V158, otherwise V1-V2. DEFAULT = 0
                   Note: be sure to set this if you supply V1-58!

    SHADOW_NOTCH - Notch out shadow spikes (also known as &quot;sun
                   spikes&quot;). These are set to NaN's, unless the
                   Sinterp keyword is set. The default is
                   SHADOW_NOTCH = 0, in which case the sun spikes are
                   left alone.

    MAG_NOTCH - Notch out mag pulses. These will be interpolated
                across, unless the Bnan keyword is set.The default is
                MAG_NOTCH = 1, so you must say ...,mag_notch=0,... if
                you want to see the mag spikes.

    STORE -        Store data for tplot.        DEFAULT = 1

    SLOW -         Uses FA_FIELDS_SPINFIT instead
                      of FF_QUICKFIT.  DEFAULT = 0

    T1, T2 -       Start and stop time, if other than that
                   contained in V58 and V12, (or if those 
                   quantities are not defined). 

 CALLING: fa_fields_despin,t1='1997-09-27/01:32',t2='1997-09-27/01:34'

       That's easy! Now you can plot E_near_B and E_equatorward.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V2_S (or V1-V4_S, V4_S
                       and V8_S), 1032_spinPhase

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 Added quality flag variable, 2024-05-21, jmm, jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin3a.pro">general/missions/fast/fa_ops/fa_fields_despin3a.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN_16K">
<H2>FA_FIELDS_DESPIN_16K</H2></A>
<A HREF="#FA_FIELDS_DESPIN3A">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN_4K">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN_16k, V58, V14, V1458, phase=phase, fudge=fudge,
     shadow_notch=shadow_notch, mag_notch=mag_notch, store=store,
     save_mem=save_mem, t1=t1, t2=t2, nave=nave, slide=slide, nfft=nfft,
     spec=spec
       

 PURPOSE: A high level routine which produces despun DC efield
          data from sdt _16k data in SDT.

 INPUT: 
       V58 -         If not set, program will get V5-V8_16k. 
       V14 -         If not set, program will get V1-V4_16k
       V1458 -       If not set, program will get V1+V4-V5-V8_16k

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       shadow -      Notch out shadow pulses.           DEFAULT = 0
       mag -         Notch out mag pulses.              DEFAULT = 0
       store -       Store data as a tplot file.        DEFAULT = 1
       time -        OPTIONAL. The time range of data.  DEFAULT = /all
       save_mem -    BLOWS AWAY ARRAYS THAT ARE NO
                     LONGER NEEDED                      DEFAULT = 0
                     DEFAULT = 1 if V58, V14, V1458, 
                       and phase are not given.
       spec -        Will create a FFT spectra.         DEFAULT = 0
       nave -        FFT spectra.        		 DEFAULT = 4
       slide -       FFT spectra.        		 DEFAULT = 0.5
       nfft -        FFT spectra.        		 DEFAULT = 1024

 CALLING: fa_fields_despin_16k
       That's easy! Now you can plot E_near_B and E_along_V.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_16k, V1-V4_16k, and
                       V1458_16k, 1048_spinphase, 1048_spinnum, and
                       1048_magphase.

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin_16k.pro">general/missions/fast/fa_ops/fa_fields_despin_16k.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN_4K">
<H2>FA_FIELDS_DESPIN_4K</H2></A>
<A HREF="#FA_FIELDS_DESPIN_16K">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN_HG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN_4k, V58, V14, V1458, phase=phase, fudge=fudge,
     shadow_notch=shadow_notch, mag_notch=mag_notch, store=store, time=time,
     save_mem=save_mem, spec=spec
       

 PURPOSE: A high level routine which produces despun DC efield
          data from sdt _4k data in SDT.

 INPUT: 
       V58 -         If blank, program will get V5-V8_4k. 
       V14 -         If blank, program will get V1-V4_4k
       V1458 -       If blank, program will get V1+V4-V5-V8_4k

 KEYWORDS: 
       shadow -      Notch out shadow pulses.           DEFAULT = 0
       mag -         Notch out mag pulses.              DEFAULT = 0
       store -       Store data as a tplot file.        DEFAULT = 1
       time -        OPTIONAL. The time range of data.  DEFAULT = /all
       save_mem -    BLOWS AWAY ARRAYS THAT ARE NO
                     LONGER NEEDED                      DEFAULT = 0
                     DEFAULT = 1 if V58, V14, V1458, 
                     and phase are not given.

       spec -        Will create a FFT spectra.         DEFAULT = 0

 CALLING: fa_fields_despin_4k
       That's easy! Now you can plot E_near_B and E_along_V.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_4k, V1-V4_4k, and
                       V1458_4k, 1032_spinphase, 1032_spinnum, and
                       1032_magphase.

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin_4k.pro">general/missions/fast/fa_ops/fa_fields_despin_4k.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN_HG">
<H2>FA_FIELDS_DESPIN_HG</H2></A>
<A HREF="#FA_FIELDS_DESPIN_4K">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DESPIN_HSBM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN_HG, V58, V14, phase=phase, spec=spec,
     save_mem=save_mem, t1=t1, t2=t2, nave=nave, slide=slide, nfft=nfft
       

 PURPOSE: A high level routine which produces despun DC efield
          data from sdt _16k data in SDT.

 INPUT: 
       V58 -         If blank, program will get V5-V8HG_16k. 
       V14 -         If blank, program will get V1-V4HG_16k

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       save_mem -    BLOWS AWAY ARRAYS THAT ARE NO
                     LONGER NEEDED                      DEFAULT = 0
                     DEFAULT = 1 if V58, V14, and phase are not given.
       spec -        Will create a FFT spectra.         DEFAULT = 0
       nave -        FFT spectra.        		 DEFAULT = 4
       slide -       FFT spectra.        		 DEFAULT = 0.5
       nfft -        FFT spectra.        		 DEFAULT = 1024

 CALLING: fa_fields_despin_HG_16k
       That's easy! Now you can plot E_near_B_HG and E_along_V_HG.

 IMPORTANT! SDT SETUP: Need to have: V5-V8HG_16k, V1-V4HG_16k, and
                       (1048_spinphase or 1048_magphase).

 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
			REE 97-07-06 Added spec option.
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin_hg.pro">general/missions/fast/fa_ops/fa_fields_despin_hg.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DESPIN_HSBM">
<H2>FA_FIELDS_DESPIN_HSBM</H2></A>
<A HREF="#FA_FIELDS_DESPIN_HG">[Previous Routine]</A>
<A HREF="#FA_FIELDS_DSP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DESPIN_HSBM, hsbm, phase=phase
       

 PURPOSE: A high level routine which produces despun DC efield
          data from sdt HSBM data in SDT.  This routine can also
          project three-dimensional HSBM data into a field-aligned
          coordinate system.

 INPUT: 
       hsbm -        REQUIRED. 

 KEYWORDS: 
       phase -       REQUIRED
       three_d, if set, then B_ANG is used to take the axial and
       despun spin plane fields into a field-aligned coordinate
       system.

       b_ang, float, angle between spin plane and local magnetic field,
       degrees.

 CALLING: fa_fields_despin_hsbm, hsbm, phase=phase


 OUTPUT: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-05-23
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley

 v. 1.1 John Bonnell, UCBSSL, February 26, 2001.
 fixed error in THREE_D transformation code 
 (old version overwrote one spin plane component before it could be
 used in both transformation equations).

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_despin_hsbm.pro">general/missions/fast/fa_ops/fa_fields_despin_hsbm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_DSP">
<H2>FA_FIELDS_DSP</H2></A>
<A HREF="#FA_FIELDS_DESPIN_HSBM">[Previous Routine]</A>
<A HREF="#FA_FIELDS_FFT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_DSP, dqd_name, dat=dat, all=all, use_HG=use_HG,
     t1=t1, t2=t2 
       

 PURPOSE: 
    A high level routine which acquires 

 INPUT: 
       dqd_name -      DSP dqd name or the last part of the name or
                       a number (see /list option). 
       		Example: 'V5-V8', 'V58', 'MAG', 'MaG', '58',
                       'Dsp_V5-V8' or 'DspADC_V5-V8' ALL OK.!
       		If blank, program will produce DSP OMNI. 
       SFA14 -         If blank, program will get DSP data.

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       store -       Stores DSP58 and DSP14 as well.    DEFAULT = 0
                     NOTE: DSP_OMNI ALWAYS STORED!
       save_mem -    BLOWS AWAY ARRAYS THAT ARE NO
                     LONGER NEEDED                      DEFAULT = 0
                     DEFAULT = 1 if DSP58, DSP14, and phase are not given.

 CALLING: fa_fields_dsp

 IMPORTANT! SDT SETUP: Need to have: Dsp_V5-V8(HG) AND Dsp_V1-V4(HG)

 OUTPUT: Stored in tplot.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_dsp.pro">general/missions/fast/fa_ops/fa_fields_dsp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_FFT">
<H2>FA_FIELDS_FFT</H2></A>
<A HREF="#FA_FIELDS_DSP">[Previous Routine]</A>
<A HREF="#FA_FIELDS_FILTER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FA_FIELDS_FFT, dat, store=store, npts=npts, nave=nave, slide=slide,
                          tags=tags, dt=dt
       

 PURPOSE: A high level routine which produces FFT spectrum of 
          time series data. 

 INPUT: 
       dat -         A time series data structure. 

 KEYWORDS: 
       store -       NOT WORKING. Store data as a tplot file.  DEFAULT = 0
       npts -        OPTIONAL. The number of points in FFT.    DEFAULT = 1024
       nave -        OPTIONAL. The number FFTs to average.     DEFAULT = 4
       slide -       OPTIONAL. Overlap between FFTs.           DEFAULT = 0.5

 CALLING: result = fa_fields_fft(dat)

 OUTPUT: RESULT is a data structure simlar to SFA or DSP.

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-04-10
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_fft.pro">general/missions/fast/fa_ops/fa_fields_fft.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_FILTER">
<H2>FA_FIELDS_FILTER</H2></A>
<A HREF="#FA_FIELDS_FFT">[Previous Routine]</A>
<A HREF="#FA_FIELDS_MAGDC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:  FA_FIELDS_FILTER, $
  dat, freq, mag=mag, db=db, recursive=recursive, 
  poles=poles, tags=tags, buf_len=buf_len, min_dt=min_dt,
  nan=nan, buf_dt=buf_dt 
		       
PURPOSE:   Filters the data COMP*.
 
INPUT:   
	dat       - NEEDED. Fields data of any type.
       freq      - NEEDED. Pole of filter. If band_pass: [f1,f2] f1&lt;f2
                 - If low-pass: [0,f]. If high-pass [f,0]
 
 KEYWORDS: 
       mag       - OPTIONAL. IF set, freq is % of Nyquist.
                   Note: /MAG IGNORED in recursive filter. 
       db        - OPTIONAL. If convol option is taken, default = 120. 
       recursive - OPTIONAL. Use of recursive filter:
                 - advantages: Faster and Mimics SDT.  
                 - disadvantages: Causes phase shift.  
       poles     - OPTIONAL. If recursive option is taken, 1-8 default = 8. 
       tag       - OPTIONAL. The tag name(s) of the data to be filtered. 
       buf_len   - OPTIONAL. The min stretch of continous data (DFLT = 10). 
       min_dt    - OPTIONAL. Allowable error in timeing. Default=1.e-6, may
                   want to set to 1.e-7 for HSBM.
       nan       - OPTIONAL. If set, will NAN data near edges. 
       buf_dt    - OPTIONAL. Allowable error in fa_fields_bufs call.

 USE: fa_fields_filter,dat,[0,1.0] ; Filter data to 1 Hz.

 RETURN: Filters the data in place.

CREATED BY:	REE, 97-03-17 - modified 97-10-03 REE added buf_dt
FILE:  fa_fields_filter.pro
VERSION:  0.0
LAST MODIFICATION:  
REE 97-04-08, Added NAN option.
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_filter.pro">general/missions/fast/fa_ops/fa_fields_filter.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_MAGDC">
<H2>FA_FIELDS_MAGDC</H2></A>
<A HREF="#FA_FIELDS_FILTER">[Previous Routine]</A>
<A HREF="#FA_FIELDS_PHASE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FA_FIELDS_MAGDC, t1=t1, t2=t2, fit=fit, twd=twd, tws=tws,
                              fit2=fit2, twd2=twd2, tws2=tws2,  
                              iterate=iterate
       
 PURPOSE: Gets mag data and calibrates accurately.

 INPUT: 
       mag -         OPTIONAL. 'MagDC' data structure.

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       iterate -     OPTIONAL. Will iterate fits twice.
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plot results.

 USED IN FF_MAG_SPEED: 
      	min_streak -  OPTIONAL. DEFAULT=40. Miniumun stretch of good data.

 USED IN FF_MAG_TORQUE:
       max_sig -     OPTIONAL. Max error in fit. DFLT=10 nT
      	max_x0 -      OPTIONAL. Maximum allowed x0. DFLT=40 nT.
                     Used to determine where torquers are on.

 USED IN FF_MAG_REJECT:
       max_err -     OPTIONAL. Maximun allowable error. DFLT = 100 nT
       ave_per -     OPTIONAL. S/C period.              DFLT = 5.0 s
       nper_trq -    OPTIONAL. Throw out points within nper_trq
                     spin periods of a torque boundary. DFLT = 1.5
       npts_speed_af OPTIONAL. Throw out npts_speed_after
                     a speed change boundary. DFLT = 40
       npts_speed_be OPTIONAL. Throw out npts_speed_before
                     a speed change boundary. DFLT = 5
       npts_per_spin-OPTIONAL. Too tricky to describe.  DFLT = 16
       max_sig2 -    OPTIONAL. Max error in fit.        DFLT = 10 nT
       n_sm -        OPTIONAL. N_points to smooth fits. DFLT = 21
	
 USED IN FF_MAG_TWD:
       max_sig3 -    OPTIONAL. Max error in tweak dynamic. DFLT = 10 nT
       n_sm_twd -    OPTIONAL. N_points to smooth fits. DFLT = 41


 CALLING: 
       mag=fa_fields_magdc()

 OUTPUT: 
      	mag -         A pointer struc containing results.
      	fit -         Fits of raw data.
      	twd -         Dynamic tweak matrix.
      	tws -         Static tweak matrix.
      	fit2 -        Fits of raw data, 2nd iteration.
      	twd2 -        Dynamic tweak matrix, 2nd iteration.
      	tws2 -        Static tweak matrix, 2nd iteration.

 INITIAL VERSION: REE/RJS/KRB 97-10-02 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_magdc.pro">general/missions/fast/fa_ops/fa_fields_magdc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_PHASE">
<H2>FA_FIELDS_PHASE</H2></A>
<A HREF="#FA_FIELDS_MAGDC">[Previous Routine]</A>
<A HREF="#FA_FIELDS_PWT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:   FA_FIELDS_PHASE, spin_phase, freq=freq
                      
PURPOSE:   Returns structure with smoothed B_phase as COMP1 and
           Sun_phase as COMP2 in radians. 
 
INPUT:   
       spin_phase - NOT NEEDED. PROGRAM WILL GET IF NOT SUPPLIED.
                    Fast DQD = 'SMPhase_FieldsSurvey0' stucture.

 KEYWORDS: 
       FREQ - Smoothing frequency. Default = 0.01. Set to 0 for no
       smooth.

       PRECISE - if set, uses housekeeping data (dqd is
       'AttitudeCtrl') to produce jitter-free sun phase, and then mag
       phase from GET_FA_ORBIT B_model calculation. 

       SPIN_AXIS - a named variable in which an estimate of the spin
       axis will be returned. Meaningless if /PRECISE is not set.

 USE: phase = fa_fields_phase()

 RETURN: Fields structure with smoothed B_phase and Sun_phase in radians.

CREATED BY:    REE, 97-03-03
FILE:  fa_fields_phase.pro
VERSION:  @(#)fa_fields_phase.pro	1.35 09/30/98 UCB SSL
LAST MODIFICATION:  
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_phase.pro">general/missions/fast/fa_ops/fa_fields_phase.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_PWT">
<H2>FA_FIELDS_PWT</H2></A>
<A HREF="#FA_FIELDS_PHASE">[Previous Routine]</A>
<A HREF="#FA_FIELDS_SFA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_PWT, pwt, trk, t1=t1, t2=t2, trig_dat=trig_dat
       

 PURPOSE: A high level routine which produces despun SFA
          data from SFABURST.

 INPUT: 
       pwt -         If blank, program will get &quot;ApId1051&quot; and calibrate. 
       trk -         If blank, program will get &quot;HfqTrkFrq&quot;.

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       trig_dat -    Optional if set, will use 'TRIG_SFATRK'.
                     NOTE: I DO NOT RECOMMEND USING 'TRIG_SFATRK' UNLESS
                           'HfqTrkFrq' IS NOT AVAILABLE. DO NOT PUBLISH!

 CALLING: fa_fields_pwt

 IMPORTANT! SDT SETUP: Need to have: &quot;ApId1051&quot; and &quot;HfqTrkFrq&quot;.
            CAN NOW USE 'TRIG_SFATRK' (SDT: TriggerData/SFATRK)

 OUTPUT: Stored in tplot format.

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-07-07
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_pwt.pro">general/missions/fast/fa_ops/fa_fields_pwt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_SFA">
<H2>FA_FIELDS_SFA</H2></A>
<A HREF="#FA_FIELDS_PWT">[Previous Routine]</A>
<A HREF="#FA_FIELDS_SPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FA_FIELDS_SFA, SFA58, SFA14, store=store,
     save_mem=save_mem, t1=t1, t2=t2, burst=burst, 
       

 PURPOSE: A high level routine which produces OMNI SFA data for plotting.

 INPUT: 
       SFA58 -         If blank, program will get V5-V8HG_16k. 
       SFA14 -         If blank, program will get V1-V4HG_16k

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       mag -         Does magnetometer data only.
       store -       Store data as a tplot file.        DEFAULT = 1
                     If store &gt; 1 then all data stored.
       burst -       Get burst data.                    DEFAULT = 0
       save_mem -    BLOWS AWAY ARRAYS THAT ARE NO
                     LONGER NEEDED                      DEFAULT = 0
                     DEFAULT = 1 if V58, V14, and phase are not given.

 CALLING: fa_fields_sfa

 IMPORTANT! SDT SETUP: Need to have: SfaBurst_V5-V8, (SfaBurst_V1-V4
                        or SfaBurst_V1-V2)

 OUTPUT: Stored in tplot.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_sfa.pro">general/missions/fast/fa_ops/fa_fields_sfa.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_SPEC">
<H2>FA_FIELDS_SPEC</H2></A>
<A HREF="#FA_FIELDS_SFA">[Previous Routine]</A>
<A HREF="#FA_FIELDS_SPINFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FA_FIELDS_SPEC
       

 PURPOSE: A high level routine which produces FFT spectrum of 
          time series data. 

 INPUT: 
       dat         - A time series data structure. 

 KEYWORDS: 
       store       : Store data as a tplot file. DEFAULT = 0
       npts        : OPTIONAL. The number of points in FFT. 
                     DEFAULT = 1024
       nave        : OPTIONAL. The number FFTs to average.
                     DEFAULT = 4
       slide       : OPTIONAL. Overlap between FFTs. DEFAULT = 0.5
       svy         : OPTIONAL. Ignores changes in the time axis due
                     to varying sample rates.
       db          : OPTIONAL. Specifies output to be in decibels
                     (10*log10(units^2/Hz))
       t_name      : OPTIONAL. A string array that sets the name of
                     the data in TPLOT.
       structure   : OPTIONAL. When the /STORE keyword is used, data
                     is not returned by the function (saves
                     memory). If both data and tplot variables are
                     desired, use  STRUCTURE = &lt;data name&gt; to extract
                     the data explicitly.
       tags        : OPTIONAL. Specifies what tag names in the FFT to
                     be used for the spectra. Othwerwise routine will
                     grab all components.

 CALLING: result = fa_fields_spec(dat)

 OUTPUT: RESULT is a data structure simlar to SFA or DSP.

 SIDE EFFECTS: Need lots of memory.

 LIMITATIONS: Does NOT account for changing data rates. Be careful.

 INITIAL VERSION: REE 97-04-10
 MODIFICATION HISTORY: GTD 97-04-16
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_spec.pro">general/missions/fast/fa_ops/fa_fields_spec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_SPINFIT">
<H2>FA_FIELDS_SPINFIT</H2></A>
<A HREF="#FA_FIELDS_SPEC">[Previous Routine]</A>
<A HREF="#FA_FIELDS_SPIN_AVE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FA_FIELDS_SPINFIT

 PURPOSE: To perform fits to the data from FAST spin plane sensors. 

 CALLING SEQUENCE: status = fa_fields_spinfit(data,TIMES=ts,X=x,$
                                     Y=y,MAG=mag, SUN = sun, STORE = store)
 
 INPUTS: DATA - a structure of the type returned by GET_FA_FIELDS. 
       
 KEYWORD PARAMETERS: TIMES - a named variable containing the center
                     times of the spinfit intervals. 

                     SLIDE - the time between fits, in fractions of a
                     spin. The default is 1.0.

                     INTERVAL - the length of time used for each fit,
                     in units of the spin period. The default is 1.0. 

                     X - a named variable in which the component of
                     the spinfit field along the sensor axis, for a
                     phase of zero, is returned. 

                     Y - a named variable in which the component of
                     the spinfit field perpendicular the sensor axis,
                     for a phase of zero, is returned. The spin axis
                     is equal to the cross product of the X and Y
                     directions. 
 
                     MAG - set this to do the spinfit with respect to
                     the background magnetic field. This is the default.

                     SUN - set this to spinfit with respect to the
                     Earth-Sun line. 

                     STORE - set this to store the resulting spinfit
                     fields for TPLOT. By default, this is set. 


 OUTPUTS: STATUS - If all goes well, 1 is returned, otherwise 0. 

 SIDE EFFECTS: If /STORE is set, or if neither X, Y or STORE is set,
               a TPLOT store of the spinfit components is performed.

 RESTRICTIONS: If your data are poorly modeled by a sinusoid,
               FA_FIELDS_SPINFIT will happily return nonsense. Severe
               sun spiking in electric field data is one known
               example of this. An algorithm to remove such spikes
               (through the NOTCH tag in fields structures) is in the
               works.

 EXAMPLE: if fa_fields_spinfit(v58data,/store,/mag) then begin
              tplot,['V5-V8_S_mag',''V5-V8_S_mag_perp']
          endif



 MODIFICATION HISTORY: Gathered together from summary plot routines,
                       in celebration of the vernal equinox, 1997, by
                       Bill Peria, UCB/SSL. 

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_spinfit.pro">general/missions/fast/fa_ops/fa_fields_spinfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_SPIN_AVE">
<H2>FA_FIELDS_SPIN_AVE</H2></A>
<A HREF="#FA_FIELDS_SPINFIT">[Previous Routine]</A>
<A HREF="#FA_FIELDS_STORE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FA_FIELDS_SPIN_AVE

 PURPOSE: Performs spin averages on FAST fields structures

 CALLING SEQUENCE: fa_fields_spin_ave, data, BOX = box, SVD = svd,
                   NOTCH = notch, CENTER = center,phase = phase,
                   Sphase = sphase, MAG = mag, SUN = sun, SLIDE =
                   slide, INTERVAL = interval, NAME = name
 
 INPUTS: DATA - a FAST fields data structure, or an array (which must
         then be sent along with a DQD, and a time or phase array. 
       
 KEYWORD PARAMETERS: BOX -  DEFAULT. If non-zero, a boxcar average
                     over BOX number of spins is performed. 

                     SVD - OPTIONAL. if set, a spin-by-spin linear fit is
                     performed and the spin-centered offsets are
                     returned. 

                     NOTCH - OPTIONAL. if set, ff_notch is called and
                     the &quot;bad&quot; phases of the data are weighted zero.

                     CENTER - OPTIONAL. the phase (mag or sun) in
                     degrees at which the values in DATA are located
                     after averaging. Has no effect if TIME is
                     defined. Default is zero.

                     PHASE -  an array of phases, defined any way the
                     user wishes, except that they *must* be
                     monotonically increasing, i.e. atan(by,bx) is no
                     good for more than one spin. Also, the PHASE
                     array must be of the same size as the data
                     with which it will be paired. 

                     FUNCT - if SVD is set, a string name of a model
                     function for use by SVDFIT.

                     MAG - DEFAULT if set, do average with respect to mag
                     phase. 

                     SUN - if set, do fit average with respect to sun
                     phase. 

                     STORE - if set, cause a TPLOT store of the
                     spin-averaged data, and does not overwrite the
                     input structure.

                     INTERVAL - the period over which to perform each
                     average, in units of one spin period. Default is
                     1.0. 

                     SLIDE - the time between succesive averages, in
                     units of a spin period. Default is 1.0. 

                     NAME - a string to use for the DATA_NAME in the
                     returned structure or the TPLOT name of the
                     stored quantity. 


 
 OUTPUTS: DATA - the input structure is spin-averaged in place,
          unless STORE is set.

 SIDE EFFECTS: the original data are averaged, and destroyed, unless
               STORE is set.

 EXAMPLE: pot = get_fa_potential()
          fa_fields_spin_ave,potential
           
 MODIFICATION HISTORY: written 2-April-1997 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_spin_ave.pro">general/missions/fast/fa_ops/fa_fields_spin_ave.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_STORE">
<H2>FA_FIELDS_STORE</H2></A>
<A HREF="#FA_FIELDS_SPIN_AVE">[Previous Routine]</A>
<A HREF="#FA_FIELDS_UNITS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FA_FIELDS_STORE

 PURPOSE: To perform a tplot store of FAST fields structures, like
          those returned by GET_FA_FIELDS.

 CALLING SEQUENCE: data = get_fa_fields('V5-V8_S')
                   fa_fields_store,data

 INPUTS: A fields structure (up to six of them, actually.) The tags
         DATA_NAME, VALID, and COMP* TIME are required.

 KEYWORDS: NAME - a string for an alternate name to use for TPLOT
           storage, otherwise, DATA.DATA_NAME is used. 

 SIDE EFFECTS: The data are TPLOT stored. The data are assumed to be
               in the COMP* tags, and the TIME tag is used for time. 

 MODIFICATION HISTORY: written 29-April-1997 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_store.pro">general/missions/fast/fa_ops/fa_fields_store.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_FIELDS_UNITS">
<H2>FA_FIELDS_UNITS</H2></A>
<A HREF="#FA_FIELDS_STORE">[Previous Routine]</A>
<A HREF="#FA_NADIR_FROM_HORIZ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FA_FIELDS_UNITS



 PURPOSE: To perform units conversions for the FAST fields
 instruments. Calls Bob Ergun's fastcal library. 

 CALLING SEQUENCE: fa_fields_units,data,VERBOSE=VERBOSE, $
					DATA_HEADER=DATA_HEADER
                         The times series values     
                         contained in the DATA structure will have
                         their units converted. Time series must be
                         designated by structure tags &quot;COMP*&quot;, where
                         &quot;*&quot; is 1, 2, 3, etc. The string new_units
                         contains the name of whatever units the data
                         are returned in, i.e. it might be the same
                         as the old units!
                         

 INPUTS: A structure called DATA is passed in. It must contain :
              - a tag called 'DATA_NAME', which must contain a valid
                SDT DQD. 
              - a tag beginning with 'COMP', like 'COMP1', which
                contains time series data. 
              - a tag called 'UNITS_NAME' which contains the units
                currently in use for DATA.COMP*
              - a tag called CALIBRATED, which indicates whether or
                not there's any calibrating to do!
       
 KEYWORD PARAMETERS:  	VERBOSE - if set, tells the user what's been
                                converted 
			DATA_HEADER - Generally, its a good idea to
				fill in the data_header. If it is not
				filled in, defaults will be used which
				could result in improper calibrations.
				DATA_HEADER should be 10 or 14 bytes.

 OUTPUTS: The with structure DATA, perhaps with some rescaled parts.


 SIDE EFFECTS: Those parts of DATA which contain time series data
 will be rescaled according to the calibration information encoded in
 the fastcal library. 

 RESTRICTIONS: Structure tags &quot;comp*&quot;, &quot;start_time&quot;, &quot;data_name&quot;, and
 &quot;units_name&quot;, and &quot;valid&quot;  are required. For 2d structures, DSP and SFA,
 structure tags 'yaxis' and 'yaxis_units' are required.

 MODIFICATION HISTORY: Originally written 5-July-1996 by Bill Peria,
 Space Scienes Lab, UCBerkeley
 
 96-10-26	REE 	Major rewrite. No new_units and scale.
 96-11-05	REE 	Modifed to accomodate DSP, SFA, and time series.
			Still needs FPA (Frequency/Phase/Amplitude) structures.
 			Still needs MAG, WPC, and HFQ structures.
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_fields_units.pro">general/missions/fast/fa_ops/fa_fields_units.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_NADIR_FROM_HORIZ">
<H2>FA_NADIR_FROM_HORIZ</H2></A>
<A HREF="#FA_FIELDS_UNITS">[Previous Routine]</A>
<A HREF="#FA_NADIR_SUN_AZIM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FA_NADIR_FROM_HORIZ

 PURPOSE:
	Calculate the earth nadir from horizon crossing times for FAST.

 CALLING SEQUENCE:
	nadir = fa_nadir_from_horiz (horizCross, orbData)
 
 INPUTS:
	horizCross:	And array of the structure: 
			{setime: double, estime: double}, where setime
			and estime are seconds since 1970.  These are
			the horizon crossing times.
	orbData:	The orbit data from get_fa_orbit that covers
			the times given in horizCross.

 KEYWORD PARAMETERS:

 OUTPUTS:
	nadir:		The array of earth nadir times derived.

 MODIFICATION HISTORY:
	@(#)fa_nadir_from_horiz.pro	1.1 02/12/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Oct '97
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_nadir_from_horiz.pro">general/missions/fast/fa_ops/fa_nadir_from_horiz.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_NADIR_SUN_AZIM">
<H2>FA_NADIR_SUN_AZIM</H2></A>
<A HREF="#FA_NADIR_FROM_HORIZ">[Previous Routine]</A>
<A HREF="#FA_OUTPUT_PATH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: fa_nadir_sun_azim

 PURPOSE:
	For FAST, Get azimuthal angles in the spin plane between the
	earth nadir and sun direction.

 CALLING SEQUENCE:
	azimAngles = fa_nadir_sun_azim (nadir, orbData)
 
 INPUTS:
	nadir: 		An array of times where the nadir of the earth
			intersects the spin plane of the satellite.
	orbData:	The orbit data from get_fa_orbit that covers
			the times given in nadir.

 KEYWORD PARAMETERS:

 OUTPUTS:
	azimAngles:	This is the returned array of aximuthal angles
			in the satellite spin plane between the earth
			nadir and the satellite sun direction.
			Upon error, -1 is returned.

 NOTES:
	This routine calls get_fa_fdf_att to get the spin vector for
	the times given in the nadir input array.  This is done for
	the start and end of this time span.  If these two vectors
	change, then get_fa_fdf_att is called for each point in the
	nadir array, else the spin vector is considered constant
	throughout.

 MODIFICATION HISTORY:
	@(#)fa_nadir_sun_azim.pro	1.1 02/12/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Oct '97
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_nadir_sun_azim.pro">general/missions/fast/fa_ops/fa_nadir_sun_azim.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_OUTPUT_PATH">
<H2>FA_OUTPUT_PATH</H2></A>
<A HREF="#FA_NADIR_SUN_AZIM">[Previous Routine]</A>
<A HREF="#FA_SHADOW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 FA_OUTPUT_PATH

 DESCRIPTION:

	Function to generate a pathname for output files for the FAST project.


 USAGE (SAMPLE CODE FRAGMENT):
 
	base_path = '/disks/juneau/scratch'
	data_level = k0
	type = 'ees'
	orbit = 100
	further_desc = 'is'
	ext = 'gif'
	path = fa_output_path( base_path, data_level, type, orbit, $
	                       further_desc, ext)
	print, path

  --- output would be:

	/disks/juneau/scratch/fa_k0_ees_00100_is.gif

 ARGUMENTS:

	base_path:     STRING, base path component of the output filename
	data_level:    STRING, the data level.  For example: k0, ql.
	type:          STRING, usually one of 'ees', 'ies', 'dcf', 'acf', 'tms'
	orbit:         The orbit of the data.
	further_desc:  STRING, this will be inserted in the filename after
	               the orbit. 
	ext:           STRING: The filename extension.  If it is the
	               empty string it means ther is no extension.

 RETURN VALUE:

	The path for the output file as given above will be
	returned, unless  an error occurs, in which case the 
	string: &quot;INVALID&quot; is returned.

 REVISION HISTORY:

	@(#)fa_output_path.pro	1.1 10/08/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Oct. '96

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_output_path.pro">general/missions/fast/fa_ops/fa_output_path.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_SHADOW">
<H2>FA_SHADOW</H2></A>
<A HREF="#FA_OUTPUT_PATH">[Previous Routine]</A>
<A HREF="#FA_SPEC_PROCESS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FA_SHADOW

 PURPOSE: To compute when FAST is in shadow or sunlight.

 CALLING SEQUENCE: fa_shadow,t1,t2,USE=use NO_STORE=no_store, 
                   DELTA_T = delta_t, STRUC = struc
 
 OPTIONAL INPUTS: T1: start time in seconds since 1970, or as a
                  string. If T1 is an array, then those times are
                  used and T2 is ignored. 

                  T2: end time 

                  DELTA_T: time between points, ignored if T1 is an
                           array, default is 20 seconds. 
       
 KEYWORD PARAMETERS: USE: a TPLOT string handle pointing to a quantity
                       from which to grab the timespan.

                     NO_STORE: inhibits tplot storing.

                     STRUC: a named variable in which the shadow info
                            is returned.

                     NO_CALL: inhibits the call to GET_FA_ORBIT. The
                              quantity 'fa_pos' must already have
                              been stored by a previous *appropriate*
                              call to GET_FA_ORBIT.

                     FOOTPOINT: if set, determines the sunlit
                                condition of the footpoint of the
                                field line threading FAST, instead of
                                at the position of FAST.
 

   If none of these are defined, FA_SHADOW will use the currently
   occurring orbit, and will do a tplot store. 

 OUTPUTS: A TPLOT quantity called 'sunlit?' is stored, which has
          values of 0 or 1, labeled 'yes' and 'no' when plotted, and
          the STRUC keyword contains the same information. 

 SIDE EFFECTS: If T1 or T2 is defined, then GET_FA_ORBIT is called
               and previously stored orbit data will be over-written. 

 EXAMPLE: fa_shadow,use='ORBIT'
           This will compute sun/shadow at those times when ORBIT is
           currently stored. 

 MODIFICATION HISTORY: 23-April-1997 Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_shadow.pro">general/missions/fast/fa_ops/fa_shadow.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_SPEC_PROCESS">
<H2>FA_SPEC_PROCESS</H2></A>
<A HREF="#FA_SHADOW">[Previous Routine]</A>
<A HREF="#FA_SPEC_PROCESS_VATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_spec_process
PURPOSE:
For a given orbit or time interval, grab fields spectral data (DSP,
SVY) already loaded into sdt, via sdt_batch, and write out a CDF
file with the data.
CALLING SEQUENCE:
fa_spec_process, full_database_management = full_database_management, $
                 datatype = datatype
INPUT:
None, the data are assumed to have been loaded in an sdt_batch call
OUTPUT:
No explicit output
KEYWORDS:
full_database_management = if set, will handle deletion of a lock
file created by the shell script that calles the program, and
increment the file 'orbit.txt'. Also writes CDF file with proper
orbit and datetime in filename. Otherwise a generic CDF is produced.
datatype = 'sfa' or 'dsp', the default is DSP data. Not case sensitive.
nocatch = run without the catch error block, so that you can debug
directory = if set, the data will be put in a subdirectory of this,
arranged by datatype and orbit number. The default is
/disks/data/fast/l2/. Only used for full_database_management option,
otherwise, the file is written to the current directory

HISTORY:
 28-Oct-2025, jmm, jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_spec_process.pro">general/missions/fast/fa_ops/fa_spec_process.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_SPEC_PROCESS_VATT">
<H2>FA_SPEC_PROCESS_VATT</H2></A>
<A HREF="#FA_SPEC_PROCESS">[Previous Routine]</A>
<A HREF="#FA_SUN_PULSE_FROM_AZIM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
fa_spec_process_vatt
PURPOSE:
Fills variable attributes for FAST SFa, Dsp variables.
CALLING SEQUENCE:
vatt = fa_spec_process_vatt(var)
INPUT:
var = a variable name
OUTPUT:
vatt = variable attributes, suitable for ISTP compliant CDF files
      E.G.
     vatt_str = {CATDESC:'NA', $
                 DISPLAY_TYPE:'time_series', $
                 FIELDNAM:'NA', $
                 FORMAT:'E25.18', $
                 LABLAXIS:'NA', $;
                 UNITS:'undefined', $
                 VAR_TYPE:'data', $
                 FILLVAL:!values.d_nan, $
                 VALIDMIN:-10000.0, $
                 VALIDMAX:10000.0, $
                 DEPEND_0:'Epoch'}
HISTORY:
 2025-10-28, jmm, Hacked from fa_dsepin_process.pro
 jimm@ssl.berkeley.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_spec_process_vatt.pro">general/missions/fast/fa_ops/fa_spec_process_vatt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_SUN_PULSE_FROM_AZIM">
<H2>FA_SUN_PULSE_FROM_AZIM</H2></A>
<A HREF="#FA_SPEC_PROCESS_VATT">[Previous Routine]</A>
<A HREF="#FA_TS_EFF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: fa_sun_pulse_from_azim

 PURPOSE:
	For the FAST satellite, calculates the time of a sun pulse
	would occur based upon the earth nadir time, spin period,
	azimuthal angle between sun direction and nadir direction in 
	the spin plain.

 CALLING SEQUENCE:
	simSunpulseArr = $
		fa_sun_pulse_from_azim(azim, nadir, period)
 
 INPUTS:
	azim: 		Array of azimuthal angles between the sun
			direction and the earth nadir in the spin plane
	nadir:		An array times when the earth nadir is crossed
			by the sun sensor.
	period:		Period of one spin of the spacecraft in seconds.

 KEYWORD PARAMETERS:

 OUTPUTS:
	simSunpulseArr:	This is the returned array of simulated
			sun pulse times, one array element for each
			input time given in the nadir parameter.

 MODIFICATION HISTORY:
	@(#)fa_sun_pulse_from_azim.pro	1.1 02/12/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Nov '97
</PRE><P>
<STRONG>(See <A href="fa_ops/fa_sun_pulse_from_azim.pro">general/missions/fast/fa_ops/fa_sun_pulse_from_azim.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_TS_EFF">
<H2>FA_TS_EFF</H2></A>
<A HREF="#FA_SUN_PULSE_FROM_AZIM">[Previous Routine]</A>
<A HREF="#FA_TS_EFF_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
        FA_TS_EFF

 DESCRIPTION:

        function to calculate teams survey efficiency.

 INPUT:
        en:   Arrary (nnrgs, nbins) of energy 
	 pac:  A number for the calculation of post acceleration voltage
	 spec: Species for which the effciency is calculated. (0--3)
	 mode: Teams instrument mode. (0--9)
	 spin_section: The spin section of data readout (0--2)
		      0: don't care section.1: first half spin, 2: 2nd half spin
 RETURN:
	 eff(nnrgs, nbins): Efficiency
	 eff_version:       The version number of calibration data

 CREADED BY:
	     Li Tang,  University of New Hampshire

 LAST MODIFICATION:     10/22/96.    L.Tang	

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_ts_eff.pro">general/missions/fast/fa_ops/fa_ts_eff.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_TS_EFF_EQ">
<H2>FA_TS_EFF_EQ</H2></A>
<A HREF="#FA_TS_EFF">[Previous Routine]</A>
<A HREF="#FA_TTOF_CALIBRATION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
        FA_TS_EFF_EQ

 DESCRIPTION:

        function to calculate teams survey efficiency on equator angle bins

 INPUT:
        en:   Arrary (nnrgs, nbins) of energy 
	 pac:  A number for the calculation of post acceleration voltage
	 spec: Species for which the effciency is calculated. (0--3)
	 mode: Teams instrument mode. (0--9)
	 spin_section: The spin section of data readout (0--2)
		      0: don't care section.1: first half spin, 2: 2nd half spin
 RETURN:
	 eff(nnrgs, nbins): Efficiency
	 eff_version:       The version of calibration data

 CREADED BY:
	     Li Tang,  University of New Hampshire

 LAST MODIFICATION:     8/14/96.    LT

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_ts_eff_eq.pro">general/missions/fast/fa_ops/fa_ts_eff_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_TTOF_CALIBRATION">
<H2>FA_TTOF_CALIBRATION</H2></A>
<A HREF="#FA_TS_EFF_EQ">[Previous Routine]</A>
<A HREF="#FA_WEB_PATH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
	 FA_TTOF_CALIBRATION

 DESCRIPTION:
	 
	 to calculate the teams Time Of Flight(TOF)

 INPUT:
        energy: Array (nnrgs, nbins) of energy
	 pac:    pac:  A number for the calculation of post acceleration voltage

 RETURN:
	 TOF_EFF(nenergy, pixels, species)
        version:  version of calibration data.

 CREADED BY:
	     Li Tang,  University of New Hampshire, Space Physics Lab

 LAST MODIFICATION:     8/14/96.    LT

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_ttof_calibration.pro">general/missions/fast/fa_ops/fa_ttof_calibration.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FA_WEB_PATH">
<H2>FA_WEB_PATH</H2></A>
<A HREF="#FA_TTOF_CALIBRATION">[Previous Routine]</A>
<A HREF="#FDF_ORB_WRITE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 FA_WEB_PATH

 DESCRIPTION:

	Function to generate a pathname where one would write world wide
	web files for the FAST project.	


 USAGE (SAMPLE CODE FRAGMENT):
 
	base_path = '/disks/cdstudio/WWWSUM'
	time = str_to_time ('1997-1-1/00:00:00')
	data_level = 'k0'
	type = 'ees'
	orbit = 100
	auroral_cross = 'is'
	ext = 'gif'
	path = fa_web_path( base_path, time, data_level, type, orbit,  $
	                    auroral_cross, ext)
	print, path

  --- output would be:

	/disks/cdstudio/WWWSUM/1997_01_01_00100/fa_k0_ees_00100_is.gif

 ARGUMENTS:

	base_path:     STRING, this is the to level directory where
	               the www files reside.
	time:          Any standard time type: the start time of the
	               data.
	data_level:    STRING, the data level.  For example: k0, ql.
	type:          STRING, one of 'ees', 'ies', 'dcf', 'acf', 'tms'
	orbit:         The orbit of the data.
	auroral_cross: STRING, this is one of 'in', 'on', 'is', 'os'
	ext:           STRING: The file type, must be one of 'gif',
	               'ps', ''.  (The empty string means no extension.)

 RETURN VALUE:

	The path for the web file as given above will be
	returned, unless  an error occurs, in which case the 
	string: &quot;INVALID&quot; is returned.

 REVISION HISTORY:

	@(#)fa_web_path.pro	1.4 10/08/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Oct. '96

</PRE><P>
<STRONG>(See <A href="fa_ops/fa_web_path.pro">general/missions/fast/fa_ops/fa_web_path.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FDF_ORB_WRITE">
<H2>FDF_ORB_WRITE</H2></A>
<A HREF="#FA_WEB_PATH">[Previous Routine]</A>
<A HREF="#FF_DAT_TO_PTR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:      FDF_ORB_WRITE

 PURPOSE:       Writes an orbit file in the style of the FDF for use
                as an input file to orbgen.  The file will contain
                only an epoch, position vector, and velocity vector.
                Orbgen does not need the other orbit parameters
                (ecc., manomaly, etc.) to propagate an orbit when
                given this form of input.

 KEYWORDS:

   EPOCH        The time for which the position and velocity vectors
                are given. (String or double float.)
   POSITION     Three-element position vector in GEI.
   VELOCITY     Three-element velocity vector in GEI.
   FILE         The name of the file to be created.

 CREATED:       97-8-21
                By J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/fdf_orb_write.pro">general/missions/fast/fa_ops/fdf_orb_write.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DAT_TO_PTR">
<H2>FF_DAT_TO_PTR</H2></A>
<A HREF="#FDF_ORB_WRITE">[Previous Routine]</A>
<A HREF="#FF_DCE_FIX">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PRO: FF_DAT_TO_PTR, dat, tags=tags, streak=streak, double=double

 PURPOSE: Converts all 'tags' to pointers. These include all arrays which
 	   are length npts if npts &gt; 100. Will convert streaks if asked.

 CALLING: fu_dat_to_ptr,dat, /streak, /double
 	   Pretty simple! 

 INPUTS: A valid FAST fields data structure.
       
 KEYWORD PARAMETERS: 
           tags - 	OPTIONAL. If given, only tags are converted.
           streak -    OPTIONAL. IF set, 'STREAK*' will be converted to ptr.
           double -    OPTIONAL. IF set, 'COMP*' will be converted to double.

 OUTPUTS: Alters dat.

 INITIAL VERSION: REE 97_10_20
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_dat_to_ptr.pro">general/missions/fast/fa_ops/ff_dat_to_ptr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DCE_FIX">
<H2>FF_DCE_FIX</H2></A>
<A HREF="#FF_DAT_TO_PTR">[Previous Routine]</A>
<A HREF="#FF_DESPIN_HSBM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_DCE_FIX, dat, time, zero, zt, ratio, rt
       
 PURPOSE: Routine called by fa_fields despin to fix zero level and 
          relative gain of dcE signals. Not for general use.

 INPUT: 
       dat  -        REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
       time -        REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
       zero -        REQUIRED. The zero level is subtracted.
       zt   -        REQUIRED. Time array of zero.
       ratio-        Optional. The ratio is multiplied.
       rt   -        Time array of ratio.

 KEYWORDS: 

 CALLING: ff_dce_fix,dat,time,zero,zt,ratio,rt

 OUTPUT: Fixes zero level and gain of data.

 INITIAL VERSION: REE 97-03-29
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_dce_fix.pro">general/missions/fast/fa_ops/ff_dce_fix.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DESPIN_HSBM">
<H2>FF_DESPIN_HSBM</H2></A>
<A HREF="#FF_DCE_FIX">[Previous Routine]</A>
<A HREF="#FF_DESPIN_SVY_LONG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_DESPIN_HSBM, hsbm, phase=phase, t1=t1, t2=t2, pole=pole,
             epar=epar, eperp=eperp, eax=eax, bsc=bsc, three_d=three_d,
             b_ang=b_ang
       
 PURPOSE: ROUTINE TO GET HSBM IN FIELD-ALIGNED COORDINATES.

 INPUT: 
       hsbm -        OPTIONAL. 

 KEYWORDS: 
       phase -       OPTIONAL. WILL GET 1032 PHASE.
       t1 -          HIGHLY RECOMMENDED! Start time.
       t2 -          HIGHLY RECOMMENDED! End time.
       pole -        OPTIONAL. High-pass pole. Default = 300 Hz.
       three_d -     OPTIONAL. Performs 3_d despin.
       b_ang -       OPTIONAL. Angle between Bo and spion plane.
       freqe -       OPTIONAL. Passband for hsbm e.
       freqb -       OPTIONAL. Passband for hsbm b.
       store -       OPTIONAL. Stores data for tplot.
       plot -        OPTIONAL. Plots data.
       mode -        OPTIONAL. Provide mode if you have it - saves time.
       delta_t -     OPTIONAL. Corrects timing error by adding to time.

 CALLING: ff_despin_hsbm, t1=t1, t2=t2

 SDT: NEED (1) One hsbm.comp*, (2) 1032_spin_phase, (3) 1032_mode.

 OUTPUT: hsbm is IDL fields time series data structure.
       epar -        OUTPUT. Parallel electric field.
       eperp -       OUTPUT. Perpendicular electric field in spin plane.
       eax -         OUTPUT. Axial perpendicular electric field.
       bsc -         OUTPUT. Search Coil.
       time -        OUTPUT. 

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-12-23
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_despin_hsbm.pro">general/missions/fast/fa_ops/ff_despin_hsbm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DESPIN_SVY_LONG">
<H2>FF_DESPIN_SVY_LONG</H2></A>
<A HREF="#FF_DESPIN_HSBM">[Previous Routine]</A>
<A HREF="#FF_DSP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_DESPIN_SVY_LONG, t1 = t1, t2 = t2, 
	store=store, fmax=fmax,
	talk=talk, fix_zero=fix_zero, 
       t_res=t_res, mpot=mpot, sweeps=sweeps

 PURPOSE: Produces Eperp and Epar from long wire booms in survey mode.

 INPUT: 

 KEYWORDS: 
    STORE -        Store data for tplot.        DEFAULT = 1
    FIX_ZERO -     Fixes the zero level.        DEFAULT = 0
    FAMX -         Maximum frequency.           DEFAULT = 10 Hz
    T_RES -        Resolution of stored data.   DEFAULT = 0.025 s
    TALK -         Sends messages.              DEFAULT = 0
    MPOT -         Maximum abs(potential).      DEFAULT = 15
    SWEEPS -       Start/stop times of sweeps.  DEFAULT = 0
    T1, T2 -       Start and stop time, if other than that
                   contained in V58 and V12, (or if those 
                   quantities are not defined). 
;
 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V4_S , V4_S
                       and V8_S, 1032_spinPhase

 OUTPUT:
 
 NOTES: Dat is IDL fields time series data structure with multiple
         components. This  

 SIDE EFFECTS: Need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_despin_svy_long.pro">general/missions/fast/fa_ops/ff_despin_svy_long.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DSP">
<H2>FF_DSP</H2></A>
<A HREF="#FF_DESPIN_SVY_LONG">[Previous Routine]</A>
<A HREF="#FF_DSP_POWER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_DSP, dqd_name, dat=dat, store=store, use_HG=use_HG
     t1=t1, t2=t2 
       
 PURPOSE: A low level routine which produces OMNI DSP data for plotting.
  Use FA_FIELDS_DSP for general work.
       
 INPUT: 
       dqd_name -    A valid SDT dqd name. 

 KEYWORDS: 
       t1 -          Optional start time.
       t2 -          Optional end time.
       store -       Stores data.    DEFAULT = 1

 OUTPUT: Stored as tplot quantity or:
       dat -         The IDL data structure.
       use_HG -      Indicates is data is high gain.

 CALLING: ff_dsp, 'DspADC_V5-V8'

 OUTPUT: Stored in tplot.

 INITIAL VERSION: REE 97-11-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_dsp.pro">general/missions/fast/fa_ops/ff_dsp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_DSP_POWER">
<H2>FF_DSP_POWER</H2></A>
<A HREF="#FF_DSP">[Previous Routine]</A>
<A HREF="#FF_FIXTIME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_DSP_POWER, f_range=f_range  

 PURPOSE: 
  computes integrated spectral density in a given frequency interval
  using DSP electric and magnetic field data and stores it in TPLOT
  variables.

 INPUT: 
 DSP data is assumed to be stored in TPLOT 
 (DSP_OMNI and DSP_Mag3ac); 
 run FA_FIELDS_DSP prior to running this procedure.

 KEYWORDS: 
   f_range
   float[ 2], Optional frequency range for integration, kHz
   (default: 3-16.5 kHz).

   store
   if set, store integrated spectral density as a TPLOT quantity.
   if set to a string, use that string as the name of the TPLOT quantity.

   mag
   if set, compute integrated spectral density of the magnetic field
   using Mag3ac data.

 CALLING SEQUENCE: FF_DSP_POWER

 OUTPUT: Stored in tplot (default names: DSP_POWER and DSP_MAG_POWER).

 NOTES
  Integrated spectral density of the electric field is stored in (V/m)^2.
  Integrated spectral density of the magnetic field is converted 
  to energy density (joule/m^3 = B^2/(2*mu_0)) before storage.

 INITIAL VERSION: REE 99-01-13
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_dsp_power.pro">general/missions/fast/fa_ops/ff_dsp_power.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_FIXTIME">
<H2>FF_FIXTIME</H2></A>
<A HREF="#FF_DSP_POWER">[Previous Routine]</A>
<A HREF="#FF_INFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_FIXTIME, time, kept=kept, fix=fix

 PURPOSE: Identifies stretches of data that are time reversed. Throws 
          away the fewest number of points. Used a C-call. 

 INPUT:   
	time   - Time array.

 KEYWORDS: 
	kept   - Where the good points are.
	fix    - Fixes the time array for you. DEFAULT = 1

 CALLING: fix_time, time              

 OUTPUT: None.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_fixtime.pro">general/missions/fast/fa_ops/ff_fixtime.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_INFO">
<H2>FF_INFO</H2></A>
<A HREF="#FF_FIXTIME">[Previous Routine]</A>
<A HREF="#FF_INTERP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_INFO, dqd, talk=talk, pot=pot, notch=notch

 PURPOSE: A utility routine which gives default values for FAST FIELDS. 
          Examples: potential, notching. USER HOSTILE.

 INPUT: 
       dqd -         USUALLY REQUIRED. A string that starts with:
                     'V5-V8', 'V1-V2', 'V1-V4', 'V5-V6','V7-V8', or 'V1-V58'

 KEYWORDS: 
       talk -        Messages and descriptions appear on the screen. 
       pot -         Returns information for forming potentials from 
                     fields data.

 CALLING: ff_notch(/pot)

 OUTPUT: A structure that depends on the specific information requested.

 INITIAL VERSION: REE 97-04-01
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_info.pro">general/missions/fast/fa_ops/ff_info.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_INTERP">
<H2>FF_INTERP</H2></A>
<A HREF="#FF_INFO">[Previous Routine]</A>
<A HREF="#FF_MAGFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_INTERP, time1, time2, data2, delt_t=delt_t, spline=spline, 
                      nearest=nearest, ptr=ptr

 PURPOSE: A utility routine which that interpolates through notched 
          dc fields data. Called by ff_notch. User hostile.

 INPUT: 
       time1 -       REQUIRED. Double array of time to interpolate to.
       time2 -       REQUIRED. Double array of time must match data2.
       data2 -       REQUIRED. Data will be expanded or reduced to meet time1
                     may be double, float, long, int, or byte array
 any of inputs time1, time2 or data2 may be pointers.

  NOTE: the values of TIME2 must all be finite, i.e. no NaN's!!! 

 KEYWORDS: 
       delt_t -      Largest delta t interpret across. DEFAULT = 1.0d
       spline -      Use cubic spline interpolation instead of linear.
       nearest -     Choose nearest point in time2 for each point in time1.
	ptr -	      Return a pointer to an array of same type as data2.
                     DEFAULT = ptr is time1 is ptr, otherwise not prt.

 CALLING: data1 = ff_interp(time1, time2, data2)

 OUTPUT: data1 is superset of data2, interpolated from time2 to time1.
         If data2 is a pointer, then data1 will be a pointer.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: KRB 97-06-17. add cubic spline interpolation.
 			REE 97-11-17. Change ptr call.
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_interp.pro">general/missions/fast/fa_ops/ff_interp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAGFIT">
<H2>FF_MAGFIT</H2></A>
<A HREF="#FF_INTERP">[Previous Routine]</A>
<A HREF="#FF_MAGFIT_SM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_MAGFIT, mag, out=out, talk=talk, max_err=max_err, plot=plot
       
 PURPOSE: Wrapper between ff_magdc to ff_qfit. 
          NOT FOR GENERAL USE! 
          IDL 5 OR HIGHER - USES POINTERS! 

 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure. MAY HAVE POINTERS!


 KEYWORDS: 
       out -         OPTIONAL. Will locate bad points in mag.notch.
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plots results.
       max_err -     OPTIONAL. Maximun allowable error. DFLT = 25 nT

 CALLING: 
       fit = ff_magfit(mag)

 OUTPUT: fit.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_magfit.pro">general/missions/fast/fa_ops/ff_magfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAGFIT_SM">
<H2>FF_MAGFIT_SM</H2></A>
<A HREF="#FF_MAGFIT">[Previous Routine]</A>
<A HREF="#FF_MAGFIX">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_MAGFIT_SM, mag, fit, n_sm=n_sm, max_sig=max_sig, talk=talk
       
 PURPOSE: Routine calculates a dynamic tweak matrix
          IDL VER 5 AND GREATER!
          NOT FOR GENERAL USE!

 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure.
      	fit -	      REQUIRED. Fits from ff_magfit.


 KEYWORDS: 
      	max_sig -     OPTIONAL. Maximum allowed sigma in fit. DFLT=10 nT.
      	n_sm -        OPTIONAL. Smooting cof.
       talk -        OPTIONAL. Give informational message.

 CALLING: 
       fit_sm = ff_magfit_sm(mag, fit)

 OUTPUT: sm_fit.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_magfit_sm.pro">general/missions/fast/fa_ops/ff_magfit_sm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAGFIX">
<H2>FF_MAGFIX</H2></A>
<A HREF="#FF_MAGFIT_SM">[Previous Routine]</A>
<A HREF="#FF_MAG_BUFS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAGFIX, mag, Bphase, filt=filt, freq=freq, max_chi = max_chi
       
 PURPOSE: Performs a crude fix to the mag data. Essentially filters
          spiky noise and trows away spin tone on Z component.
          Before calling this routine: 
          (1) Get 'MagDC'.

 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure.
       phs -         OPTIONAL. Bphase interpolated to MagDC.


 KEYWORDS: 
       filt   -      Filter cof for tweak values. DEFAULT = 0.1
       freq   -      Percent Nyquist to filter data.
       max_chi -     Maximum reduced chi-square of fit yielding usable tweak
                     values.  DEFAULT = 1.0

 CALLING: 
       ff_magfix,mag

 OUTPUT: mag.comp3 altered.

 INITIAL VERSION: REE 97-04-10
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_magfix.pro">general/missions/fast/fa_ops/ff_magfix.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_BUFS">
<H2>FF_MAG_BUFS</H2></A>
<A HREF="#FF_MAGFIX">[Previous Routine]</A>
<A HREF="#FF_MAG_EXTEND">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_BUFS, mag, n, delta_t=delta_t, fit=fit, 
                           buf_starts=buf_starts, buf_ends=buf_ends

 PURPOSE: Shows stretches of data with n or more points in a 
          row with no change in dt. 
          ALSO LOCATES TORQUE AND /SUN SHADOW BOUNDARIES
          MAG MUST HAVE 'SUN' AND 'TORQUE' ELEMENTS!
          NOT FOR GENERAL USE.

 INPUT:   
	mag  -     Fast fields data structure or data.
	     -     Or the time array
       n    -     OPTIONAL: Minimum number of points to make a buffer.
	     -     Default = 1024.

 KEYWORDS: 
	delta_t    - Allowable error in time steps. Default = 1.0e-6 s.
	buf_starts - OUTPUT. A list of starting indecies of good streaks.
	buf_ends   - OUTPUT. A list of ending indecies of good streaks.
	fit        - OPTIONAL. IF included, fit.buf will be updated.

 CALLING: fa_fields_bufs,dat               ; Survey data.

 OUTPUT: 
	buf_starts - A list of starting indecies of good streaks.
	buf_ends   - A list of ending indecies of good streaks.

 SEE: fa_fields_filter, etc.

 INITIAL VERSION: REE 97-03-17
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_bufs.pro">general/missions/fast/fa_ops/ff_mag_bufs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_EXTEND">
<H2>FF_MAG_EXTEND</H2></A>
<A HREF="#FF_MAG_BUFS">[Previous Routine]</A>
<A HREF="#FF_MAG_REJECT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_EXTEND, data, time, n_fit, t_strt=t_strt, t_stop=t_stop
       
 PURPOSE: Extends data to t_strt and t_stop with ladfit.
          NOT GENERAL PURPOSE.

 INPUT: 
       data -        REQUIRED. Data to be extended.
       time -        REQUIRED. Time corrsonding to data.
       n_fit -       OPTIONAL. Number of points to fit. DEFAULT = 9. 

 KEYWORDS: 
       t_strt -      OPTIONAL. Early time to extend to.
       t_stop -      OPTIONAL. Late time to extend to.

 CALLING: 
      ff_mag_extend, data, time, n_fit, t_strt=t_strt, t_stop=t_stop

 OUTPUT: Adds points to data.

 INITIAL VERSION: REE 97-10-20 
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_extend.pro">general/missions/fast/fa_ops/ff_mag_extend.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_REJECT">
<H2>FF_MAG_REJECT</H2></A>
<A HREF="#FF_MAG_EXTEND">[Previous Routine]</A>
<A HREF="#FF_MAG_SPEED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_REJECT, mag, fit
       
 PURPOSE: REJECTS BAD MAG DATA. 
          IDL 5 OR HIGHER - USES POINTERS! 

 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure. MAY HAVE POINTERS!
       fit -         REQUIRED. Fit to mag data. See ff_magfit.


 KEYWORDS: 
       max_err -     OPTIONAL. Maximun allowable error. DFLT = 100 nT
       ave_per -     OPTIONAL. S/C period.              DFLT = 5.0 s
       nper_trq -    OPTIONAL. Throw out points within nper_trq
                     spin periods of a torque boundary. DFLT = 1.5
       npts_speed_af OPTIONAL. Throw out npts_speed_after
                     a speed change boundary. DFLT = 40
       npts_speed_be OPTIONAL. Throw out npts_speed_before
                     a speed change boundary. DFLT = 5
       npts_per_spin-OPTIONAL. Too tricky to describe.  DFLT = 16
       n_sm -        OPTIONAL. N_points to smooth fits. DFLT = 21
       max_sig -     OPTIONAL. Max error in fit.        DFLT = 10 nT
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plot results.

 CALLING: 
       ff_mag_reject, mag, fit

 OUTPUT: Adds notch, notch3, and bphase to mag.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_reject.pro">general/missions/fast/fa_ops/ff_mag_reject.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_SPEED">
<H2>FF_MAG_SPEED</H2></A>
<A HREF="#FF_MAG_REJECT">[Previous Routine]</A>
<A HREF="#FF_MAG_SUN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_SPEED, mag, fit=fit, ptr=ptr, min_streak=min_streak,
                           plot=plot
       
 PURPOSE: Routine determines sample speed in log2(smaples/s).
          NOT FOR GENERAL USE! ACCEPTS PTR STRUCTURE.


 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure. MAY HAVE POINTERS!

 KEYWORDS: 
      	fit -	      OPTIONAL. Fits from ff_magfit.
      	ptr -	      OPTIONAL. DEFAULT = SAME. Adds a pointer to mag.
      	min_streak -  OPTIONAL. DEFAULT = 40. Miniumun stretch of good
                     data points in a valid buffer.
      	plot -	      OPTIONAL. Plots the results.

 CALLING: 
      ff_mag_speed, mag, fit=fit.

 OUTPUT: Adds structure elememt 'speed' to mag and fit.

 INITIAL VERSION: REE 97-10-20 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_speed.pro">general/missions/fast/fa_ops/ff_mag_speed.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_SUN">
<H2>FF_MAG_SUN</H2></A>
<A HREF="#FF_MAG_SPEED">[Previous Routine]</A>
<A HREF="#FF_MAG_TORQUE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_SUN, mag, fit=fit, talk=talk, plot=plot 
       
 PURPOSE: Routine determines where torque on/off is.
          NOT FOR GENERAL USE! ACCEPTS PTR STRUCTURE.

 INPUT: 
      	mag -	      REQUIRED. DC mag data.


 KEYWORDS: 
      	fit -	      OPTIONAL. Fits from ff_magfit.
       talk -        OPTIONAL. Give informational message.

 CALLING: 
      ff_mag_sun, mag, fit=fit.

 OUTPUT: Adds structure elememt 'sun' to mag and fit.

 INITIAL VERSION: REE 97-10-20 - see ff_magdc
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_sun.pro">general/missions/fast/fa_ops/ff_mag_sun.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_TORQUE">
<H2>FF_MAG_TORQUE</H2></A>
<A HREF="#FF_MAG_SUN">[Previous Routine]</A>
<A HREF="#FF_MAG_TWC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_TORQUE, mag, fit, max_sig=max_sig, max_x0=max_x0, 
                            add_sig=add_sig, talk=talk, plot=plot
       
 PURPOSE: Routine determines where torque on/off is.
          NOT FOR GENERAL USE!
          IDL 5 OR HIGHER - USES POINTERS! 

 INPUT: 
      	fit -	      REQUIRED. Fits from ff_magfit.
      	mag -	      OPTIONAL. ENTER 0 IF YOU NOT WANT MAG ALTERED!


 KEYWORDS: 
      	max_sig -     OPTIONAL. Maximum allowed sigma in fit. DFLT=10 nT.
      	max_x0 -      OPTIONAL. Maximum allowed x0. DFLT=40 nT.
                     Used to determine where torquers are on.
      	add_sig -     OPTIONAL. Add where 'good' to fit.
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plot the torquer results.

 CALLING: 
      ff_mag_torque, 0, fit, /add_sig - Adds torque and sigma to fit.

 OUTPUT: Adds structure elememt 'torque' and 'good'.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see ff_magdc
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_torque.pro">general/missions/fast/fa_ops/ff_mag_torque.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_TWC">
<H2>FF_MAG_TWC</H2></A>
<A HREF="#FF_MAG_TORQUE">[Previous Routine]</A>
<A HREF="#FF_MAG_TWD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_MAG_TWC, fit, talk=talk 
       
 PURPOSE: Routine calculates a static tweak matrix.
          IDL VER 5 AND GREATER!
          NOT FOR GENERAL USE!

 INPUT: 
      	fit -	      REQUIRED. Fits from ff_magfit.


 KEYWORDS: 
       talk -        OPTIONAL. Give informational message.

 CALLING: 
       twc = ff_mag_twc(fit)

 OUTPUT: twc.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see ff_magdc
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_twc.pro">general/missions/fast/fa_ops/ff_mag_twc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_TWD">
<H2>FF_MAG_TWD</H2></A>
<A HREF="#FF_MAG_TWC">[Previous Routine]</A>
<A HREF="#FF_MAG_TWKDAT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_MAG_TWD, mag, fit, n_sm=n_sm,max_sig=max_sig,talk=talk,plot=plot 
       
 PURPOSE: Routine calculates a dynamic tweak matrix
          IDL VER 5 AND GREATER!
          NOT FOR GENERAL USE!

 INPUT: 
       mag -         REQUIRED. 'MagDC' data structure.
      	fit -	      REQUIRED. Fits from ff_magfit.


 KEYWORDS: 
      	max_sig -     OPTIONAL. Maximum allowed sigma in fit. DFLT=10 nT.
      	n_sm -        OPTIONAL. Smooting cof.
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plots Results.

 CALLING: 
       twd = ff_mag_twd(mag, fit)

 OUTPUT: pfit.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see UCLA_MAG_DESPIN, FF_XYMAGFIX
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_twd.pro">general/missions/fast/fa_ops/ff_mag_twd.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_TWKDAT">
<H2>FF_MAG_TWKDAT</H2></A>
<A HREF="#FF_MAG_TWD">[Previous Routine]</A>
<A HREF="#FF_MAG_TWKFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEEDURE: FF_MAG_TWKDAT, mag, tw, talk=talk, plot=plot
       
 PURPOSE: Applies the tweak matrix to the magnetic field data.
          NOT FOR GENERAL USE! IDL &gt;=5.0 COMPATABLE. ALLOWS POINTERS.

 INPUT: 
      	mag -	      REQUIRED. Data structure.
      	tw -	      REQUIRED. Static or dynamic tweak matrix.


 KEYWORDS: 
       talk -        OPTIONAL. Give informational message.
       plot -        OPTIONAL. Plots results.

 CALLING: 
       ff_mag_twkdat,mag,twc

 OUTPUT: fit.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see ff_magdc
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_twkdat.pro">general/missions/fast/fa_ops/ff_mag_twkdat.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_MAG_TWKFIT">
<H2>FF_MAG_TWKFIT</H2></A>
<A HREF="#FF_MAG_TWKDAT">[Previous Routine]</A>
<A HREF="#FF_NOTCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_MAG_TWKFIT, fit, twc 
       
 PURPOSE: Routine calculates a constant tweak matrix for the orbit.
          NOT FOR GENERAL USE!

 INPUT: 
      	fit -	      REQUIRED. Fits from ff_magfit.
      	twc -	      REQUIRED. Static tweak matrix.


 KEYWORDS: 

 CALLING: 
       fit = ff_mag_twkfit(fit,twc)

 OUTPUT: fit.

 INITIAL VERSION: REE/RJS/KRB 97-10-20 - see ff_magdc
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_mag_twkfit.pro">general/missions/fast/fa_ops/ff_mag_twkfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_NOTCH">
<H2>FF_NOTCH</H2></A>
<A HREF="#FF_MAG_TWKFIT">[Previous Routine]</A>
<A HREF="#FF_PDQFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_NOTCH, dqd, data, Bphase=Bphase, Binterp=Binterp, Bnan=Bnan,
                                  Sphase=Sphase, Sinterp=Sinterp, Snan=Snan

 PURPOSE: A utility routine which that notches dc fields data on
          magphase or sunphase.

 INPUT: 
       dqd -         REQUIRED. A string that starts with:
                     'V5-V8', 'V1-V2', 'V1-V4', 'V5-V6','V7-V8', or 'V1-V58'
       data -        OPTIONAL. An byte, int, long, float, or double arrray.

 KEYWORDS: 
       Bphase        Magnetic field phase. One of Bphase or Sphase 
                     is REQUIRED. This array
                     must have the same number of points as data.
                     See fa_fields_combine to form data.
       Binterp -     If set, interpolates mag notched data.     DEFAULT = 0
       Bnan -        If set, mag notched data is set to fnan.   DEFAULT = 0
       Sphase        Sun spin phase. One of Bphase or Sphase 
                     is REQUIRED. This array
                     must have the same number of points as data.
                     See fa_fields_combine to form data.
       Sinterp -     If set, interpolates sun notched data.     DEFAULT = 0
       Bnan -        If set, sun notched data is set to fnan.   DEFAULT = 0
       Bnotch -      The byte flag value for Bnotch, zero value means
                     'notch' and data has been altered
       Snotch -      The byte flag value for shadow notch, zero value means
                     'notch' and data has been altered
 CALLING: ff_notch(comp1, 'V5-V8', Bphase=Bphase, /Bint)

 OUTPUT: A byte array of the notched data. If Data is changed in place.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 97-04-03. Ne added by REE.
 Space Scienes Lab, UCBerkeley
 2024-05-21, Added separate bnotch and snotch outputs, jmm, jimm@ssl.berkeley.edu
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_notch.pro">general/missions/fast/fa_ops/ff_notch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_PDQFIT">
<H2>FF_PDQFIT</H2></A>
<A HREF="#FF_NOTCH">[Previous Routine]</A>
<A HREF="#FF_PHASE_ZC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_PDQFIT, dat, phs, coeff, phsf, m=m, funct=funct
                         period=period, slide=slide,
                         n_fitpts=n_fitpts, out=out
       
 PURPOSE: Performs a crude, but very fast spin fit to the data.
          Before calling this routine: 
          (1) Notch the data with Bphase and/or Sphase.
          (2) Recommend filtering the data to 5 Hz at 2-poles.

 INPUT: 
       dat -         REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
                     RECOMMEND: dat_in does not have NANS. One nan
                                may destroy entire period.
       phs -         REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
                     IMPORTANT! PHS CANNOT HAVE NAN'S!

 OUTPUT: 
	coeff  -        fltarr(N, M) for the N spin fits.
       phsf   -        fltarr(N) Phase of fit.
       See Also: KEYWORDS.

 KEYWORDS: 
	M -	      INPUT. number of basis functions.  DEFAULT = 4
	Funct -	      INPUT. Function which given array of phase returns vectors
                     corresponding to the basis functions evaluated at each
                     input phase.  Must accept input values of X (an array
                     of phases) and M (the number of basis functions)
                     and output an (nelements(X), M) element
		      matrix containing the basis functions.  
		      for M = 4, DEFAULT = ONE_PHI_COS_SIN
		      for M = 6, DEFAULT = ONE_PHI_COS_SIN_PHICOS_PHISIN
       period -      INPUT. Fit period. DEFAULT = 2pi
       slide -       INPUT. Number of periods to slide. DEFAULT = 0.5.
                     NOTE: Slide will be forced to be interger # of fit pnts.
       n_fitpts -    INPUT. Number of points per fit. DEFAULT = 64.
       out -         INPUT. outlier rejection mode. reject points with
                     deviation greater than 1.2 + i*0.4 and iterate.
                     NOT IMPLEMENTED YET
       sigma -       OUTPUT. the sigma for each fit.


 CALLING: 
       index = where(finite(your_data) AND finite(your_phase), n_finite)
       IF (nfinite GT 0) then BEGIN
           dat = your_data(index)
           phs = your_phase(index)
           ff_pdqfit,dat,phs,es=es, ec=ec, phsf=phsf, zero=zero
       ENDIF

 ALTERNATIVE CALL: ff_pdqfit, dat, time, period = 5.0d, $
                               es=es, ec=ec, phsf=phsf, zero=zero


 INITIAL VERSION: KRB 07-01-97
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_pdqfit.pro">general/missions/fast/fa_ops/ff_pdqfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_PHASE_ZC">
<H2>FF_PHASE_ZC</H2></A>
<A HREF="#FF_PDQFIT">[Previous Routine]</A>
<A HREF="#FF_POTENTIAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_PHASE_ZC, time_, data_, smooth=smooth, period=period, 
                        tzero=tzero
       
 PURPOSE: Calculates the phase from zero crossings. IMPUT ARRAY MUST HAVE
          CONSTANT DT! SEE FA_FIELDS_BUFS.

 INPUT: 
       time_ -       REQIRED. Double array. NOTE: subtract time(0)
                     to avoid large errors!
       data_ -       REQIRED. Must be nearly sinusoidal at spin_per.


 KEYWORDS: 
       freq -        Smoothing frequency in Hertz. DEFAULT = 0.8 Slow Survey
                     and 10.0 in Fast Survey. Optimized by REE.
       period -      Seed value. Precise value output. Default = 5.0 seconds.

 CALLING: 
       phase = ff_phase_zc(time,data)

 OUTPUT: Array of times. Period will be updated.
       tzero -       Array of times.

 INITIAL VERSION: REE/RJS 97-10-02 - see FF_MAGDC.PRO
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_phase_zc.pro">general/missions/fast/fa_ops/ff_phase_zc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_POTENTIAL">
<H2>FF_POTENTIAL</H2></A>
<A HREF="#FF_PHASE_ZC">[Previous Routine]</A>
<A HREF="#FF_PTR_TO_DAT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_POTENTIAL, V58, V8, V14, V4, save_mem=save_mem
       

 PURPOSE: 
 Estimate spacecraft floating potential using spin plane
 spin plane electric field data and potential differences.

 INPUT: 
       V58 -         If blank, program will get V5-V8_S /all,/rep. 
                     To run this program on burst data, use 
                     V58=get_fa_fields('V5-V8_4k',/all).
       V8 -          If blank, program will get V8_S /all,/rep. User can
                     supply structure if wanted. 
       V14 -         If blank, program will get V1-V4_S, /all,/rep. 
                     To run this program on burst data, use 
                     V58=get_fa_fields('V1-V4_4k',/all).
       V4 -          If blank, program will get V4_S /all, /rep. User can
                     supply structure if wanted. 

 KEYWORDS: 
       save_mem      CAREFUL! If set, this will blow away V58, V14, V8,
                     and V4 after they are no longer needed. 

 CALLING: pot = fa_potential()
       That's easy! Now you the S/C potential.

 IMPORTANT! SDT SETUP: Need to have: V5-V8_S, V1-V4_S, V4_S, and V8_S. 

 OUTPUT: pot is IDL fields time series data structure with one
         component. 

 SIDE EFFECTS: As with all fields pro's this pro need lots of memory.

 INITIAL VERSION: REE 97-03-25
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_potential.pro">general/missions/fast/fa_ops/ff_potential.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_PTR_TO_DAT">
<H2>FF_PTR_TO_DAT</H2></A>
<A HREF="#FF_POTENTIAL">[Previous Routine]</A>
<A HREF="#FF_QFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PRO: FF_PTR_TO_DAT, dat, tags=tags

 PURPOSE: Converts all pointer 'tags' to data arrays.

 CALLING: ff_ptr_to_dat,dat
 	   Pretty simple! 

 INPUTS: A valid data structure.
       
 KEYWORD PARAMETERS: 
 tags
 string[ N], if given, only the given tags are converted.

 OUTPUTS: Alters dat.

 INITIAL VERSION: REE 97_10_20
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_ptr_to_dat.pro">general/missions/fast/fa_ops/ff_ptr_to_dat.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_QFIT">
<H2>FF_QFIT</H2></A>
<A HREF="#FF_PTR_TO_DAT">[Previous Routine]</A>
<A HREF="#FF_QUICKFIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_QFIT,  data, phs, phsf=phsf, es=es, ec=ec, zero=zero,
                  do_sigma=do_sigma, sigma=sigma,
                  period=period, slide=slide, n_fitpts=n_fitpts, 
                  out=out, max_err=max_err, bad_pts=bad_pts                 
       
 PURPOSE: User unfriendly fit routine. Called by ff_magdc.
          NOTE: REQUIRES CONTINUOUS BUFFERS!
          NOT FOR GENERAL USE. 

 INPUT: 
       data -        REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
                     RECOMMEND: dat_in does not have NANS. One nan
                                may destroy entire period.
       phs -         REQUIRED. An array of phases.
                     IMPORTANT! All phases must be valid! No NANs!

 KEYWORDS: 
       period   -    INPUT. Fit period. DEFAULT = 4pi
       slide    -    NO LONGER AN OPTION!
                     NOTE: Slide will be forced to be pi/2.
       n_fitpts -    INPUT. Number of points per fit. DEFAULT = 64.
       do_sigma -    OPTION. /do_sigma fills sigma.
       out      -    OPTION. /out fills bad_pts.
                     NOTE: FOR OUTLYER REJECTION, SEE BELOW!
       max_err  -    INPUT. Maximum allowable error of bad_pts. 
       		DEFAULT=25 nT

 OUTPUT: 
       phsf    -     OUTPUT. Phase of fit -&gt; Time of fit.
       es      -     OUTPUT. Sin phase of fit.
       es      -     OUTPUT. Cos phase of fit.
       zero    -     OUTPUT. Zero level of fit.
       sigma   -     OUTPUT. Deviation in nT. Only filled if /do_sigma
       bad_pts -     OUTPUT. Deviation in nT. Only filled if /out

 CALLING: 
       SEE ff_magdc for an example. MUST USE fa_fields_bufs, and 
       ff_zero_crossing first.

 OUT-LYING POINTS REJECTION: 
       The program must be iterated.
	For example, below shows one interation:

       ff_qfit,data,phs,phsf=phsf,$
		es=es,ec=ec,zero=zero,/out, bad_pts=bad_pts
       data(bad_pts) = !values.f_nan
       index = where(finite(data), n_index)
       IF n_index GT 0 then BEGIN
           data = data(index)
           phs  = phs(index)
           ff_qfit,data,phs,phsf=phsf,es=es,ec=ec,zero=zero
       ENDIF ELSE print, &quot;Big trouble! No valid points.&quot;

 INITIAL VERSION: REE 97-10-05
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_qfit.pro">general/missions/fast/fa_ops/ff_qfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_QUICKFIT">
<H2>FF_QUICKFIT</H2></A>
<A HREF="#FF_QFIT">[Previous Routine]</A>
<A HREF="#FF_REDUCE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_QUICKFIT, dat, phs, es=es, ec=ec, phsf=phsf, zero=zero,
                         period=period, n_fitpts=n_fitpts 
       
 PURPOSE: Performs a crude, but very fast spin fit to the data.
          Before calling this routine: 
          (1) Notch the data with Bphase and/or Sphase.
          (2) Reccommend filtering the data to 5 Hz at 2-poles.

 INPUT: 
       dat -         REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
                     RECOMMEND: dat_in does not have NANS. One nan
                                may destroy entire period.
       phs -         REQUIRED. A DATA ARRAY -  NOT A STRUCTURE!
                     IMPORTANT! PHS CANNOT HAVE NAN'S!


 KEYWORDS: 
       es   -        OUTPUT. Sin phase of fit.
       es   -        OUTPUT. Cos phase of fit.
       tf   -        OUTPUT. Time of fit.
       zero -        OUTPUT. Zero level of fit.
       period -      INPUT. Fit period. DEFAULT = 2pi
       slide -       INPUT. Number of periods to slide. DEFAULT = 0.5.
                     NOTE: Slide will be forced to be integer # of fit pnts.
       n_fitpts -    INPUT. Number of points per fit. DEFAULT = 64.

 CALLING: 
       index = where(finite(your_data) AND finite(your_phase), n_finite)
       IF (nfinite GT 0) then BEGIN
           dat = your_data(index)
           phs = your_phase(index)
           ff_quickfit,dat,phs,es=es, ec=ec, phsf=phsf, zero=zero
       ENDIF

 ALTERNATE CALL: ff_quickfit, dat, time, period = 5.0d, $
                               es=es, ec=ec, phsf=phsf, zero=zero

 OUTPUT: See KEYWORDS.

 INITIAL VERSION: REE 97-03-29
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_quickfit.pro">general/missions/fast/fa_ops/ff_quickfit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_REDUCE">
<H2>FF_REDUCE</H2></A>
<A HREF="#FF_QUICKFIT">[Previous Routine]</A>
<A HREF="#FF_SHIFT_POLE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_REDUCE, dat, t1, t2, tags=tags

 PURPOSE: Reduces data to time interval supplied. POINTER FRIENDLY!

 CALLING: ff_reduce,dat,t1,t2

 INPUTS: dat 		FAST time series structure with one to four comps.
 	 		All time series data are OK. 
 	  t1	 	Start time.
 	  t2	 	End time.
       
 KEYWORD PARAMETERS:  	
 	  tags	 	If given, the tag names to be reduced.

 OUTPUTS: Will alter structure.

 SIDE EFFECTS: May blow memory.

 INITIAL VERSION: REE 97-12-22
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_reduce.pro">general/missions/fast/fa_ops/ff_reduce.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_SHIFT_POLE">
<H2>FF_SHIFT_POLE</H2></A>
<A HREF="#FF_REDUCE">[Previous Routine]</A>
<A HREF="#FF_SMOOTH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_SHIFT_POLE, data, new_pole, sample_time, oldpole=oldpole

 PURPOSE: A utility routine which integrates the one-pole high-pass
          on HSBM or HG fields data to a new pole value. NOT GENERAL - 
          USER HOSTILE.

 INPUT: 
       data -        REQUIRED. Data to be shifted.
       sample_time - REQUIRED. Sample time.
       new_pole -    REQUIRED. New high-pass pole in Hz.

 KEYWORDS: 
       old_pole -    Unless you know what you're doing, do not
                     change. DEFAULT = 3386.275d (HG high-pass pole, Hz).

 CALLING: data = ff_shift_pole(data, new_pole, sample_time)

 OUTPUT: data is integrated and refiltered.

 INITIAL VERSION: REE 97-06-12
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_shift_pole.pro">general/missions/fast/fa_ops/ff_shift_pole.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_SMOOTH">
<H2>FF_SMOOTH</H2></A>
<A HREF="#FF_SHIFT_POLE">[Previous Routine]</A>
<A HREF="#FF_YLIM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: FF_SMOOTH, data, n_sm, w=w, detrend=detrend, sm_funct=sm_funct
       
 PURPOSE: Smoothing routine which treats edges and allows
          specification of weighting fuction.

 INPUT: 
       data -        REQUIRED. Data to be smoothed. Must be evenly spaced.
                     
       n_sm -        REQUIRED. Number of pts in Gauss 3 sigma width. 
                     MUST BE ODD!

 KEYWORDS: 
       w -           OPTIONAL. Weighting function.
       detrend -     OPTIONAL. Detrends data before smoothing.
       sm_funct -    OPTIONAL. A smoothing function of n_sm length.

 CALLING: 
      result = ff_smooth, data, n_sm, w=w 

 OUTPUT: array of smoothed data.

 INITIAL VERSION: REE 97-10-20 
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/ff_smooth.pro">general/missions/fast/fa_ops/ff_smooth.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FF_YLIM">
<H2>FF_YLIM</H2></A>
<A HREF="#FF_SMOOTH">[Previous Routine]</A>
<A HREF="#FILES_EXIST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: FF_YLIM, pname, ylim, log=log, vals=vals, clear=clear, dsp=dsp


 PURPOSE: A utility to set up y-ticks and lables for fields plots.
          ONLY WORKS FOR INTEGER RANGES! IF YOU DON'T LIKE WHAT YOU GET,
          DO IT YOURSELF (6 commands).
 INPUT:
       pname -       REQUIRED. A tplot name.
       ylim -        REQUIRED. A vector yrange.

 KEYWORDS:
       log -         If set, yrange is log otherwise linear.
       vals -        If given, they are the values!
       dsp -         If set, a special set of lables comes up.

 CALLING: ff_ylim,'SFA_OMNI',[0,600]

 OUTPUT: Stored in tplot.

 INITIAL VERSION: REE 97-11-18
 MODIFICATION HISTORY:
 Space Sciences Lab, UCBerkeley

</PRE><P>
<STRONG>(See <A href="fa_ops/ff_ylim.pro">general/missions/fast/fa_ops/ff_ylim.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FILES_EXIST">
<H2>FILES_EXIST</H2></A>
<A HREF="#FF_YLIM">[Previous Routine]</A>
<A HREF="#FILL_FA_ESA_FROM_TS_GET">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: files_exist, file_spec_list

 PURPOSE:
     returns array of strings corresponding to input array of file specs

 INPUTS:
     file_spec_list:
         either a single file spec, or an array of file specs, where by file spec
         is meant the file specification required by the findfile program.

 OUTPUTS:
     return value:
         empty string if there are no files, else an array of strings naming
         the files that exist.
       
 CREATED BY: Vince Saba

 VERSION: @(#)files_exist.pro	1.2 10/23/98
</PRE><P>
<STRONG>(See <A href="fa_ops/files_exist.pro">general/missions/fast/fa_ops/files_exist.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FILL_FA_ESA_FROM_TS_GET">
<H2>FILL_FA_ESA_FROM_TS_GET</H2></A>
<A HREF="#FILES_EXIST">[Previous Routine]</A>
<A HREF="#FIND_LAST_EPOCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 FILL_FA_ESA_FROM_TS_GET

 DESCRIPTION:

	Function to take a structure from get_md_ts_from_sdt that
	contains Fast esa data, and return a array of structures in the
	standard ssl idl esa format.


	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'data-name'         ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = fill_fa_esa_from_ts_get (dat, units, header_bytes,   
                                            got_header_bytes, CALIBRATE=calib)

 ARGUMENTS:

	dat			The data structure returned from
				get_md_ts_from_sdt for esa data

	units			The units of the data

	header_bytes		The header bytes from the header
				packets for the data in dat

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)fill_fa_esa_from_ts_get.pro	1.4 02/10/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/fill_fa_esa_from_ts_get.pro">general/missions/fast/fa_ops/fill_fa_esa_from_ts_get.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FIND_LAST_EPOCH">
<H2>FIND_LAST_EPOCH</H2></A>
<A HREF="#FILL_FA_ESA_FROM_TS_GET">[Previous Routine]</A>
<A HREF="#FRAC_INDICES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:    find_last_epoch

 PURPOSE:     Gets the last orbit element epoch time entry of an orbit
              file.  Returns time in double float.  (All arguments
              and keywords are optional.)

 ARGUMENTS:   FILE         The orbit file to look in.  Defaults to:
                           fa_almanac_dir()/orbit/predicted
                           unless DEFINITIVE keyword set.
              ORBIT        Named variable to return last orbit in file.
              YEAR         Named variable to return year.
              DOY          Named variable to return day of year.
              TIME         Named variable to return time of day.

 KEYWORDS:    DEFINITIVE   If no FILE argument supplied, use the
                           definitive orbit file:
                           fa_almanac_dir()/orbit/definitive

         
</PRE><P>
<STRONG>(See <A href="fa_ops/find_last_epoch.pro">general/missions/fast/fa_ops/find_last_epoch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="FRAC_INDICES">
<H2>FRAC_INDICES</H2></A>
<A HREF="#FIND_LAST_EPOCH">[Previous Routine]</A>
<A HREF="#GCLOSE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: FRAC_INDICES

 PURPOSE: to obtain the fractional indices of one array relative to
          another. This function would usually precede a call to
          IDL's INTERPOLATE. 

 CALLING SEQUENCE: new_indices = frac_indices(my_times, data_times)
 
 INPUTS: MY_TIMES: an array of values for which the fractional
         indices, with respect to DATA_TIMES, will be returned. 
	
 OUTPUTS: The fractional indices! For example, note that
          print,frac_indices([5,15],[0,10,30]), produces the output
               0.50000000      1.2500000, and that in general the
               function call:
                  interpolate(x,frac_indices(y,x))  reproduces y. 

 RESTRICTIONS: Inputs must be one-dimensional arrays of a type that
               can be sorted monotonically, i.e. no complex. 

 MODIFICATION HISTORY: Written 1 August 1996 by Bill Peria UCBerkeley
                       Space Sciences Laboratory. 

</PRE><P>
<STRONG>(See <A href="fa_ops/frac_indices.pro">general/missions/fast/fa_ops/frac_indices.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GCLOSE">
<H2>GCLOSE</H2></A>
<A HREF="#FRAC_INDICES">[Previous Routine]</A>
<A HREF="#GEN_FA_K0_EES_GIFPS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:   gclose
INPUT:  none
PURPOSE: Write GIF file named with gopen, and change device back to 
  default.
  If common block string 'printer_name' is set, then file is sent to that
  printer.
SEE ALSO: 	&quot;print_options&quot;
		&quot;gopen&quot;

CREATED BY:	Davin Larson
LAST MODIFICATION:	@(#)gclose.pro	1.5 95/10/06
</PRE><P>
<STRONG>(See <A href="fa_ops/gclose.pro">general/missions/fast/fa_ops/gclose.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GEN_FA_K0_EES_GIFPS">
<H2>GEN_FA_K0_EES_GIFPS</H2></A>
<A HREF="#GCLOSE">[Previous Routine]</A>
<A HREF="#GEN_FA_K0_IES_GIFPS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	gen_fa_k0_ees_gifps.pro
INPUT:	none

PURPOSE:
	Generates gif and ps FAST electron key parameter data.

	Plot 1: Electron Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Electron Differential Energy Flux vs Energy, 60-120  deg pitch angle 
	Plot 3: Electron Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Electron Differential Energy Flux vs Pitch Angle, .1-1 keV  
	Plot 5: Electron Differential Energy Flux vs Pitch Angle, 1-30 keV  
	Plot 6: Electron Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Electron Flux - mapped to 100 km, positive earthward  

KEYWORDS
	bw 		If set, grayscale postscript plots generated
	k0		If set, output files names are 'fa_k0_ees_XXXXX.ext'
				where ext = ps,gif and XXXXX = padded orbit
				files sent to /disks/juneau/www/WWWSUM/yyyy_mm_dd_tttttt/
			If not set, output files names are 'fa_ees_XXXXX.ext'
				files sent to local directory

NOTES:	
	Run load_fa_k0_ees.pro first to get the k0 data

CREATED BY:	J.McFadden		96-9-24
VERSION:	1
LAST MODIFICATION: 97/03/04 
MOD HISTORY:	
		96/10/08	k0 keyword added
		97/03/04	color=4 used for positive (earthward) Je,JEe; color=6 used for negative Je,JEe
				upgrade for Je,JEe definition changes - mapped to 100 km now
</PRE><P>
<STRONG>(See <A href="fa_ops/gen_fa_k0_ees_gifps.pro">general/missions/fast/fa_ops/gen_fa_k0_ees_gifps.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GEN_FA_K0_IES_GIFPS">
<H2>GEN_FA_K0_IES_GIFPS</H2></A>
<A HREF="#GEN_FA_K0_EES_GIFPS">[Previous Routine]</A>
<A HREF="#GEN_FA_K0_TMS_GIFPS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	gen_fa_k0_ies_gifps.pro
INPUT:	none

PURPOSE:
	Generates gif and ps FAST ion key parameter data.

	Plot 1: Ion Differential Energy Flux vs Energy, 0-30    deg pitch angle 
	Plot 2: Ion Differential Energy Flux vs Energy, 40-140  deg pitch angle 
	Plot 3: Ion Differential Energy Flux vs Energy, 150-180 deg pitch angle 
	Plot 4: Ion Differential Energy Flux vs Pitch Angle, .05-1. keV  
	Plot 5: Ion Differential Energy Flux vs Pitch Angle, 1.-25. keV  
	Plot 6: Ion Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Ion Flux - mapped to 100 km, positive earthward  

KEYWORDS
	bw 		If set, grayscale postscript plots generated
	k0		If set, output files names are 'fa_k0_ies_XXXXX.ext'
				where ext = ps,gif and XXXXX = padded orbit
				files sent to /disks/juneau/www/WWWSUM/yyyy_mm_dd_tttttt/
			If not set, output files names are 'fa_ies_XXXXX.ext'
				files sent to local directory

NOTES:	
	Run load_fa_k0_ies.pro first to get the k0 data

CREATED BY:	J.McFadden		96-9-24
VERSION:	1
LAST MODIFICATION:  97/03/04
MOD HISTORY:	
		96/10/08	k0 keyword added
		97/03/04	color=4 used for positive (earthward) Ji,JEi; color=6 used for negative Ji,JEi
				upgrade for Ji,JEi definition changes - mapped to 100 km now
</PRE><P>
<STRONG>(See <A href="fa_ops/gen_fa_k0_ies_gifps.pro">general/missions/fast/fa_ops/gen_fa_k0_ies_gifps.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GEN_FA_K0_TMS_GIFPS">
<H2>GEN_FA_K0_TMS_GIFPS</H2></A>
<A HREF="#GEN_FA_K0_IES_GIFPS">[Previous Routine]</A>
<A HREF="#GEOC2GEOD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	gen_fa_k0_tms_gifps.pro
INPUT:	none

PURPOSE:
	Generates gif and ps FAST TEAMS key parameter data.

	Plot 1: Hydrogen Differential Energy Flux vs Energy, 0-360 deg pitch angle
	Plot 2: Helium   Differential Energy Flux vs Energy, 0-360 deg pitch angle
	Plot 3: Oxygen   Differential Energy Flux vs Energy, 0-360 deg pitch angle
	Plot 4: Hydrogen Differential Energy Flux vs Pitch Angle, &lt; 1 keV
	Plot 5: Hydrogen Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Plot 6: Oxygen   Differential Energy Flux vs Pitch Angle, &lt; 1 keV
	Plot 7: Oxygen   Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Plot 8: MassSpectrum Counts Rate vs Mass, 1eV - 12keV, 4*Pi angles

KEYWORDS
	bw 		If set, grayscale postscript plots generated
	k0		If set, output files names are 'fa_k0_tms_XXXXX.ext'
				where ext = ps,gif and XXXXX = padded orbit
				files sent to /disks/juneau/www/WWWSUM/yyyy_mm_dd_tttttt/
			If not set, output files names are 'fa_tms_XXXXX.ext'
				files sent to local directory

NOTES:
	Run load_fa_k0_tms.pro first to get the k0 data

CREATED BY:	J.McFadden		96-10-6
VERSION:	1.02
LAST MODIFICATION: 97/06/09
MOD HISTORY:
		97/06/09	added He+ panel
		96/10/08	k0 keyword added
</PRE><P>
<STRONG>(See <A href="fa_ops/gen_fa_k0_tms_gifps.pro">general/missions/fast/fa_ops/gen_fa_k0_tms_gifps.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GEOC2GEOD">
<H2>GEOC2GEOD</H2></A>
<A HREF="#GEN_FA_K0_TMS_GIFPS">[Previous Routine]</A>
<A HREF="#GEOMAG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 pro geoc2geod, lat_in, alt_in, lat_out, alt_out, INVERSE = inverse

 converts geocentric latitude and altitude and to geodetic. Latitude must
 be in degrees, altitude in kilometers. The INVERSE keyword goes from
 geodetic to geocentric. 

 You can also specify the GC_RADIUS keyword, which will have the
 geocentric radial distances in km. This method is actually
 preferable , since it avoids assigning a radius for the spherical
 Earth.

 With double precision, roundoff error is less than 1.d-06 km, which
 is more than adequate.  

 Uses geodetic parameters from WGS '84, semi-major axis and inverse of
 flattening :  6378.137 km and 298.257223563, unless one of the other
 ellipsoids is specified through a keyword.

</PRE><P>
<STRONG>(See <A href="fa_ops/geoc2geod.pro">general/missions/fast/fa_ops/geoc2geod.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GEOMAG">
<H2>GEOMAG</H2></A>
<A HREF="#GEOC2GEOD">[Previous Routine]</A>
<A HREF="#GETSPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: geomag(time [, time2])
NAME:
  geomag
PURPOSE:
  Gets geomag data kp, ap, and dsp for given times.

INPUT:  input(s) can be scalers or arrays of any dimension of type:
  double(s)      seconds since 1970
  string(s)      format:  YYYY-MM-DD/hh:mm:ss
  structure(s)   format:  given in &quot;time_struct&quot;
                 values outside normal range will be corrected.

  If optional parameter time2 is passed, geomag data returned are
  averaged over the time interval from time to time2.

OUTPUT:
  structure: {geomag, kp:0.d, ap:0.d, dst:0.d}

NOTE:
  This routine works on vectors.
  Output will have the same dimensions as the input.

CREATED BY:	Ken Bromund  Dec 1997
FILE:  geomag.pro
VERSION:  1.5
LAST MODIFICATION:  98/01/06
</PRE><P>
<STRONG>(See <A href="fa_ops/geomag.pro">general/missions/fast/fa_ops/geomag.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GETSPEC">
<H2>GETSPEC</H2></A>
<A HREF="#GEOMAG">[Previous Routine]</A>
<A HREF="#GET_1D_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GETSPEC

 PURPOSE: To compute some sort of frequency spectrum from a
          uniformly sampled time series, after removing the mean
          value and any linear trend. 

 CALLING SEQUENCE: getspec,t,x,f,s
 
 INPUTS: T is an array of time tags for X. F is an array which, on
         return, contains the frequencies corresponding to the
         spectral estimates S. S has the same units as X by default,
         this can be changed with keywords. 
	
 KEYWORD PARAMETERS:
   NOCONDITION: If set, prevents the removal of the mean and best
                line from the time series data.

       COMPLEX: If set, causes GETSPEC to return an S of type
                complex, for use in cross-spectral analysis.  

           PSD: If set, causes PWRSPC to return power spectral
                density, i.e., the units of S will be [X]/sqrt(Hz).

     NOHANNING: If set, prevents PWRSPC from applying a zero-tapering
                window to the time series data. 

       BINSIZE: If non-zero, causes PWRSPC to sum BINSIZE
                near-neighbors of a preliminary spectrum into the
                final spectrum S. This reduces the number of elements
                of F and S, by a factor of approximately BINSIZE, and
                also reduces the variance in the spectral estimates. 

 SIDE EFFECTS: PWRSPC is called, unless COMPLEX is set. 

 RESTRICTIONS: ??? don't know of any ???

 MODIFICATION HISTORY: slowly developed by Bill Peria, UCBerkeley
                       Space Sciences Lab. This version
                       released on 25-July-1996. 

</PRE><P>
<STRONG>(See <A href="fa_ops/getspec.pro">general/missions/fast/fa_ops/getspec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_1D_FROM_SDT_TEMPLATE">
<H2>GET_1D_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GETSPEC">[Previous Routine]</A>
<A HREF="#GET_2DT_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines to get 
	1-D multidimensional type data from the SDT program shared memory buffers.
	Where modifications should be made, they are indicated by strings
	such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.  This template is setup
	to support the FAST/WIND/CLUSTER/POLAR data analysis software.  One may
	want to return a completely different format


	A structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_your-data-name_&gt;'  ; Data Quantity name
	   VALID         INT       1                     ; Data valid flag
	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'     ; project name
	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'     ; Units of this data
	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'  ; Units conversion proc
	   NROWS         INT       nrows                 ; Number of rows in array
	   TIME          DOUBLE    8.0118726e+08         ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08         ; End time of sample
          CALIBRATED    INT       calibrated            ; flags calibrated data
          CALIBRATED_UNITS STRING units                 ; calibrated units string
	   DATA          _Type_    array(nrows)          ; Data component 1
	   NMINMAX       INT       nminmax               ; number of arr-desc.           
	   MIN1          DOUBLE    array(nminmax)        ; min array descriptors
	   MAX1          DOUBLE    array(nminmax)        ; max array descriptors
	   MASS          DOUBLE    &lt;_mass-off-entity_&gt;   ; Particle Mass
	   GEOMFACTOR    DOUBLE    &lt;_your-geom-factor_&gt;  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	         ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_1d_from_sdt_template.pro	1.2 07/12/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_1d_from_sdt_template.pro">general/missions/fast/fa_ops/get_1d_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_2DT_TS">
<H2>GET_2DT_TS</H2></A>
<A HREF="#GET_1D_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GET_2D_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROGRAM:	get_2dt_ts,funct,get_dat
INPUT:	
	funct:	function,	function that operates on structures generated 
					by get_eesa_surv, get_eesa_burst, etc.
				funct   = 'n_2d','j_2d','v_2d','p_2d','t_2d',
					  'vth_2d','ec_2d', or 'je_2d'
	get_dat:function,	function that returns 2d data structures
				function name must be &quot;get_&quot;+&quot;get_dat&quot;+&quot;_ts&quot;  
				get_dat = 'fa_ees' for get_fa_ees_ts, 
				get_dat = 'fa_eeb' for get_fa_eeb_ts, etc.
KEYWORDS
	T1:	real or dbl	start time, seconds since 1970
	T2:	real or dbl	end time, seconds since 1970		
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
	GAP_TIME: 		time gap big enough to signify a data gap 
				(def 200 sec, 8 sec for FAST)
	NO_DATA: 	returns 1 if no_data else returns 0
	NAME:  		New name of the Data Quantity
				Default: funct+'_'+get_dat
	BKG:  		A 3d data structure containing the background counts.
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	value for bad data.
					0,1=exclude,include
	CALIB:		Calib keyword passed on to get_dat
	n_get_pts: 	Number of points in the array of structures formed by get_&quot;data_str&quot;_ts, default=200.

PURPOSE:
	To generate time series data for &quot;tplot.pro&quot; 
NOTES:	
	Program names time series data to funct+&quot;_&quot;+get_dat if NAME keyword not set
		See 'tplot_names.pro'.

CREATED BY:
	J.McFadden
LAST MODIFICATION:  97/05/16
MOD HISTORY:	
		97/05/16	Variation on get_2dt.pro that uses get_*_ts.pro routines

NOTES:	  
	Current version only works for FAST
</PRE><P>
<STRONG>(See <A href="fa_ops/get_2dt_ts.pro">general/missions/fast/fa_ops/get_2dt_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_2D_FROM_SDT_TEMPLATE">
<H2>GET_2D_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GET_2DT_TS">[Previous Routine]</A>
<A HREF="#GET_3D_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines to get 
	2-D multidimensional type data from the SDT program shared memory buffers.
	Where modifications should be made, they are indicated by strings
	such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.  This template is setup
	to support the FAST/WIND/CLUSTER/POLAR data analysis software.  One may
	want to return a completely different format


	A structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_yourDataName_&gt;'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'   ; project name
 	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'   ; Units of this data
 	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
          CALIBRATED    INT       calibrated          ; flags calibrated data
          CALIBRATED_UNITS STRING units               ; calibrated units string
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    &lt;_mass-off-entity_&gt; ; Particle Mass
	   GEOMFACTOR    DOUBLE    &lt;_your-geom-factor_&gt;; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_2d_from_sdt_template.pro	1.4 07/12/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_2d_from_sdt_template.pro">general/missions/fast/fa_ops/get_2d_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_3D_FROM_SDT_TEMPLATE">
<H2>GET_3D_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GET_2D_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GET_ARRAY_STRUC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines to get 
	3-D multidimensional type data from the SDT program shared memory buffers.
	Where modifications should be made, they are indicated by strings
	such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.  This template is setup
	to support the FAST/WIND/CLUSTER/POLAR data analysis software.  One may
	want to return a completely different format


	A structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_yourDataName_&gt;'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'   ; project name
 	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'   ; Units of this data
 	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
          CALIBRATED    INT       calibrated            ; flags calibrated data
          CALIBRATED_UNITS STRING units                 ; calibrated units string
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   PHI           FLOAT     Array(nnrgs, nbins) ; Phi angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DPHI          FLOAT     Array(nbins)        ; Delta Phi
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   MAP           INT       Array(16,8)         ; Angles to bin # map
	   PT_LIMITS     FLOAT     Array(4)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    &lt;_mass-off-entity_&gt; ; Particle Mass
	   GEOMFACTOR    DOUBLE    &lt;_your-geom-factor_&gt;; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_3d_from_sdt_template.pro	1.4 07/12/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_3d_from_sdt_template.pro">general/missions/fast/fa_ops/get_3d_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_ARRAY_STRUC">
<H2>GET_ARRAY_STRUC</H2></A>
<A HREF="#GET_3D_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GET_CACHE_MD_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	get_array_struct(time,START=start,EN=en,ADVANCE=advance,RETREAT=retreat)
PURPOSE:	
	Gets a structure from the common array_struc_com, see make_array_struc.pro
INPUT:
	time:	real		Currently time is ignored.
	
				Later versions may:
				This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'MM-DD-YY/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.
				Time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
;KEYWORDS:
	START:			If non-zero, get first data from array_struc
	EN:			If non-zero, get last  data from array_struc
	ADVANCE:		If non-zero, advance to the next data point
	RETREAT:		If non-zero, retreat to the previous data point 

CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  96-11-7	McFadden
MOD HISTORY:

NOTES:	  
	make_array_struc.pro makes an array of structures that is called by get_array_struc.pro
	Current version only works for FAST
	Written to speed up summary plot production for ees and ies
	Current version ignores time input, requires keyword to work properly
</PRE><P>
<STRONG>(See <A href="fa_ops/get_array_struc.pro">general/missions/fast/fa_ops/get_array_struc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_CACHE_MD_FROM_SDT">
<H2>GET_CACHE_MD_FROM_SDT</H2></A>
<A HREF="#GET_ARRAY_STRUC">[Previous Routine]</A>
<A HREF="#GET_CACHE_TS_1P_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_CACHE_MD_FROM_SDT

 DESCRIPTION:

	function to manage a time series cache of multi-dimensional
	sdt data.  If the data selected is found in the sdt buffers,
	a cache of size cache_hsk.def_size will be returned in the
	cache argument, and this function will return the index into
	the cache that the selection applies to.
	
 CALLING SEQUENCE:

	arr_idx= get_cache_md_from_sdt (data_name, sat_code, cache_hsk, cache,
				TIME=time, 
	                        [START = start | EN = en | ADVANCE = advance |
				RETREAT = retreat | INDEX = index], 
				[FLUSH = flush, CACHE_SIZE = cs ])

 ARGUMENTS:

	data_name		The SDT data quantity name
	sat_code		The SDT satellite code
	cache_hsk		Contains the cache housekeeping info
	cache			The actual cache

 KEYWORDS:

	TIME 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	INDEX			If index is gt 0, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If non-zero, will reset the default cache
				size.

 RETURN VALUE:

	Upon success, a non-zero index is returned.  Upon failure, 
	-1 is returned.

 REVISION HISTORY:

	@(#)get_cache_md_from_sdt.pro	1.2 05/06/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_cache_md_from_sdt.pro">general/missions/fast/fa_ops/get_cache_md_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_CACHE_TS_1P_FROM_SDT">
<H2>GET_CACHE_TS_1P_FROM_SDT</H2></A>
<A HREF="#GET_CACHE_MD_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_DENSITY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
        GET_CACHE_TS_1P_FROM_SDT

 DESCRIPTION:

       function to manage a cache of time series sdt data.  If the data 
	selected is found in the sdt buffers, a cache of size cache_hsk.def_size 
	will be returned in the cache argument, and this function will return 
	the index into the cache that the selection applies to.
       
 CALLING SEQUENCE:

       arr_idx= get_cache_ts_1p_from_sdt (data_name, sat_code, cache_hsk, cache,
                               TIME=time, | INDEX = index, 
				[FLUSH = flush, CACHE_SIZE = cs])

 ARGUMENTS:

       data_name               The SDT data quantity name
       sat_code                The SDT satellite code
       cache_hsk               Contains the cache housekeeping info
       cache                   The actual cache

 KEYWORDS:

       TIME                    This argument gives a time handle from which
                               to take data from.  It may be either a string
                               with the following possible formats:
                                       'YY-MM-DD/HH:MM:SS.MSC'  or
                                       'HH:MM:SS'     (use reference date)
                               or a number, which will represent seconds
                               since 1970 (must be a double &gt; 94608000.D), or
                               a hours from a reference time, if set.

                               time will always be returned as a double
                               representing the actual data time found in
                               seconds since 1970.

       INDEX                   If index is gt 0, it is used for selecting
                               the index to get data.

       FLUSH                   If non-zero, will flush the data cache
                               This is useful to force a re-read of sdt
                               buffers in case the data has changed.

       CACHE_SIZE              If non-zero, will reset the default cache
                               size.

 RETURN VALUE:

       Upon success, a non-zero index is returned.  Upon failure, 
       -1 is returned.

 REVISION HISTORY:

       @(#)get_cache_ts_1p_from_sdt.pro	1.3 05/06/98
       Originally written by Jonathan M. Loran,  University of 
       California at Berkeley, Space Sciences Lab.   May '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_cache_ts_1p_from_sdt.pro">general/missions/fast/fa_ops/get_cache_ts_1p_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_DENSITY">
<H2>GET_DENSITY</H2></A>
<A HREF="#GET_CACHE_TS_1P_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_DQDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_DENSITY

 PURPOSE: To bring the appropriate density data into IDL from SDT

 CALLING SEQUENCE: density = get_density(time1,time2)
 
 INPUTS: See documentation for GET_FA_FIELDS

 OUTPUTS: Either a structure or a TPLOT string handle, containing the
          density data. 

 KEYWORDS: Same as GET_FA_FIELDS. 

 MODIFICATION HISTORY: Written January 1997 by Bill Peria UCB/SSL
                     - added SVD based de-spiker, used when /SPIN is
                     set, provides spin period resolution
                     data. 25-Mar-97 BP
 

</PRE><P>
<STRONG>(See <A href="fa_ops/get_density.pro">general/missions/fast/fa_ops/get_density.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_DQDS">
<H2>GET_DQDS</H2></A>
<A HREF="#GET_DENSITY">[Previous Routine]</A>
<A HREF="#GET_DQI_INFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_DQDS

 PURPOSE: returns the list of DQD strings currently loaded in SDT

 CALLING SEQUENCE: list = get_dqds()
 
 INPUTS: none

 KEYWORDS: START_TIMES and END_TIMES. These can be used to return an
           array of start and end times to the caller, in double
           precision seconds since 1970.

 OUTPUTS: a strarr of DQD names, or the null string if SDT is not running.

 SIDE EFFECTS: calls SHOW_DQIS, which has a call_external in it. 

 MODIFICATION HISTORY: wriiten 22-Aug-97 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/get_dqds.pro">general/missions/fast/fa_ops/get_dqds.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_DQI_INFO">
<H2>GET_DQI_INFO</H2></A>
<A HREF="#GET_DQDS">[Previous Routine]</A>
<A HREF="#GET_EN_SPEC_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_DQI_INFO

 DESCRIPTION:

	function to get information about an sdt loaded DQI

 CALLING SEQUENCE:

 	data =  get_dqi_info(sat_code, dqi_name, [TIME=time, INDEX=idx])

 ARGUMENTS:

	sat_code  The sdt satellite code for the data quantity
	          to be queried.   Current known codes are:
			CRRES		1
			ISEE		2
			ISEE2		3
			GEOTAIL		24
			WIND		25
			POLAR		26
			CLUSTER		30
			GEOTAIL_SURVEY	241
			CRRES_SURVEY	1001
			FAST		2001

	dqi_name  The sdt data quatity string.  Hint, use the
	          procedure show_dqis to get these strings.

 KEYWORDS:

	The index and time keywords are to be used together:

	index:	If defined, return in the time keyword the time at
		index.
	time:	If defined, return in the index keyword, the index at
		time.

	If either time or index is out of range, the returned keyword
	of interest will be negative.

 RETURN VALUE:

	Upon failure, a scaler -1 is returned, else a stucture 
	of the following format is returned:
		{ SAT_CODE	LONG    ; same as calling arg
		  DQI_NAME	STRING  ; same as calling arg
		  STYEAR	LONG    ; start year of data
		  STMONTH	LONG    ; start month of data
		  STDAYOFMONTH	LONG    ; start day of month of data
		  STSEC		DOUBLE  ; start seconds of day of data
		  ENYEAR	LONG    ; end year of data
		  ENMONTH	LONG    ; end month of data
		  ENDAYOFMONTH	LONG    ; end day of month of data
		  ENSEC		DOUBLE  ; end seconds of day of data
		  STORAGE_TYPE	LONG    ; see below
		  NPTS		LONG    ; number of data points in dqi
		  DONE		LONG    ; 1 if dqi filled, 0 if waiting
		}

	STORAGE_TYPE is defined as:
		0	time series
		1	Multi-dimensional, one dimension
		2	Multi-dimensional, two dimensions
		3	Multi-dimensional, three dimensions

 REVISION HISTORY:

	@(#)get_dqi_info.pro	1.5 03/20/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Dec. '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_dqi_info.pro">general/missions/fast/fa_ops/get_dqi_info.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_EN_SPEC_TS">
<H2>GET_EN_SPEC_TS</H2></A>
<A HREF="#GET_DQI_INFO">[Previous Routine]</A>
<A HREF="#GET_ESS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	get_en_spec_ts
PURPOSE:	
	Generates energy-time spectrogram data structures for tplot
INPUT:		
	get_dat, 	a string (either 'fa_ees','fa_eeb', ...)
			where get_'string'_ts returns a 2D or 3D 
			array of data structures
KEYWORDS:
	T1:		start time, seconds since 1970
	T2:		end time, seconds since 1970		
	ANGLE:		fltarr(2),fltarr(4)	angle range to sum over
	ARANGE:		intarr(2)		bin range to sum over
	BINS:		bytarr(dat.nbins)	bins to sum over
	gap_time: 	time gap big enough to signify a data gap 
			(default 200 sec, 8 sec for FAST)
	NO_DATA: 	returns 1 if no_data else returns 0
	UNITS:		convert to these units if included
	NAME:  		New name of the Data Quantity
	BKG:  		A 3d data structure containing the background counts.
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	value for bad data.
	RETRACE: 	Set to number of retrace energy steps to be eliminated starting at energy step 0
	CALIB:		Calib keyword passed on to get_&quot;get_dat&quot;_ts
	n_get_pts: 	Number of points in the array of structures formed by get_&quot;get_dat&quot;_ts, default=200.

CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  97/05/15
MOD HISTORY:
		97/05/15	Variation on get_en_spec.pro with help from J.Loran

NOTES:	  
	Current version only works for FAST
</PRE><P>
<STRONG>(See <A href="fa_ops/get_en_spec_ts.pro">general/missions/fast/fa_ops/get_en_spec_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_ESS">
<H2>GET_ESS</H2></A>
<A HREF="#GET_EN_SPEC_TS">[Previous Routine]</A>
<A HREF="#GET_FA_2D_FIELDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	get_ess(time,START=start,EN=en,ADVANCE=advance,RETREAT=retreat)
INPUT:
	time:	real		This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'MM-DD-YY/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.
				Time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
;KEYWORDS:
	START:			If non-zero, get data from the start time
				of the data instance in the SDT buffers
	EN:			If non-zero, get data at the end time
				of the data instance in the SDT buffers
	ADVANCE:		If non-zero, advance to the next data point
				following the time input
	RETREAT:		If non-zero, retreat (reverse) to the previous
				data point before the time input
	VARARR			If non-zero, program will not convert to 48 Energy
				by 32 angle arrays.
PURPOSE:
	To generate fast eesa survey data structures averaged over one spin.
;NOTES:
	Program calls get_eesa_surv.pro multiple times to generate spin averaged data.
	Data is averaged starting at the first &quot;spin phase&quot;=0 after &quot;time&quot;.
	Program checks for header changes, returns dat.valid=2 if less than 1 spin averaged.
	Program only return 48 Energies x 32 Angles, will average if in 96 E or 64 A mode.
	See get_eesa_surv.pro
CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-2		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/get_ess.pro">general/missions/fast/fa_ops/get_ess.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_2D_FIELDS">
<H2>GET_FA_2D_FIELDS</H2></A>
<A HREF="#GET_ESS">[Previous Routine]</A>
<A HREF="#GET_FA_ATTITUDE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 Please look at documentation for get_fa_fields...you shouldn't call
 GET_FA_2D_FIELDS directly...

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_2d_fields.pro">general/missions/fast/fa_ops/get_fa_2d_fields.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ATTITUDE">
<H2>GET_FA_ATTITUDE</H2></A>
<A HREF="#GET_FA_2D_FIELDS">[Previous Routine]</A>
<A HREF="#GET_FA_ATT_DIAG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: get_fa_attitude

 PURPOSE: get the FAST attitude information for a given set of times

 POSITIONAL PARAMETERS:     
     arg1:
         if keyword parameter 'time_array' is set, then this parameter is the
         array of times for which the attitude is to be returned, else it is the
         start time of the timespan over which the attitude is to be returned.
     arg2:
         if keyword parameter 'time_array' is set, then this parameter is not used,
         else it is the end time of the timespan over which the attitude is to be returned.
     
 KEYWORD PARAMETERS:
     delta_t:
         spacing in seconds of the set of times from start time to end time, over which
         the attitude info is returned (default = 20 seconds).
         This parameter is ignored if the keyword parameter 'time_array' is set.
     attlevel:
         flag to specify what level of attitude info is desired:
             -1 : return the best attitude info available (the default)
              0 : return initial level attitude data only. this level has not
                      been verified in any way
              1 : return level one attitude data only. this level has had a first
                      attempt at correcting errors, mostly smoothed to remove jitter.
              2 : return definitive attitude only.  this level has been compared
                      with B-field model data, and sun pulse spin frequency corrected.
         if attlevel is set to either 0, 1, or 2, and the requested level of attitude
         data is not found, get_fa_attitude will mark that data point as invalid and
         will return no data for that time point.
     coord:
         a string specifying the coordinate system desired for the output rotation matrix.
         see the OUTPUTS section below.
         possible values for coord are (case doesn't matter, 'gse' = 'gSe' = 'GSE'):
             'FASTSPIN' : Spinning Spacecraft
             'DESPUN'   : Despun
             'GEI'      : Geocentric Equatorial Inertial
             'GEO'      : Geographic
             'GSE'      : Geocentric Solar Ecliptic
             'GSM'      : Geocentric Solar Magnetospheric
             'MAG'      : Geomagnetic
             'GECI'     : Ecliptic Inertial
             'GSEQ'     : Geocentric Solar Equatorial
             'SM'       : Solar Magnetic
     status:
         status of get_fa_attitude on return (0 means successful return, nonzero means
         some error has occurred).
         In general, the user should call get_fa_attitude with this status keyword set,
         and should explicitly test that status equal 0 for success.

 OUTPUTS:
     performs a 'store_data' operation on the following variables:
         fa_spin_ra:
             right ascension of the spin axis, in GEI coords, in degrees
         fa_spin_dec:
             declination of the spin axis, in GEI coords, in degrees
         fa_spin_freq:
             spin rate in degrees/second
         fa_spin_phase:
             spin phase about the spin axis, in degrees.  zero phase means
             spacecraft x axis is in the sun.
         fa_attlevel:
             the attitude level of the data found.
         fa_rotmat_xxx:
             the rotation matrix from the FASTSPIN coordinate system to the coord
             system that was selected by the input keyword parameter 'coord',
             and where 'xxx' is the coord system specified by the keyword param 'coord'.

 ERRORS:
     If attlevel 0, 1, or 2 has been selected and if this level of attitude data is not
     found, or if any other error occurs, the given time point will be marked as invalid,
     returned attitude data will have value NaN.

 CREATED BY: Vince Saba,  Oct, 1996.

 VERSION: @(#)get_fa_attitude.pro	1.5 06/05/97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_attitude.pro">general/missions/fast/fa_ops/get_fa_attitude.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ATT_DIAG">
<H2>GET_FA_ATT_DIAG</H2></A>
<A HREF="#GET_FA_ATTITUDE">[Previous Routine]</A>
<A HREF="#GET_FA_BDC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

 get_fa_att_diag.pro

 PURPOSE:

 Calculates attitude quantites and loads them into tplot structures.

 INPUTS:

   T1        Start time of the interval.
   T2        End time of the interval.

 KEYWORDS:

 NOTES:      

   Time resolution is 20 seconds.

   Created: 
   Creator: J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_att_diag.pro">general/missions/fast/fa_ops/get_fa_att_diag.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_BDC">
<H2>GET_FA_BDC</H2></A>
<A HREF="#GET_FA_ATT_DIAG">[Previous Routine]</A>
<A HREF="#GET_FA_EDC_LONG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: get_fa_bdc

 DESCRIPTION: returns a structure containing DC
 magnetic field survey data from the FAST magnetometer (UCLA). It
 must be the case that SDT is running, with Mag1dc, Mag2dc_S, and Mag3dc_S
 plotted on screen already. 

    The returned structure looks like this:


  DATA_NAME           STRING    ' '                 ; which mag quantities
  VALID               INT       1                   ; Data valid flag
  PROJECT_NAME        STRING    'FAST'              ; project name
  UNITS_NAME          STRING    'nT'                ; Units of this data    
  UNITS_PROCEDURE     STRING    'fa_fields_units'   ; Units conversion proc 
  START_TIME          DOUBLE                        ; Start Time of sample  
  END_TIME            DOUBLE                        ; End time of sample    
  NPTS                INT                           ; Number of time samples
  NCOMP               INT                           ; Number of components  
  TIME                DOUBLE    Array(npts)         ; timetags              
  COMP1               DOUBLE    Array(npts)         ;
  COMP2               DOUBLE    Array(npts)         ; 
  COMP3               DOUBLE    Array(npts)         ;
      
 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.


 CALLING SEQUENCE: mag  = get_fa_bdc(time1, time2, [NPTS=npts],
                             [START=st | EN=en | PANF=panf | PANB =
                             panb | ALL = all])



 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to a number between 1 and 7. The number is determined by
	interpreting the valid tags from each of the three long booms
	as binary digits; mag1.valid is weighted 1, mag2.valid 2,
	mag3.valid 4. Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_bdc.pro	1.17 18 Jul 1996
 	Originally written by	 Bill Peria,  University of 
 	California at Berkeley, Space Sciences Lab.   July 22, 1996
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_bdc.pro">general/missions/fast/fa_ops/get_fa_bdc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EDC_LONG">
<H2>GET_FA_EDC_LONG</H2></A>
<A HREF="#GET_FA_BDC">[Previous Routine]</A>
<A HREF="#GET_FA_EEB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: get_fa_edc_long

 DESCRIPTION: returns, as best it can, a structure containing DC
 electric field survey data from the FAST booms (1-4, 5-8, 9-10). It
 must be the case that SDT is running, with V1-4, 5-8, and 9-10
 plotted on screen already. In the case where, for example, sphere 9
 is in voltage mode, then an array containing IEEE NaN, plus a
 leading zero, will be returned in place of V9-10. 

    The returned structure looks like this:


  DATA_NAME           STRING    ' E1-4 E5-8 E9-10'  ; which 'E' quantities
  VALID               INT       1                   ; Data valid flag
  PROJECT_NAME        STRING    'FAST'              ; project name
  UNITS_NAME          STRING    'mV/m'              ; Units of this data    
  UNITS_PROCEDURE     STRING    'fa_fields_units'   ; Units conversion proc 
  START_TIME          DOUBLE                        ; Start Time of sample  
  END_TIME            DOUBLE                        ; End time of sample    
  NPTS                INT                           ; Number of time samples
  NCOMP               INT                           ; Number of components  
  TIME                DOUBLE    Array(npts)         ; timetags              
  E14                 DOUBLE    Array(npts)         ;
  E58                 DOUBLE    Array(npts)         ; 
  E910                DOUBLE    Array(npts)         ;
      
 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.


 CALLING SEQUENCE: e_long = get_fa_edc_long(time1, time2, [NPTS=npts],
                             [START=st | EN=en | PANF=panf | PANB =
                             panb | ALL = all])



 CURRENT PROBLEMS: It's not clear what to do if the time bases for
 the different data quantities are not the same. Right now, the times
 returned are those of the first available DQD, in order [V1-V4,
 V5-V8, V9-V10].  Yikes! Also, no indication of mode is returned...

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to a number between 1 and 7. The number is determined by
	interpreting the valid tags from each of the three long booms
	as binary digits; v14.valid is weighted 1, v58.valid 2,
	v910.valid 4. Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_edc_long.pro	1.18 07/23/96
 	Originally written by	 Bill Peria,  University of 
 	California at Berkeley, Space Sciences Lab.   June '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_edc_long.pro">general/missions/fast/fa_ops/get_fa_edc_long.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EEB">
<H2>GET_FA_EEB</H2></A>
<A HREF="#GET_FA_EDC_LONG">[Previous Routine]</A>
<A HREF="#GET_FA_EEB_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EEB

 DESCRIPTION:

	function to load FAST E-esa burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Eesa Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_eeb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_eeb.pro	1.20 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_eeb.pro">general/missions/fast/fa_ops/get_fa_eeb.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EEB_C">
<H2>GET_FA_EEB_C</H2></A>
<A HREF="#GET_FA_EEB">[Previous Routine]</A>
<A HREF="#GET_FA_EEB_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EEB_C

 DESCRIPTION:


	function to load FAST E-esa burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Eesa Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_eeb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_eeb_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_eeb_c.pro">general/missions/fast/fa_ops/get_fa_eeb_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EEB_HDR">
<H2>GET_FA_EEB_HDR</H2></A>
<A HREF="#GET_FA_EEB_C">[Previous Routine]</A>
<A HREF="#GET_FA_EEB_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EEB_HDR

 DESCRIPTION:

	function to load FAST E-esa burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Eesa_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'eiesa_unpack_hdr' ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_eeb_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_eeb_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_eeb_hdr.pro">general/missions/fast/fa_ops/get_fa_eeb_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EEB_TS">
<H2>GET_FA_EEB_TS</H2></A>
<A HREF="#GET_FA_EEB_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_EES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EEB_TS

 DESCRIPTION:


	function to load FAST E-esa Burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Eesa Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_eeb_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_eeb_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_eeb_ts.pro">general/missions/fast/fa_ops/get_fa_eeb_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EES">
<H2>GET_FA_EES</H2></A>
<A HREF="#GET_FA_EEB_TS">[Previous Routine]</A>
<A HREF="#GET_FA_EES_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EES

 DESCRIPTION:


	function to load FAST E-esa survey data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Eesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_ees (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ees.pro	1.27 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ees.pro">general/missions/fast/fa_ops/get_fa_ees.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EES_C">
<H2>GET_FA_EES_C</H2></A>
<A HREF="#GET_FA_EES">[Previous Routine]</A>
<A HREF="#GET_FA_EES_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EES_C

 DESCRIPTION:


	function to load FAST E-esa survey data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Eesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_ees (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ees_c.pro	1.2 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ees_c.pro">general/missions/fast/fa_ops/get_fa_ees_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EES_HDR">
<H2>GET_FA_EES_HDR</H2></A>
<A HREF="#GET_FA_EES_C">[Previous Routine]</A>
<A HREF="#GET_FA_EES_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EES_HDR

 DESCRIPTION:

	function to load FAST E-esa survey header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Eesa_Survey_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'eiesa_unpack_hdr' ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_ees_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ees_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ees_hdr.pro">general/missions/fast/fa_ops/get_fa_ees_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EES_SP">
<H2>GET_FA_EES_SP</H2></A>
<A HREF="#GET_FA_EES_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_EES_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	get_fa_ees_sp(time,START=start,EN=en,ADVANCE=advance,RETREAT=retreat,CALIB=calib)
INPUT:
	time:	real		This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'MM-DD-YY/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.
				Time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
;KEYWORDS:
	START:			If non-zero, get data from the start time
				of the data instance in the SDT buffers
	EN:			If non-zero, get data at the end time
				of the data instance in the SDT buffers
	ADVANCE:		If non-zero, advance to the next data point
				following the time input
	RETREAT:		If non-zero, retreat (reverse) to the previous
				data point before the time input
	CALIB:			If non-zero, use the esa calibration array
	VARARR			If non-zero, program will not convert to 48 Energy
				by 32 angle arrays.
PURPOSE:
	To generate fast eesa survey data structures averaged over one spin.
;NOTES:
	Program calls get_fa_ees_c.pro multiple times to generate spin averaged data.
	Data is averaged starting at the first &quot;spin phase&quot;=0 after &quot;time&quot;.
	Program checks for header changes, returns dat.valid=2 if less than 1 spin averaged.
	Program only return 48 Energies x 32 Angles, will average if in 96 E or 64 A mode.
	See get_fa_ees_c.pro
CREATED BY:
	J.McFadden	96-7-2	
LAST MODIFICATION:  97/03/04
MOD HISTORY:
		97/03/04	CALIB keyword added
		97/07/23	uses get_fa_ees_c.pro now
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ees_sp.pro">general/missions/fast/fa_ops/get_fa_ees_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_EES_TS">
<H2>GET_FA_EES_TS</H2></A>
<A HREF="#GET_FA_EES_SP">[Previous Routine]</A>
<A HREF="#GET_FA_FDF_ATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EES_TS

 DESCRIPTION:


	function to load FAST E-esa survey data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Eesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_ees_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ees_ts.pro	1.2 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ees_ts.pro">general/missions/fast/fa_ops/get_fa_ees_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_FDF_ATT">
<H2>GET_FA_FDF_ATT</H2></A>
<A HREF="#GET_FA_EES_TS">[Previous Routine]</A>
<A HREF="#GET_FA_FIELDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: get_fa_fdf_att(time)
NAME:
  get_fa_fdf_att
PURPOSE:
 Get the spin attidude vector for the given time from
 the FDF attitude files.

INPUT:  time input must be of a type which is valid as
        an input to time_double, array's exceptable.
  
OUTPUT: att_struc structure:
         elements: x, y, z, zsun, lambda, phi
        all elements are double.

KEYWORDS:
  FILE: if set, use given FDF attitude file name.
  FDF_DIR:  if set, use given string as directory in which to find
    FDF files.

ENVIRONMENT VARIABLES:
  FAST_FDFATT_DIR  if set, provides the default directory to
    consult when looking for FDF attitude files.  Is overridden by 
    the keyword FDF_DIR.

SEE ALSO:  &quot;time_double&quot;

CREATED BY:	KRB 1997-09-11
FILE:  %M%
VERSION:  %I%
LAST MODIFICATION:  %E%
  added FDF_DIR keyword for use outside of the ``Ivory Tower''.
  also changed SPAWN calls to allow for noisy shell startup scripts.
  JWB, LANL, 04-29-98
  added examination of environment variable FAST_FDFATT_DIR to
  allow for more transparent changing of default directory for
  FDF attitude files.  JWB, LANL, 05-08-98.
  fixed y2k bug in FDF file sorting.  JWB, UCBSSL, 02-01-2000.

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_fdf_att.pro">general/missions/fast/fa_ops/get_fa_fdf_att.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_FIELDS">
<H2>GET_FA_FIELDS</H2></A>
<A HREF="#GET_FA_FDF_ATT">[Previous Routine]</A>
<A HREF="#GET_FA_FLDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_FIELDS 

 PURPOSE: to get data from the FAST fields instrument

 CALLING SEQUENCE: mydata = get_fa_fields(dqd,[ time1, time2,
                   NPTS=npts, START=st, EN=en, PANF=pf, PANB=pb,
                   ALL = all, CALIBRATE = calibrate, STORE = store])

 INPUTS: 
        DQD: a string containing a valid Data Quantity Descriptor to
             pass on to SDT. If SDT doesn't recognize the DQD, an
             error message is sent to the screen, and an invalid
             status is returned to IDL. Use the routine HELPFAST to
             access a list of valid DQD's through Netscape.

 NOTE: If GET_FA_FIELDS is called with nothing but a DQD, then the
       keywords ALL, CALIBRATE, and REPAIR will be automatically
       set. Furthermore, if GET_FA_FIELDS is called with no
       *time-selection* keywords or time limits, then the ALL keyword
       will be set.

 OUTPUTS: A structure of the following format is returned to the
          caller, *UNLESS* the keyword STORE is set, in which case
          the data are stored tplot-style, and the TPLOT string
          handle is returned to the caller. The STREAK_* tags are
          arrays of indices into the COMP* tags. If the REPAIRED tag
          contains a 1 on return, then the STREAK_* tags mark the
          starts, lengths, and ends of streaks of contiguous,
          evenly-sampled data. 

 DATA_NAME              STRING                     'V1-V4_S'
 VALID                  INTEGER                           1
 PROJECT_NAME           STRING                        'FAST'
 UNITS_NAME             STRING                        'mV/m'
 CALIBRATED             LONG                              1
 UNITS_PROCEDURE        STRING           'fast_fields_units'
 START_TIME             DOUBLE                8.5194794e+08
 END_TIME               DOUBLE                8.5195604e+08
 NPTS                   LONG                           5000
 NCOMP                  LONG                              1
 DEPTH                  LONARR(NCOMP)                     1
 TIME                   DBLARR(NPTS)   START_TIME-&gt;END_TIME
 COMP*                  FLTARR(NPTS,DEPTHS(*))     SCIENCE!
 STREAK_STARTS          LONARR(??)
 STREAK_LENGTHS         LONARR(??)
 STREAK_ENDS            LONARR(??)
 REPAIRED               LONG                              1
                         
 OPTIONAL INPUTS:

       time1 : This argument gives the start time from which to take
               data, or, if START or EN keywords are non-zero, the
               length of time to take data.  It may be either a
               string with the following possible formats:
               'YY-MM-DD/HH:MM:SS.MSC' or 'HH:MM:SS' (use reference
               date) or a number, which will represent seconds since
               1970 (must be a double &gt; 94608000.D), or hours from a
               reference time, if set. 

       time2 : The same as time1, except it represents the end
               time. If the NPTS, START, EN, PANF or PANB keywords
               are non-zero, then time2 will be ignored as an input
               parameter.
       
 KEYWORD PARAMETERS:

       CALIBRATE: If set, causes calibrated data to be returned, if
                  possible. Otherwise, raw data are returned,
                  *unless* the environment variable FAST_CALIBRATE is
                  set to 1, i.e. setenv FAST_CALIBRATE 1 .  Setting
                  the CALIBRATE keyword causes the procedure name in
                  DAT.UNITS_PROCEDURE to be called.

       DEFAULT: If set, causes CALIBRATE, ALL, and REPAIR to be set. 

       MIN_BUF_LENGTH: If defined, sets the minimum number of
                       time-contiguous points in a &quot;good streak&quot; or
                       &quot;buffer&quot; of data. Default is 10.

       REPAIR: If set, causes a time column patcher to be
               called. Otherwise, you get what SDT is giving. 

       SPIN: If defined, causes the data to be returned at once per
             spin resolution, at a phase equal to the value of SPIN
             in degrees. 

       STORE: If set, the tplot routine STORE_DATA is called, and a
              rudimentary tplot quantity is stored, to be accessed
              through GET_DATA. In this case, GET_FA_FIELDS returns
              the TPLOT string handle to the caller. 

       STRUCTURE: A named variable in which the data structure
                  described above can be returned, if desired (for
                  example, if STORE is set). 

       YBINS: If nonzero, two dimensional fields quantities are
              returned with this many frequency bins. 

       BACKGROUND: If set, causes a background to be removed from 2D
              fields quantities. The background is that returned
              from the function NOISE. Note that this all makes sense
              only for 2D, CALIBRATE'd quantities. 
  
       Other keywords determine data time selection as given in the 
       following truth table (NZ == non-zero):

|ALL|NPTS|START|EN|PANF|PANB|selection             |use time1|use time2|
|---|----|-----|--|----|----|----------------------|---------|---------|
| NZ|  0 |  0  | 0|  0 |  0 |start -&gt; end          |  X      |  X      |
| 0 |  0 |  0  | 0|  0 |  0 |time1 -&gt; time2        |  X      |  X      |
| 0 |  0 |  NZ | 0|  0 |  0 |start -&gt; time1 secs   |  X      |         |
| 0 |  0 |  0  |NZ|  0 |  0 |end-time1 secs -&gt; end |  X      |         |
| 0 |  0 |  0  | 0|  NZ|  0 |pan fwd, time1-&gt;time2 |  X      |  X      |
| 0 |  0 |  0  | 0|  0 |  NZ|pan back,time1-&gt;time2 |  X      |  X      |
| 0 |  NZ|  0  | 0|  0 |  0 |time1 -&gt; time1+npts   |  X      |         |
| 0 |  NZ|  NZ | 0|  0 |  0 |start -&gt; start+npts   |         |         |
| 0 |  NZ|  0  |NZ|  0 |  0 |end-npts -&gt; end       |         |         |

       No other combination of keywords is allowed.

 RESTRICTIONS: The data corresponding to DQD must already be on
               screen, having been plotted by SDT.

 EXAMPLE: my_data = get_fa_fields('V1-V4_S',/all) *OR*
          tplot,get_fa_fields('Mag3dc_S',/all,/calibrate,/store,struc=my_data)

 MODIFICATION HISTORY: written June 1996 by Bill Peria, UCBerkeley
                       Space Sciences Laboratory
       @(#)get_fa_fields.pro	1.64     

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_fields.pro">general/missions/fast/fa_ops/get_fa_fields.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_FLDS">
<H2>GET_FA_FLDS</H2></A>
<A HREF="#GET_FA_FIELDS">[Previous Routine]</A>
<A HREF="#GET_FA_IEB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_FLDS

 PURPOSE: To store raw FAST fields quantities for TPLOT

 CALLING SEQUENCE:   get_fa_fields,dqd,[ time1, time2,
                   NPTS=npts, START=st, EN=en, PANF=pf, PANB=pb,
                   ALL = all, CALIBRATE = calibrate, STORE = store]
 
 INPUTS:  DQD - a string containing a valid Data Quantity Descriptor
                 to pass on to SDT. If SDT doesn't recognize the DQD,
                 an error message is sent to the screen, and an
                 invalid status is returned to IDL. The file
                 FastDQD.doc, in the directory
                 /disks/fast/software/integration/docs, contains all
                 the current DQD information for FAST. The Unix
                 command:  

                     grep DataQuantity $FASTHOME/FastDQD.doc,

                 will produce a (long!) list of valid DQD's, which you
                 could redirect into a file for future reference. 



 OPTIONAL INPUTS:


	time1 			This argument gives the start time from
	        		which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, then time2 will be ignored as an
				input parameter.


 KEYWORD PARAMETERS:

       CALIBRATE: If set, causes calibrated data to be returned, if
                  possible. Otherwise, raw data are returned,
                  *unless* the environment variable FAST_CALIBRATE is
                  set to 1, i.e. setenv FAST_CALIBRATE 1 . 

       STORE: Meaningless, always set.

       STRUCTURE: A named variable in which the data structure
                  described above can be returned, if desired (for
                  example, if STORE is set). 

       SPIN: If defined, causes the data to be returned at once per
             spin resolution, at a phase equal to the value of SPIN
             in degrees. 

       YBINS: If nonzero, two dimensional fields quantities are
              returned with this many frequency bins. 

       Setting the CALIBRATE keyword causes the procedure name in
       DAT.UNITS_PROCEDURE to be called. 

  
	Other keywords determine data time selection as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	No other combination of keywords is allowed.

 RESTRICTIONS:    The data corresponding to DQD must already be on
 screen, having been plotted by SDT.  


 OUTPUTS: A TPLOT quantitiy, with the name DQD, is stored. 


 EXAMPLE: get_fa_flds,'Mag1dc_S',/all



 MODIFICATION HISTORY: written 3-October-1996 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_flds.pro">general/missions/fast/fa_ops/get_fa_flds.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IEB">
<H2>GET_FA_IEB</H2></A>
<A HREF="#GET_FA_FLDS">[Previous Routine]</A>
<A HREF="#GET_FA_IEB_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IEB

 DESCRIPTION:

	function to load FAST I-esa burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Iesa Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.0002720           ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_ieb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ieb.pro	1.19 12/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ieb.pro">general/missions/fast/fa_ops/get_fa_ieb.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IEB_C">
<H2>GET_FA_IEB_C</H2></A>
<A HREF="#GET_FA_IEB">[Previous Routine]</A>
<A HREF="#GET_FA_IEB_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IEB_C

 DESCRIPTION:


	function to load FAST I-esa burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Iesa Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.0002720           ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_ieb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ieb_c.pro	1.2 12/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ieb_c.pro">general/missions/fast/fa_ops/get_fa_ieb_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IEB_HDR">
<H2>GET_FA_IEB_HDR</H2></A>
<A HREF="#GET_FA_IEB_C">[Previous Routine]</A>
<A HREF="#GET_FA_IEB_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IEB_HDR

 DESCRIPTION:

	function to load FAST I-esa burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Iesa_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'eiesa_unpack_hdr' ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_ieb_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ieb_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ieb_hdr.pro">general/missions/fast/fa_ops/get_fa_ieb_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IEB_TS">
<H2>GET_FA_IEB_TS</H2></A>
<A HREF="#GET_FA_IEB_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_IES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IEB_TS

 DESCRIPTION:


	function to load FAST I-esa burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Iesa Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000272            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_ieb_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ieb_ts.pro	1.4 12/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ieb_ts.pro">general/missions/fast/fa_ops/get_fa_ieb_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IES">
<H2>GET_FA_IES</H2></A>
<A HREF="#GET_FA_IEB_TS">[Previous Routine]</A>
<A HREF="#GET_FA_IES_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IES

 DESCRIPTION:

	function to load FAST E-esa survey data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Eesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000272            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_ies (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ies.pro	1.24 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ies.pro">general/missions/fast/fa_ops/get_fa_ies.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IES_C">
<H2>GET_FA_IES_C</H2></A>
<A HREF="#GET_FA_IES">[Previous Routine]</A>
<A HREF="#GET_FA_IES_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IES_C

 DESCRIPTION:


	function to load FAST I-esa survey data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Iesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000272            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_ies (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ies_c.pro	1.3 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ies_c.pro">general/missions/fast/fa_ops/get_fa_ies_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IES_HDR">
<H2>GET_FA_IES_HDR</H2></A>
<A HREF="#GET_FA_IES_C">[Previous Routine]</A>
<A HREF="#GET_FA_IES_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IES_HDR

 DESCRIPTION:

	function to load FAST I-esa survey header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Iesa_Survey_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'eiesa_unpack_hdr' ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_ies_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ies_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ies_hdr.pro">general/missions/fast/fa_ops/get_fa_ies_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IES_SP">
<H2>GET_FA_IES_SP</H2></A>
<A HREF="#GET_FA_IES_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_IES_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	get_fa_ies_sp(time,START=start,EN=en,ADVANCE=advance,RETREAT=retreat,CALIB=calib)
INPUT:
	time:	real		This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'MM-DD-YY/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.
				Time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
;KEYWORDS:
	START:			If non-zero, get data from the start time
				of the data instance in the SDT buffers
	EN:			If non-zero, get data at the end time
				of the data instance in the SDT buffers
	ADVANCE:		If non-zero, advance to the next data point
				following the time input
	RETREAT:		If non-zero, retreat (reverse) to the previous
				data point before the time input
	CALIB:			If non-zero, use the esa calibration array
	VARARR			If non-zero, program will not convert to 48 Energy
				by 32 angle arrays.
PURPOSE:
	To generate fast iesa survey data structures averaged over one spin.
;NOTES:
	Program calls get_fa_ies_c.pro multiple times to generate spin averaged data.
	Data is averaged starting at the first &quot;spin phase&quot;=0 after &quot;time&quot;.
	Program checks for header changes, returns dat.valid=2 if less than 1 spin averaged.
	Program only return 48 Energies x 32 Angles, will average if in 96 E or 64 A mode.
	See get_fa_ies_c.pro
CREATED BY:
	J.McFadden	96-7-2	
LAST MODIFICATION:  97/03/04
MOD HISTORY:
		97/03/04	CALIB keyword added
		97/07/23	uses get_fa_ies_c.pro now
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ies_sp.pro">general/missions/fast/fa_ops/get_fa_ies_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_IES_TS">
<H2>GET_FA_IES_TS</H2></A>
<A HREF="#GET_FA_IES_SP">[Previous Routine]</A>
<A HREF="#GET_FA_MSCRUB_MULTERRS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_IES_TS

 DESCRIPTION:


	function to load FAST I-esa survey data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Iesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000272            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_ies_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ies_ts.pro	1.3 12/03/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ies_ts.pro">general/missions/fast/fa_ops/get_fa_ies_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_MSCRUB_MULTERRS">
<H2>GET_FA_MSCRUB_MULTERRS</H2></A>
<A HREF="#GET_FA_IES_TS">[Previous Routine]</A>
<A HREF="#GET_FA_MSCRUB_SINGERRS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_fa_mscrub_multerrs

 DESCRIPTION:

	Gets the quantity 'MScrub_SumMultipleErrs' from SDT SMBs.

	NOTE: The quantity described by the DQD 'MScrub_SumMultipleErrs' 
	should actually be 'MScrub_SumSingleErrs'.  Whether or not this
	routine returns the correct quantity is transparent to this function.

	A structure of the following format is returned:

	DATA_NAME     STRING    'MScrub_SumMultipleErrs'; Data Quantity name
	VALID         INT       1		; Data valid flag
 	PROJECT_NAME  STRING    'FAST'		; project name
 	UNITS_NAME    STRING    'counts'	; Units of this data
 	UNITS_PROCEDURE	STRING 'UNITS_PROCEDURE'; Units conversion proc
	START_TIME    DOUBLE    8.0118726e+08   ; Start Time of sample
	END_TIME      DOUBLE    7.9850884e+08   ; End time of sample
	NPTS          INT       npts            ; Number of time samples
	NCOMP         INT       1		; Number of components
	DEPTH         INT       1		; depth of component(s)
       TIME          DOUBLE    Array(npts)     ; timetags
	MEMERRORS     FLOAT     Array(npts)	; Data component 1
	HEADER_BYTES  BYTE      Array(1)	; Header bytes (not implemented)
	   
	
 CALLING SEQUENCE:

 	data = get_fa_mscrub_multerrs (time1, time2, \
		[NPTS=npts], [START=st | EN=en | PANF=panf | PANB = panb])

 ARGUMENTS:

	time1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.
 KEYWORDS:

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created from the template:
	@(#)get_ts_from_sdt_template.pro	1.9 07/12/96
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '96
	
	Modified by J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_mscrub_multerrs.pro">general/missions/fast/fa_ops/get_fa_mscrub_multerrs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_MSCRUB_SINGERRS">
<H2>GET_FA_MSCRUB_SINGERRS</H2></A>
<A HREF="#GET_FA_MSCRUB_MULTERRS">[Previous Routine]</A>
<A HREF="#GET_FA_ORBATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_fa_mscrub_singerrs

 DESCRIPTION:

	Gets the quantity 'MScrub_SumSingleErrs' from SDT SMBs.

	NOTE: The quantity described by the DQD 'MScrub_SumSingleErrs' 
	should actually be 'MScrub_SumMultipleErrs'.  This may change.

	A structure of the following format is returned:

	DATA_NAME     STRING    'MScrub_SumSingleErrs'; Data Quantity name
	VALID         INT       1		; Data valid flag
 	PROJECT_NAME  STRING    'FAST'		; project name
 	UNITS_NAME    STRING    'counts'	; Units of this data
 	UNITS_PROCEDURE	STRING 'UNITS_PROCEDURE'; Units conversion proc
	START_TIME    DOUBLE    8.0118726e+08   ; Start Time of sample
	END_TIME      DOUBLE    7.9850884e+08   ; End time of sample
	NPTS          INT       npts            ; Number of time samples
	NCOMP         INT       1		; Number of components
	DEPTH         INT       1		; depth of component(s)
       TIME          DOUBLE    Array(npts)     ; timetags
	MEMERRORS     FLOAT     Array(npts)	; Data component 1
	HEADER_BYTES  BYTE      Array(1)	; Header bytes (not implemented)
	   
	
 CALLING SEQUENCE:

 	data = get_fa_mscrub_singerrs (time1, time2, \
		[NPTS=npts], [START=st | EN=en |PANF=panf | PANB = panb])

 ARGUMENTS:

	time1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.
 KEYWORDS:

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created from the template:
	@(#)get_ts_from_sdt_template.pro	1.9 07/12/96
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '96
	
	Modified by J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_mscrub_singerrs.pro">general/missions/fast/fa_ops/get_fa_mscrub_singerrs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ORBATT">
<H2>GET_FA_ORBATT</H2></A>
<A HREF="#GET_FA_MSCRUB_SINGERRS">[Previous Routine]</A>
<A HREF="#GET_FA_ORBIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 inputs:
   start    start time in any format accepted by time_double
   finish   end time in any format accepted by time_double
   qtylist  string containing comma separated list of desired columns from
            the events_data table.  e.g. 'X, Y, Z'
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_orbatt.pro">general/missions/fast/fa_ops/get_fa_orbatt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ORBIT">
<H2>GET_FA_ORBIT</H2></A>
<A HREF="#GET_FA_ORBATT">[Previous Routine]</A>
<A HREF="#GET_FA_ORBIT_GEOMAG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: get_fa_orbit

 PURPOSE:  
    Computes orbit vectors for a set of times extending over a given timespan.

 POSITIONAL PARAMETERS:
    arg1:
        if keyword parameter 'time_array' is not set, then this parameter is the
        start time of the timespan over which orbit vectors are to be computed,
        else it is the array of times for which orbit vectors are to be computed.
    arg2:
        if keyword parameter 'time_array' is not set, then this parameter is the
        end time of the timespan over which orbit vectors are to be computed,
        else it is not used.
    
 KEYWORDS:
    time_array:
        If not set, then interpret the two positional parameters as the start
        time and end time of the timespan over which orbit vectors are to be
        computed.  If set, interpret the first positional parameter as an array
        of times for which orbit vectors are to be computed, and the second
        positional parameter as the number of elements in the array of times.
    gse:
        If set, get_fa_orbit will execute a store_data on the following:
	     {x:time,y:pos,ytitle:'fa_pos'}
	     {x:time,y:pos,ytitle:'fa_vel'}
	 All overides this keyword.
    all:
        If not set, and gse is not set, get_fa_orbit will execute a 
	 store_data on the following:
	     {x:time,y:orbit,ytitle:'ORBIT'}
	     {x:time,y:pos,ytitle:'fa_pos'}
	     {x:time,y:alt,ytitle:'ALT'}
	     {x:time,y:ilat,ytitle:'ILAT'}
	     {x:time,y:ilng,ytitle:'ILNG'}
	     {x:time,y:mlt,ytitle:'MLT'}
	     {x:time,y:vel,ytitle:'fa_vel'}
        If set, get_fa_orbit will execute store_data on the above and also on:
	     {x:time,y:lat,ytitle:'LAT'}
	     {x:time,y:lng,ytitle:'LNG'}
	     {x:time,y:flat,ytitle:'FLAT'}
	     {x:time,y:flng,ytitle:'FLNG'}
	     {x:time,y:b,ytitle:'B_model'}
            {x:time,y:bfoot,ytitle:'BFOOT'}
        where orbit, pos, alt, etc are arrays of values as defined in the orbitio
        library documentation (see orbitlib(3)), and bfoot is the magnetic
        field at the position of the footprint, in GEI coords, in nTesla.
        Note that the position, velocity, magnetic field, and magnetic field
        at the footprint are given in GEI coordinates.
    status:
        The long integer return value of the OrbGetVectors() call in the orbitio
        library.  There are about a dozen different status codes indicating the
        various possible error conditions.  These status codes are shown in the
        include file $(workspace)/include/orbitlib.h (ORB_OK, ORB_EOF, etc).
        The user should generally call get_fa_orbit with the status keyword set,
        and should explicitly test that status equals 0 (ORB_OK = 0 signifies
        success) before using the returned data.
    delta_t:
        spacing in seconds of the computed orbit vectors (default = 20 sec)
        this keyword parameter is ignored if keyword parameter time_array is set
    definitive:
        if set, uses the definitive orbit file, else uses the predicted orbit
        file.  (see keyword 'orbit_file' below)
    drag_prop:
        if set, the call to the orbitprop library will use an orbit propagator
        that includes the effects of atmospheric drag (which is somewhat slower,
        but more accurate).  If not set, uses an orbit propagator which ignores
        atmospheric drag.
    orbit_file:
        if set to a pathname of an orbit file, this named orbit file will be used
        instead of the default orbit file, which is found by reading the file
        $FASTCONFIG/fast_archive.conf for the variable FAST_ALMANAC, and then
        setting orbit_file = value(FAST_ALMANAC)/orbit/predicted, unless the
        keyword definitive is set, in which case 
        orbit_file = value(FAST_ALMANAC)/orbit/definitive.
    verbose:
        Should not be used by users.  For debugging use only.  Functionality 
        changes unexpectedly and without notice.
    addfp:
        Should not be used by users.  For debugging use only.  Functionality 
        changes unexpectedly and without notice.
    no_store:
        If set, inhibits tplot-storage of orbit quantities. This is
         useful to avoid the overwriting of previously stored orbit data.
    struc:
        A named variable in which a strucure containing the requested
          orbit quantities can be returned.

 VERSION: @(#)get_fa_orbit.pro	1.21 02/18/02 UCB SSL
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_orbit.pro">general/missions/fast/fa_ops/get_fa_orbit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ORBIT_GEOMAG">
<H2>GET_FA_ORBIT_GEOMAG</H2></A>
<A HREF="#GET_FA_ORBIT">[Previous Routine]</A>
<A HREF="#GET_FA_ORBIT_TIMES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: get_fa_orbit_geomag(orbit)
NAME:
  get_fa_orbit_geomag
PURPOSE:
  Gets geomag data kp, ap, and dsp for given orbit.  Data are
  returned for incoming and outgoing north and south.


INPUT:  input(s) can be scalers or arrays of any dimension of type:
  integer        orbit number.

OUTPUT:
  structure: {orbit_geomag, inNorth:{geomag}, outNorth:{geomag}, 
              inSouth:{geomag}, outSouth:{geomag}}

SEE ALSO:
  what_orbit_is, get_fa_orbit_times_db, geomag

CREATED BY:	Ken Bromund  Dec 1997
FILE:  get_fa_orbit_geomag.pro
VERSION:  1.2
LAST MODIFICATION:  98/01/06
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_orbit_geomag.pro">general/missions/fast/fa_ops/get_fa_orbit_geomag.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ORBIT_TIMES">
<H2>GET_FA_ORBIT_TIMES</H2></A>
<A HREF="#GET_FA_ORBIT_GEOMAG">[Previous Routine]</A>
<A HREF="#GET_FA_ORBIT_TIMES_DB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_ORBIT_TIMES

 PURPOSE: To obtain the orbit start and stop times, in double
          precision seconds since 1970, given an orbit number. 

 CALLING SEQUENCE: if get_fa_orbit_times(1701,t0,t1) then ...
 
 INPUTS: the orbit number.

 OUTPUTS: The return value is 1 for success, 0 for failure. The times
          are returned in T0 and T1. 

 SIDE EFFECTS: A process is spawned, and the orbit almanac file is
               awked. The orbit number and times are stored, unless
               NO_STORE is set, or unless the desired times are
               already stored. 


 MODIFICATION HISTORY: Originally written by J.Rauchleiba, for
                       PLOT_FA_CROSSING, although he'll deny it. 
                       Stolen and modularized by Bill Peria,
                       27-Jan-97. 

                       Hard-coded path removed 11-March-97 BP
                       TPLOT storage added     15-April-97 BP
                       Use ORBITTIME spawn    22-July-97  BP
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_orbit_times.pro">general/missions/fast/fa_ops/get_fa_orbit_times.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_ORBIT_TIMES_DB">
<H2>GET_FA_ORBIT_TIMES_DB</H2></A>
<A HREF="#GET_FA_ORBIT_TIMES">[Previous Routine]</A>
<A HREF="#GET_FA_POTENTIAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: get_fa_orbit_times_db(orbit)
NAME:
  get_fa_orbit_times_db
PURPOSE:
  Obtains orbit start, stop, north and south pole crossing times
  from the fast_archive database given an orbit number.

INPUT:  input(s) can be scalers or arrays of any dimension of type:
  integer        orbit number.

OUTPUT:
  structure: {orbit_times, start:limits.start, finish:limits.finish, $
              north:north.time, south:south.time}

SEE ALSO:
  what_orbit_is

CREATED BY:	Ken Bromund  Dec 1997
FILE:  get_fa_orbit_times_db.pro
VERSION:  1.2
LAST MODIFICATION:  98/01/06
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_orbit_times_db.pro">general/missions/fast/fa_ops/get_fa_orbit_times_db.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_POTENTIAL">
<H2>GET_FA_POTENTIAL</H2></A>
<A HREF="#GET_FA_ORBIT_TIMES_DB">[Previous Routine]</A>
<A HREF="#GET_FA_SEB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_POTENTIAL

 PURPOSE:
    To obtain the spacecraft potential for FAST in fa_fields
 format. Calls FF_POTENTIAL to do the bulk of the work. 

 CALLING SEQUENCE: pot = get_fa_potential(time1c, time2c, NPTS=npts,
                         START=st, EN=en, PANF=pf, PANB=pb, ALL = all,
                         STORE = store, STRUCTURE = struct, SPIN = spin,
                         REPAIR = repair)  
 
 INPUTS: T1, T2: start and stop times, in seconds since 1970 or
         YYYY-MM-DD/HH:MM:SS. 
       
 KEYWORD PARAMETERS: All applicable keywords from GET_FA_FIELDS.

 OUTPUTS: If /STORE is not set set, a standard fields structure
          containing the potential in volts in COMP1 is returned. If
          STORE is set, a tplot string handle is returned.

 RESTRICTIONS: The environment variable FAST_CALIBRATE must be 1.
               Why not do the following:

                  alias fastsdt   'setenv FAST_CALIBRATE 1; sdt' 

                        in your .cshrc file? 


 EXAMPLE: pot = get_fa_potential(t1,t2)
          pdqplot,pot
          OR...
          tplot,get_fa_potential(t1,t2,/store)


 MODIFICATION HISTORY: written April '97 by Bill Peria 

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_potential.pro">general/missions/fast/fa_ops/get_fa_potential.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB">
<H2>GET_FA_SEB</H2></A>
<A HREF="#GET_FA_POTENTIAL">[Previous Routine]</A>
<A HREF="#GET_FA_SEB1">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB

 DESCRIPTION:

	function to load FAST Sesa burst combined data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb.pro	1.3 08/08/00
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '99
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb.pro">general/missions/fast/fa_ops/get_fa_seb.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB1">
<H2>GET_FA_SEB1</H2></A>
<A HREF="#GET_FA_SEB">[Previous Routine]</A>
<A HREF="#GET_FA_SEB1_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB1

 DESCRIPTION:

	function to load FAST S-esa1 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa1 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb1 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb1.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb1.pro">general/missions/fast/fa_ops/get_fa_seb1.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB1_C">
<H2>GET_FA_SEB1_C</H2></A>
<A HREF="#GET_FA_SEB1">[Previous Routine]</A>
<A HREF="#GET_FA_SEB1_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB1_C

 DESCRIPTION:


	function to load FAST S-esa1 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 1 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb1 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb1_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb1_c.pro">general/missions/fast/fa_ops/get_fa_seb1_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB1_HDR">
<H2>GET_FA_SEB1_HDR</H2></A>
<A HREF="#GET_FA_SEB1_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB1_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB1_HDR

 DESCRIPTION:

	function to load FAST S-esa1 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa1_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb1_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb1_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb1_hdr.pro">general/missions/fast/fa_ops/get_fa_seb1_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB1_TS">
<H2>GET_FA_SEB1_TS</H2></A>
<A HREF="#GET_FA_SEB1_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB1_TS

 DESCRIPTION:


	function to load FAST S-esa 1 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa1 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb1_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb1_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb1_ts.pro">general/missions/fast/fa_ops/get_fa_seb1_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB2">
<H2>GET_FA_SEB2</H2></A>
<A HREF="#GET_FA_SEB1_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB2_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB2

 DESCRIPTION:

	function to load FAST S-esa2 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa2 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb2 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb2.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb2.pro">general/missions/fast/fa_ops/get_fa_seb2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB2_C">
<H2>GET_FA_SEB2_C</H2></A>
<A HREF="#GET_FA_SEB2">[Previous Routine]</A>
<A HREF="#GET_FA_SEB2_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB2_C

 DESCRIPTION:


	function to load FAST S-esa2 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 2 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb2 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb2_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb2_c.pro">general/missions/fast/fa_ops/get_fa_seb2_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB2_HDR">
<H2>GET_FA_SEB2_HDR</H2></A>
<A HREF="#GET_FA_SEB2_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB2_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB2_HDR

 DESCRIPTION:

	function to load FAST S-esa2 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa2_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb2_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb2_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb2_hdr.pro">general/missions/fast/fa_ops/get_fa_seb2_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB2_TS">
<H2>GET_FA_SEB2_TS</H2></A>
<A HREF="#GET_FA_SEB2_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB2_TS

 DESCRIPTION:


	function to load FAST S-esa 2 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa2 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb2_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb2_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb2_ts.pro">general/missions/fast/fa_ops/get_fa_seb2_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB3">
<H2>GET_FA_SEB3</H2></A>
<A HREF="#GET_FA_SEB2_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB3_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB3

 DESCRIPTION:

	function to load FAST S-esa3 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa3 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb3 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb3.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb3.pro">general/missions/fast/fa_ops/get_fa_seb3.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB3_C">
<H2>GET_FA_SEB3_C</H2></A>
<A HREF="#GET_FA_SEB3">[Previous Routine]</A>
<A HREF="#GET_FA_SEB3_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB3_C

 DESCRIPTION:


	function to load FAST S-esa3 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 3 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb3 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb3_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb3_c.pro">general/missions/fast/fa_ops/get_fa_seb3_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB3_HDR">
<H2>GET_FA_SEB3_HDR</H2></A>
<A HREF="#GET_FA_SEB3_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB3_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB3_HDR

 DESCRIPTION:

	function to load FAST S-esa3 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa3_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb3_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb3_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb3_hdr.pro">general/missions/fast/fa_ops/get_fa_seb3_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB3_TS">
<H2>GET_FA_SEB3_TS</H2></A>
<A HREF="#GET_FA_SEB3_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB4">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB3_TS

 DESCRIPTION:


	function to load FAST S-esa 3 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa3 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb3_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb3_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb3_ts.pro">general/missions/fast/fa_ops/get_fa_seb3_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB4">
<H2>GET_FA_SEB4</H2></A>
<A HREF="#GET_FA_SEB3_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB4_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB4

 DESCRIPTION:

	function to load FAST S-esa4 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa4 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb4 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb4.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb4.pro">general/missions/fast/fa_ops/get_fa_seb4.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB4_C">
<H2>GET_FA_SEB4_C</H2></A>
<A HREF="#GET_FA_SEB4">[Previous Routine]</A>
<A HREF="#GET_FA_SEB4_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB4_C

 DESCRIPTION:


	function to load FAST S-esa4 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 4 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb4 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb4_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb4_c.pro">general/missions/fast/fa_ops/get_fa_seb4_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB4_HDR">
<H2>GET_FA_SEB4_HDR</H2></A>
<A HREF="#GET_FA_SEB4_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB4_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB4_HDR

 DESCRIPTION:

	function to load FAST S-esa4 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa4_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb4_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb4_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb4_hdr.pro">general/missions/fast/fa_ops/get_fa_seb4_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB4_TS">
<H2>GET_FA_SEB4_TS</H2></A>
<A HREF="#GET_FA_SEB4_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB5">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB4_TS

 DESCRIPTION:


	function to load FAST S-esa 4 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa4 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb4_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb4_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb4_ts.pro">general/missions/fast/fa_ops/get_fa_seb4_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB5">
<H2>GET_FA_SEB5</H2></A>
<A HREF="#GET_FA_SEB4_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB5_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB5

 DESCRIPTION:

	function to load FAST S-esa5 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa5 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb5 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb5.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb5.pro">general/missions/fast/fa_ops/get_fa_seb5.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB5_C">
<H2>GET_FA_SEB5_C</H2></A>
<A HREF="#GET_FA_SEB5">[Previous Routine]</A>
<A HREF="#GET_FA_SEB5_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB5_C

 DESCRIPTION:


	function to load FAST S-esa5 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 5 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb5 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb5_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb5_c.pro">general/missions/fast/fa_ops/get_fa_seb5_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB5_HDR">
<H2>GET_FA_SEB5_HDR</H2></A>
<A HREF="#GET_FA_SEB5_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB5_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB5_HDR

 DESCRIPTION:

	function to load FAST S-esa5 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa5_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb5_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb5_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb5_hdr.pro">general/missions/fast/fa_ops/get_fa_seb5_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB5_TS">
<H2>GET_FA_SEB5_TS</H2></A>
<A HREF="#GET_FA_SEB5_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB6">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB5_TS

 DESCRIPTION:


	function to load FAST S-esa 5 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa5 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb5_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb5_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb5_ts.pro">general/missions/fast/fa_ops/get_fa_seb5_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB6">
<H2>GET_FA_SEB6</H2></A>
<A HREF="#GET_FA_SEB5_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB6_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB6

 DESCRIPTION:

	function to load FAST S-esa6 burst data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa6 Burst'        ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_seb6 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb6.pro	1.17 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb6.pro">general/missions/fast/fa_ops/get_fa_seb6.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB6_C">
<H2>GET_FA_SEB6_C</H2></A>
<A HREF="#GET_FA_SEB6">[Previous Routine]</A>
<A HREF="#GET_FA_SEB6_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB6_C

 DESCRIPTION:


	function to load FAST S-esa6 burst data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa 6 Burst'      ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb6 (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb6_c.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb6_c.pro">general/missions/fast/fa_ops/get_fa_seb6_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB6_HDR">
<H2>GET_FA_SEB6_HDR</H2></A>
<A HREF="#GET_FA_SEB6_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB6_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB6_HDR

 DESCRIPTION:

	function to load FAST S-esa6 burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa6_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb6_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb6_hdr.pro	1.9 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb6_hdr.pro">general/missions/fast/fa_ops/get_fa_seb6_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB6_TS">
<H2>GET_FA_SEB6_TS</H2></A>
<A HREF="#GET_FA_SEB6_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SEB_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB6_TS

 DESCRIPTION:


	function to load FAST S-esa 6 burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa6 Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_seb6_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb6_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb6_ts.pro">general/missions/fast/fa_ops/get_fa_seb6_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB_C">
<H2>GET_FA_SEB_C</H2></A>
<A HREF="#GET_FA_SEB6_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SEB_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB_C

 DESCRIPTION:


	function to load FAST Sesa burst combined data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa Burst Combined'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_seb (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb_c.pro	1.2 08/30/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb_c.pro">general/missions/fast/fa_ops/get_fa_seb_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB_HDR">
<H2>GET_FA_SEB_HDR</H2></A>
<A HREF="#GET_FA_SEB_C">[Previous Routine]</A>
<A HREF="#GET_FA_SEB_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SEB_HDR

 DESCRIPTION:

	function to load FAST S-esa burst combined header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa_Cmb_Burst_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'eiesa_unpack_hdr' ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(268)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_seb_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb_hdr.pro	1.1 08/26/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '99
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb_hdr.pro">general/missions/fast/fa_ops/get_fa_seb_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SEB_TS">
<H2>GET_FA_SEB_TS</H2></A>
<A HREF="#GET_FA_SEB_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_EES_TS

 DESCRIPTION:


	function to load FAST E-esa Burst data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa Burst'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_ees_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_seb_ts.pro	1.1 08/26/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '99
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_seb_ts.pro">general/missions/fast/fa_ops/get_fa_seb_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SES">
<H2>GET_FA_SES</H2></A>
<A HREF="#GET_FA_SEB_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SES_C">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SES

 DESCRIPTION:

	function to load FAST S-esa survey data from the SDT program shared
	memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      idx		       ; Index into sdt data
	
 CALLING SEQUENCE:

 	data = get_fa_ses (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

       INDEX                   Index into sdt data

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ses.pro	1.21 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ses.pro">general/missions/fast/fa_ops/get_fa_ses.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SES_C">
<H2>GET_FA_SES_C</H2></A>
<A HREF="#GET_FA_SES">[Previous Routine]</A>
<A HREF="#GET_FA_SES_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SES_C

 DESCRIPTION:


	function to load FAST S-esa survey data from the SDT program shared
	memory buffers.  This is the caching version

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Sesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nnrgs, nbins) ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers
	
 CALLING SEQUENCE:

 	data = get_fa_ses (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat], CALIB=calib,
				INDEX=idx, FLUSH=flush, CACHE_SIZE=cache_size)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time or index input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time or index input

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	INDEX			If index is set, it is used for selecting
				the index to get data.

	FLUSH			If non-zero, will flush the data cache
				This is useful to force a re-read of sdt
				buffers in case the data has changed.

	CACHE_SIZE		If gt 0, will reset the length in points
				of data to cache.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ses_c.pro	1.4 10/08/99
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

	Major upgrade, using get_cache_md_from_sdt to load a time range
	at once to cache data in idl for speedup.   J.M. Loran Apr. 97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ses_c.pro">general/missions/fast/fa_ops/get_fa_ses_c.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SES_HDR">
<H2>GET_FA_SES_HDR</H2></A>
<A HREF="#GET_FA_SES_C">[Previous Routine]</A>
<A HREF="#GET_FA_SES_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SES_HDR

 DESCRIPTION:

	function to load FAST S-esa survey header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Sesa_Survey_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING 'sesa_unpack_hdr'  ; Name of proc to
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG	   idx		       ; index into data
	   
	
 CALLING SEQUENCE:

 	data = get_fa_ses_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ses_hdr.pro	1.10 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ses_hdr.pro">general/missions/fast/fa_ops/get_fa_ses_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SES_TS">
<H2>GET_FA_SES_TS</H2></A>
<A HREF="#GET_FA_SES_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_SPIN_RATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_SES_TS

 DESCRIPTION:


	function to load FAST S-esa survey data from the SDT program shared
	memory buffers.  This is the time series version.  

	An array of npts structures of the following format are returned:

	   DATA_NAME     STRING    'Sesa Survey'       ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000625            ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   INDEX         LONG      index               ; Data index, this pt. 
	   ST_INDEX      LONG      st_idx              ; start index of arr
	   EN_INDEX      LONG      en_idx              ; end index of arr
	   NPTS          LONG      npts                ; array size
	
 CALLING SEQUENCE:
	data = get_fa_ses_ts (t1, t2, [NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx], 
				CALIB=calib)
 ARGUMENTS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

 KEYWORDS:

	CALIB			If non-zero, caclulate geometry
				factors for each bin instead of using 1.'s

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_ses_ts.pro	1.3 05/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_ses_ts.pro">general/missions/fast/fa_ops/get_fa_ses_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SPIN_RATE">
<H2>GET_FA_SPIN_RATE</H2></A>
<A HREF="#GET_FA_SES_TS">[Previous Routine]</A>
<A HREF="#GET_FA_SUNNADIR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_SPIN_RATE

 PURPOSE: Computes the spin rate and phase (sun).

 CATEGORY: attitude, despinning

 CALLING SEQUENCE: wspin = get_fa_spin_rate(tmag,mag)
                    by default, a single number estimate of the spin
                    rate is returned. It's not very precise, but
                    may be ok for some things.  
 
 INPUTS: TMAG : the time column for the magnetometer data being used
         to estimate spin rate. Must be in seconds since 1970 if
         /PRECISE is set, for compatibility with FAST spin/mag phase
         quantities.

         MAG: the mag data. I generally use Mag3dc. If you don't pass
              in any mag data, the program attempts to load it from
              SDT. 
	
 KEYWORD PARAMETERS: PRECISE: if set, then the spin phase quantity
                     (dqd is SMPhase_FieldsSurvey0) is extracted and
                     used in conjunction with the MAG data to
                     determine spin rate. An array of spin rates
                     (w.r.t. the sun line) is returned. 

                     ONE_ONLY: same as default. Inhibits PRECISE. 

                     PHASE: a named variable in which the spin phase
                            is returned. By default, w.r.t. sun
                            line. 

 OUTPUTS: wspin : the spin rate, either crude or precise w.r.t. the sun.

 OPTIONAL OUTPUTS: PHASE: w.r.t. sun, through keyword. 

 SIDE EFFECTS: if PRECISE  is set, spin phase quantities are
               extracted from SDT.

 RESTRICTIONS: Need SDT running, with spin phase and mag data loaded,
               if PRECISE is set or mag data is not passed in.


 MODIFICATION HISTORY: written in October of 1996 by Bill Peria, UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_spin_rate.pro">general/missions/fast/fa_ops/get_fa_spin_rate.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_SUNNADIR">
<H2>GET_FA_SUNNADIR</H2></A>
<A HREF="#GET_FA_SPIN_RATE">[Previous Routine]</A>
<A HREF="#GET_FA_TBA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: get_fa_sunnadir

 PURPOSE:
	For the FAST satellite, calculates the the simulated sun pulse
	from earth horizon crossings and spin period.  

 CALLING SEQUENCE:
	simSunpulseArr = get_fa_sunnadir(times, horizCrossings,   $
			period, GOOD_INDICES=gi)
 
 INPUTS:
	times: 		Array of time tags that apply to the other
       		input arrays.
	horizCrossings:	An array the same size as times, of structures
			{setime: double, estime: double} where setime
                       is the space earth horizon crossing time, and
                       estime is the earth space horizon crossing
                       time.
	period:		Period of one spin of the spacecraft in seconds.

 KEYWORD PARAMETERS:
 	GOOD_INDICES:	This will give the indices that contain good
		 	data that were used from the calling args.

 OUTPUTS:
	simSunpulseArr:	This is the returned array of simulated
			sun pulse times, one array element for each
			input time given in the times parameter.

 MODIFICATION HISTORY:
	@(#)get_fa_sunnadir.pro	1.1 02/12/98
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Oct '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_sunnadir.pro">general/missions/fast/fa_ops/get_fa_sunnadir.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBA">
<H2>GET_FA_TBA</H2></A>
<A HREF="#GET_FA_SUNNADIR">[Previous Routine]</A>
<A HREF="#GET_FA_TBALL_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBA

 DESCRIPTION:


	function to load FAST Teams burst He++ species data from the
	SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0207261           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tba (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tba.pro	1.14 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

 MODIFICATION HISTORY:
		     eff added by Li Tang 1/1/97   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
		     spin_fract added
		     7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tba.pro">general/missions/fast/fa_ops/get_fa_tba.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBALL_TS">
<H2>GET_FA_TBALL_TS</H2></A>
<A HREF="#GET_FA_TBA">[Previous Routine]</A>
<A HREF="#GET_FA_TBA_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
	GET_FA_TBALL_TS

 DESCRIPTION:

	Function to load a time sequence of FAST Teams burst data for all species from the
	SDT program shared memory buffers.

	The philosophy for the number of array dimensions is to keep them to a minimum,
	   except that duplication of measurement parameters over npts (the number of 2-d distributions)
	   takes place in as far as required for consistency with get_md_ts_from_sdt, which
	   has min1,max1 etc duplicated npts times.
	   This is not necessarily consistent with Loran/McFadden, where duplication seems a bit out of
	   control and without simple rules.

	A structure of the following format is returned:
	   (Note: 1.  nnrgs=nenergy; nnrgs is retained because of frequent use in other software.
	          2.  &quot;2-d distribution&quot; refers to a single data sample taken from 16 sectors in a plane
	                and at 48 energies.)
	          3.  The &quot;look&quot; or &quot;boresight&quot; direction can be computed from quantities below,
	                but remember that ion direction vector is opposite to look direction.)  

	   DATA_NAME     STRING    'Tms Burst All'  ; Data Quantity name
	   VALID         INT       1                ; Data valid flag
	   PROJECT_NAME  STRING    'FAST'           ; project name
	   UNITS_NAME    STRING    'Counts'         ; Units of this data
	   UNITS_PROCEDURE  STRING 'proc'           ; Units conversion proc
	   TIMES         DOUBLE    Array(npts)      ; Start Time of sample (should be true time of
                                               ; start of data, not original packet time tag
	   END_TIMES     DOUBLE    Array(npts)      ; End time of sample
	   INTEG_T       DOUBLE    Array(npts)      ; Integration time for each individual energy step
                                               ; (dat.endTimes-dat.times)/dat.dimsizes(0)
	   NBINS         INT       nbins            ; Number of angle bins  (16)
	   NENERGY       INT       nnrgs            ; Number of energy bins  (48)
	   NPTS          INT       npts             ; number of data 'points' = # of 2d distributions
	   CALIBRATED    INT       calibrated       ; flags calibrated data      mb
	   CALIBRATED_UNITS STRING units            ; calibrated units string    mb 
	   DATA          FLOAT     Array(nnrgs, nbins, nspec,npts) 
                             ; Data quantities; nspec=4, may require wrk to change
	   ENERGY        FLOAT     Array(nnrgs,npts)   ; Ion energy, duplicated npts times (ev)
	   THETA         FLOAT     Array(nbins,npts)   ; Angle of sector, duplicated npts times (deg)
	   THETA_FOV     FLOAT     Array(nbins,npts)   ; Angle of sector, duplicated npts times (deg),
                         ; Measured ccw from between bins 3 and 4 (0-15 range) in detector plane
                         ; For a diagram see FAST/TEAMS Fields-of-View, D.M. Klumpar, May, 1995
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, npts)       ; Width of energy bins (ev)
	   DTHETA        FLOAT     Array(nbins,npts)        ; Delta Theta acceptance width, roughly
                                                       ; actually separation between sectors
	   EFF           FLOAT     Array(nnrgs,nbins=16,nspec=4)        ; Efficiency (GF)
	   SPIN_FRACT    FLOAT     Array(nbins)  ; fraction of dat.time-dat.end_time
                                            ; over which the measurement was active
	   MODE          BYTE      Array(npts)   ; teams mode for each time
	   SPHASE        INT       Array(npts)   ; spin phase wrt sun, corrected to dat.times 
                            ; (start-of-acquisition) within this program (as of July 30 1997 mb)
; (the original sphase in header_bytes is from the data read time, not the actual data acquisition time) 
	   SNUMBER       BYTE      Array(npts)   ; spin number
	   MAGDIR        FLOAT     Array(npts)   ; phase of sun wrt magfld 0 crossing, 0-4095 range,
                                            ; S/C Y component of field, -/+ crossing                                                                                
	   MASS          FLOAT     0.0104389 *[16.,1.,4.,2.]  ; Mass eV/(km/sec)^2 (actually mass/(charge/e))
	   GEOMFACTOR    FLOAT     .0015  ; Bin GF
	   HEADER_BYTES  BYTE      Array(44,npts) ; Header bytes; 44 was 25. don't know why, changed, mb
                                             ; 3 sets of 14 with 2 additional bytes (L. Kistler)
	   HDR_TIME      FLOAT     Array(npts)    ; added to allow timing cross-checks at higher level
     ; these are explicitly the times attached to sphase in the header (which are still wrong, being the
    ; times corrected for the data, not the original times correct for sphase) mb july 29 1997
	   EFF_VERSION                            ; version number returned by FA_TTOF_CALIBRATION 

 CALLING SEQUENCE:

 	data = get_fa_tball_ts (inputTime,endtime, [START=start | EN=en | NPTS=npts | /PANF | /PANB
                          | /ALL | IDXST=idxst)
 ARGUMENTS:

	inputTime   This argument gives a time handle from which
	            to start to take data.  It may be either a string
	            with the following possible formats:
	                'YY-MM-DD/HH:MM:SS.MSC'  or
	                'HH:MM:SS'     (use reference date)
	            or a number, which will represent seconds
	            since 1970 (must be a double &gt; 94608000.D), or
	            a hours from a reference time, if set.
	            time will always be returned as a double
	            representing the actual data time found in
	            seconds since 1970.

	endtime     similar, ending time of data interval

 KEYWORDS:

	START       If non-zero, get data from the start time
	            of the data instance in the SDT buffers

	NPTS        If given will determine the number of 2-D distributions to get,
	                           overriding the endTime specification

	EN          If non-zero, get data at the end time
	            of the data instance in the SDT buffers

	PANF, PANB  Untested. Meant to override other timing specifications, pan forward or backward

	ALL         Untested. get all data, meant to override other time specs.

	IDXST       Untested. get data at a certain index relative to start of TIMESPAN.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tba.pro	1.8 09/04/96
	Originally written by Jonathan M. Loran,  University of
	California at Berkeley, Space Sciences Lab.   June '95
	Modified to get_fa_tball by M Boehm may 14 1997. Untested.
	LAST MODIFICATION:  Modified to get_fa_tball_ts by M Boehm may 28 1997. Tested with a few orbits
	   only. HDR_TIME returned separately largely for error checking purposes july 11. Note
	   that most other error checking from get_fa_tb* has been removed, due to the fact
	   that I couldn't figure out when most of it would apply.
	Last minor (hopefully not functional) mods July 15, 1997 mb
	Added theta_fov and documentation, July 17, 1997, ESC.
       Comment-olny changes July 24 mb.
       tempw added (line ~162) to avoid where()=-1 problem ~nov 24 1997 mb
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tball_ts.pro">general/missions/fast/fa_ops/get_fa_tball_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBA_3D">
<H2>GET_FA_TBA_3D</H2></A>
<A HREF="#GET_FA_TBALL_TS">[Previous Routine]</A>
<A HREF="#GET_FA_TBA_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBH_3D

 DESCRIPTION:


	function to load FAST Teams burst He++ species data from 
	the call of routine get_fa_tba_eq to generate a 3D data.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     ARRAY(nbins)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   EFF           FLOAT     Array(nnrgs,nbins)  ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0		       ; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tba_3d (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.


 CREATED BY:
		 Li Tang   1/1/97      University of New Hampshire
				       Space Physics Lab
					tang@teams.sr.unh.edu
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tba_3d.pro">general/missions/fast/fa_ops/get_fa_tba_3d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBA_EQ">
<H2>GET_FA_TBA_EQ</H2></A>
<A HREF="#GET_FA_TBA_3D">[Previous Routine]</A>
<A HREF="#GET_FA_TBH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBA_EQ

 DESCRIPTION:


	function to load FAST Teams burst alpha species equator data 
         from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   SPBIN	 INT	   		       ; Spin phase bin
	   MODE	  	 INT				; TEAMS Instrument mode
	   MAGDIR	 FLOAT				; Mag direction
	   EFF           FLOAT     Array(nnrgs)         ; Efficiency (GF)
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	   MASS          DOUBLE    0.0208778           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tba_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 

	
 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
		 7/18/97  updated spin phase correction	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tba_eq.pro">general/missions/fast/fa_ops/get_fa_tba_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBH">
<H2>GET_FA_TBH</H2></A>
<A HREF="#GET_FA_TBA_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TBH_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBH

 DESCRIPTION:


	function to load FAST Teams burst He+ species data from the
	SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Helium'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0417556           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbh (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tbh.pro	1.14 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

 MODIFICATION HISTORY:
 		     eff added by Li Tang 1/1/97   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
		     spin_fract added
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbh.pro">general/missions/fast/fa_ops/get_fa_tbh.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBH_3D">
<H2>GET_FA_TBH_3D</H2></A>
<A HREF="#GET_FA_TBH">[Previous Routine]</A>
<A HREF="#GET_FA_TBH_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBH_3D

 DESCRIPTION:


	function to load FAST Teams burst He+ species data from 
	the call of routine get_fa_tbh_eq to generate a 3D data.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Helium'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     ARRAY(nbins)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   EFF           FLOAT     Array(nnrgs,nbins)  ; Efficiency (GF)
	   MASS          DOUBLE    0.0417556           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0		       ; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tbh_3d (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.


 CREATED BY:
		 Li Tang   1/1/97      University of New Hampshire
				       Space Physics Lab
					tang@teams.sr.unh.edu
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbh_3d.pro">general/missions/fast/fa_ops/get_fa_tbh_3d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBH_EQ">
<H2>GET_FA_TBH_EQ</H2></A>
<A HREF="#GET_FA_TBH_3D">[Previous Routine]</A>
<A HREF="#GET_FA_TBO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBH_EQ

 DESCRIPTION:


	function to load FAST Teams burst helium species equator data 
         from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Helium'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   SPBIN	 INT	   		       ; Spin phase bin
	   MODE	  	 INT				; TEAMS Instrument mode
	   MAGDIR	 FLOAT				; Mag direction
	   EFF           FLOAT     Array(nnrgs)         ; Efficiency (GF)
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	   MASS          DOUBLE    0.0417556           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbh_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 

	
 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
		 7/18/97  updated spin phase correction	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbh_eq.pro">general/missions/fast/fa_ops/get_fa_tbh_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBO">
<H2>GET_FA_TBO</H2></A>
<A HREF="#GET_FA_TBH_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TBO_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBO

 DESCRIPTION:


	function to load FAST Teams burst O+ species data from the
	SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Oxygen'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.1670224           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbo (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tbo.pro	1.13 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

LAST MODIFICATION:  eff added by Li Tang 11/21/96   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
		     spin_fract added
		     7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbo.pro">general/missions/fast/fa_ops/get_fa_tbo.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBO_3D">
<H2>GET_FA_TBO_3D</H2></A>
<A HREF="#GET_FA_TBO">[Previous Routine]</A>
<A HREF="#GET_FA_TBO_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBO_3D

 DESCRIPTION:


	function to load FAST Teams burst O+ species data from 
	the call of routine get_fa_tbo_eq to generate a 3D data.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Oxygen'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     ARRAY(nbins)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   EFF           FLOAT     Array(nnrgs,nbins)  ; Efficiency (GF)
	   MASS          DOUBLE    0.1670224           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0		       ; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tbo_3d (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.


 CREATED BY:
		 Li Tang   1/1/97      University of New Hampshire
				       Space Physics Lab
					tang@teams.sr.unh.edu
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbo_3d.pro">general/missions/fast/fa_ops/get_fa_tbo_3d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBO_EQ">
<H2>GET_FA_TBO_EQ</H2></A>
<A HREF="#GET_FA_TBO_3D">[Previous Routine]</A>
<A HREF="#GET_FA_TBP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBO_EQ

 DESCRIPTION:


	function to load FAST Teams burst oxygen species equator data 
         from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Oxygen'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   SPBIN	 INT	   		       ; Spin phase bin
	   MODE	  	 INT				; TEAMS Instrument mode
	   MAGDIR	 FLOAT				; Mag direction
	   EFF           FLOAT     Array(nnrgs)         ; Efficiency (GF)
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	   MASS          DOUBLE    0.1670224           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbo_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 

	
 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
		 7/18/97  updated spin phase correction	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbo_eq.pro">general/missions/fast/fa_ops/get_fa_tbo_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBP">
<H2>GET_FA_TBP</H2></A>
<A HREF="#GET_FA_TBO_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TBP_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBP

 DESCRIPTION:


	function to load FAST Teams burst H+ species data from the
	SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Proton'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tbp.pro	1.14 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

LAST MODIFICATION:  eff added by Li Tang 11/21/96   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
		     spin_fract added
		     7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbp.pro">general/missions/fast/fa_ops/get_fa_tbp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBP_3D">
<H2>GET_FA_TBP_3D</H2></A>
<A HREF="#GET_FA_TBP">[Previous Routine]</A>
<A HREF="#GET_FA_TBP_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBP_3D

 DESCRIPTION:


	function to load FAST Teams burst H+ species data from 
	the call of routine get_fa_tbp_eq to generate a 3D data.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Proton'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     ARRAY(nbins)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   EFF           FLOAT     Array(nnrgs,nbins)  ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0		       ; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tbp_3d (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.


 CREATED BY:
		 Li Tang   1/1/97      University of New Hampshire
				       Space Physics Lab
					tang@teams.sr.unh.edu
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbp_3d.pro">general/missions/fast/fa_ops/get_fa_tbp_3d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TBP_EQ">
<H2>GET_FA_TBP_EQ</H2></A>
<A HREF="#GET_FA_TBP_3D">[Previous Routine]</A>
<A HREF="#GET_FA_TB_3D_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TBP_EQ

 DESCRIPTION:


	function to load FAST Teams burst proton species equator data 
         from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Proton'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   SPBIN	 INT	   		       ; Spin phase bin
	   MODE	  	 INT				; TEAMS Instrument mode
	   MAGDIR	 FLOAT				; Mag direction
	   EFF           FLOAT     Array(nnrgs)         ; Efficiency (GF)
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tbp_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 

	
 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
		 7/18/97  updated spin phase correction	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tbp_eq.pro">general/missions/fast/fa_ops/get_fa_tbp_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TB_3D_EQ">
<H2>GET_FA_TB_3D_EQ</H2></A>
<A HREF="#GET_FA_TBP_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TB_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TB_3D_EQ

 DESCRIPTION:


	function to load FAST Teams burst H+, O+, He++, He+ species data from 
	the call of routine get_fa_tb_eq to generate a 3D data in instrument
	equatorial plane.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst Data'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins,mbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   EFF           FLOAT     Array(nnrgs,nbins,mbins)  ; Efficiency (GF)
	   MASS          DOUBLE    ARRAY(4)            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0		       ; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tb_3d_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.


 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MOD. HISTORY:	
		7/25/97	 recalculated pitch angle	LT
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tb_3d_eq.pro">general/missions/fast/fa_ops/get_fa_tb_3d_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TB_EQ">
<H2>GET_FA_TB_EQ</H2></A>
<A HREF="#GET_FA_TB_3D_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TB_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TB_EQ

 DESCRIPTION:


	function to load FAST Teams burst 4 species equator data 
         from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Burst PAHO'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins,4) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   SPBIN	 INT	   		       ; Spin phase bin
	   MODE	  	 INT				; TEAMS Instrument mode
	   MAGDIR	 FLOAT				; Mag direction
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tba_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 

	
 CREATED BY:
		 Li Tang   11/2/96      University of New Hampshire
					Space Physics Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
		 7/18/97  debubbed spin phase correction	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tb_eq.pro">general/missions/fast/fa_ops/get_fa_tb_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TB_HDR">
<H2>GET_FA_TB_HDR</H2></A>
<A HREF="#GET_FA_TB_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TB_HDR

 DESCRIPTION:

	function to load FAST TEAMS burst header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_Burst_Packet_Hdr' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_tb_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tb_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tb_hdr.pro">general/missions/fast/fa_ops/get_fa_tb_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TH">
<H2>GET_FA_TH</H2></A>
<A HREF="#GET_FA_TB_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TH_3D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TH

 DESCRIPTION:


	function to load FAST Teams HiMass data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms HiMass Bin:N'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Theta angle for bins
	   PHI           FLOAT     Array(nnrgs, nbins) ; Phi angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DPHI          FLOAT     Array(nbins)        ; Delta Phi
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(4)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    mass                ; mean bin Mass in
						       ;    eV/(km/sec)^2
	   DMASS         DOUBLE    dmass               ; mass bin width in
						       ;    eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    1.                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes

 	The bin number selected will be returned as part of the DATA_NAME
	string.

 CALLING SEQUENCE:

 	data = get_fa_th (time, bin, [START=start | EN=en |
				ADVANCE = advance | RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_th.pro	1.19 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_th.pro">general/missions/fast/fa_ops/get_fa_th.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TH_3D">
<H2>GET_FA_TH_3D</H2></A>
<A HREF="#GET_FA_TH">[Previous Routine]</A>
<A HREF="#GET_FA_TH_3D_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TH_3D

 DESCRIPTION:


	function to load FAST Teams HiMass data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	DATA_NAME     STRING    'Tms HiMass Bin:N'; Data Quantity name
       VALID         INT       1                  	 ; Data valid flag
 	PROJECT_NAME  STRING    'FAST'             	 ; project name
 	UNITS_NAME    STRING    'Counts'           	 ; Units of this data
 	UNITS_PROCEDURE  STRING 'proc'             	 ; Units conversion proc
	TIME          DOUBLE    8.0118726e+08      	 ; Start Time of sample
 	END_TIME      DOUBLE    7.9850884e+08      	 ; End time of sample
	INTEG_T       DOUBLE    3.0000000          	 ; Integration time
	NBINS         INT       nbins               	 ; Number of angle bins
	NENERGY       INT       nnrgs             	 ; Number of energy bins
 	NBINS	      INT	mbins		    	 ; Number of mass bins
	DATA          FLOAT     Array(nnrgs, nbins,mbins) ; Data qauantities
	ENERGY        FLOAT     Array(nnrgs, nbins) 	  ; Energy steps
	THETA         FLOAT     Array(nnrgs, nbins) 	  ; Theta angle for bins
	PHI           FLOAT     Array(nnrgs, nbins) 	  ; Phi angle for bins
	GEOM          FLOAT     Array(nnrgs, nbins)	  ; Geometry factor
	DENERGY       FLOAT     Array(nnrgs, nbins)	  ; Energies for bins
	DTHETA        FLOAT     Array(nbins)        	  ; Delta Theta
	DPHI          FLOAT     Array(nbins)        	  ; Delta Phi
	DOMEGA        FLOAT     Array(nbins, nbins)	  ;Solid angle for bins
	PT_LIMITS     FLOAT     Array(2)            	  ;Mass min/max limits
	EFF           FLOAT     Array(nnrgs, nbins)	  ; Efficiency (GF)
	MASS          FLOAT     Array(nnrgs, mbins)	  ; mean bin Mass in
		  			       	   	   ;   mass unit
	DMASS         FLOAT     Array(mbins)	   	   ; mass bin width in
		 			           	   ;   mass unit
	GEOMFACTOR    DOUBLE    0.0015              	   ; Bin GF
	SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins)	   ; Spin fraction of 
							   ; angles
	HEADER_BYTES  BYTE      Array(226)	       	   ; Header bytes

 	The bin number selected will be returned as part of the DATA_NAME
	string.

 CALLING SEQUENCE:

 	data = get_fa_th_3d (time, [START=start | EN=en |
				ADVANCE = advance | RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Made from get_fa_th.pro	1.13 12 Jul 1996
	Last modification: 8/20/96   Li Tang   Univ. of New Hampshire
					       Space Physcis Lab
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_th_3d.pro">general/missions/fast/fa_ops/get_fa_th_3d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TH_3D_EQ">
<H2>GET_FA_TH_3D_EQ</H2></A>
<A HREF="#GET_FA_TH_3D">[Previous Routine]</A>
<A HREF="#GET_FA_TH_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TH_3D_EQ

 DESCRIPTION:


	function to get FAST Teams survey He++ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_th_3d_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:   8/21/96    Li Tang	University of New Hampshire, 
						Space Physics Lab
	         
 MODIFICATION HISTORY:
		 7/15/97  Keyword CALIB added	L.Tang
		 7/15/97  domega removed	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_th_3d_eq.pro">general/missions/fast/fa_ops/get_fa_th_3d_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TH_HDR">
<H2>GET_FA_TH_HDR</H2></A>
<A HREF="#GET_FA_TH_3D_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TPA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TH_HDR

 DESCRIPTION:

	function to load FAST TEAMS hiMass header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_HiMass_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_th_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_th_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_th_hdr.pro">general/missions/fast/fa_ops/get_fa_th_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPA">
<H2>GET_FA_TPA</H2></A>
<A HREF="#GET_FA_TH_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TPAH_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPA

 DESCRIPTION:


	function to load FAST Teams pole He++ species data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Pole Alpha'   ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   MASS          DOUBLE    0.0414521           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    .0015               ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tpa (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tpa.pro	1.14 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

 LAST MODIFICATION:	11/15/96  Li Tang 	Univ. of New Hampshire
						tang@teams.sr.unh.edu
			eff, spin_fract added
			geom changed to array(nngrs,nbins)
			units_procedure changed to 'convert_tms_units'
			7/15/97  KEYWORD CALIB added
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tpa.pro">general/missions/fast/fa_ops/get_fa_tpa.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPAH_HDR">
<H2>GET_FA_TPAH_HDR</H2></A>
<A HREF="#GET_FA_TPA">[Previous Routine]</A>
<A HREF="#GET_FA_TPH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPAH_HDR

 DESCRIPTION:

	function to load FAST TEAMS He pole header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_He_Pole_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_tpah_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tpah_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tpah_hdr.pro">general/missions/fast/fa_ops/get_fa_tpah_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPH">
<H2>GET_FA_TPH</H2></A>
<A HREF="#GET_FA_TPAH_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TPO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPH

 DESCRIPTION:


	function to load FAST Teams pole He+ species data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Pole Helium'   ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   MASS          DOUBLE    0.0414521           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    .0015               ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tph (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tph.pro	1.14 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

 LAST MODIFICATION:	11/15/96  Li Tang 	Univ. of New Hampshire
						tang@teams.sr.unh.edu
			eff, spin_fract added
			geom changed to array(nngrs,nbins)
			units_procedure changed to 'convert_tms_units'
			7/15/97  KEYWORD CALIB added
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tph.pro">general/missions/fast/fa_ops/get_fa_tph.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPO">
<H2>GET_FA_TPO</H2></A>
<A HREF="#GET_FA_TPH">[Previous Routine]</A>
<A HREF="#GET_FA_TPOP_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPO

 DESCRIPTION:


	function to load FAST Teams pole Oxygen species data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Pole Oxygen'   ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nngrs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tpo (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tpo.pro	1.13 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

LAST MODIFICATION:  eff added by Li Tang 11/11/96   Univ. of New Hampshire
		     spin_fract added
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
			7/15/97  KEYWORD CALIB added, LT
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tpo.pro">general/missions/fast/fa_ops/get_fa_tpo.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPOP_HDR">
<H2>GET_FA_TPOP_HDR</H2></A>
<A HREF="#GET_FA_TPO">[Previous Routine]</A>
<A HREF="#GET_FA_TPP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPOP_HDR

 DESCRIPTION:

	function to load FAST TEAMS HO pole header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_HO_Pole_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_tpop_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tpop_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tpop_hdr.pro">general/missions/fast/fa_ops/get_fa_tpop_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TPP">
<H2>GET_FA_TPP</H2></A>
<A HREF="#GET_FA_TPOP_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TSA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TPP

 DESCRIPTION:


	function to load FAST Teams pole proton species data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Pole Proton'   ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nngrs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   SPIN_FRACT    FLOAT     ARRAY(nnrgs, nbins) ; Spin fraction of angles
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	   EFF_VERSION   FLOAT	   1.0			; Eff. calibration vers.
	
 CALLING SEQUENCE:

 	data = get_fa_tpp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tpp.pro	1.13 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

 LAST MODIFICATION:	11/15/96  Li Tang 	Univ. of New Hampshire
						tang@teams.sr.unh.edu
			eff, spin_fract, added
			geom changed to array(nngrs,nbins)
			units_procedure changed to 'convert_tms_units'
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tpp.pro">general/missions/fast/fa_ops/get_fa_tpp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSA">
<H2>GET_FA_TSA</H2></A>
<A HREF="#GET_FA_TPP">[Previous Routine]</A>
<A HREF="#GET_FA_TSAH_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSA

 DESCRIPTION:


	function to load FAST Teams survey Alpha (He++) species data from the
	SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Theta angle for bins
	   PHI           FLOAT     Array(nnrgs, nbins) ; Phi angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DPHI          FLOAT     Array(nbins)        ; Delta Phi
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(4)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs,nbins)  ; Efficiency (GF)
	   MASS          DOUBLE    0.0207261           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(25)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tsa (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tsa.pro	1.20 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

LAST MODIFICATION:  eff added by Li Tang 10/21/96   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
		     geom(nnrgs, nbins)
		     7/15/97  keyword CALIB added 	L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsa.pro">general/missions/fast/fa_ops/get_fa_tsa.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSAH_HDR">
<H2>GET_FA_TSAH_HDR</H2></A>
<A HREF="#GET_FA_TSA">[Previous Routine]</A>
<A HREF="#GET_FA_TSA_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSAH_HDR

 DESCRIPTION:

	function to load FAST TEAMS He survey header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_He_Survey_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_tsah_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tsah_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsah_hdr.pro">general/missions/fast/fa_ops/get_fa_tsah_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSA_EQ">
<H2>GET_FA_TSA_EQ</H2></A>
<A HREF="#GET_FA_TSAH_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TSH_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSA_EQ

 DESCRIPTION:


	function to get FAST Teams survey He++ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Alpha'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tsa_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang		  University of New Hampshire, 
						  Space Physics Lab
       Last modification:    8/21/96.
		     7/15/97  keyword CALIB added 	L.Tang
		     domega removed			L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsa_eq.pro">general/missions/fast/fa_ops/get_fa_tsa_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSH_EQ">
<H2>GET_FA_TSH_EQ</H2></A>
<A HREF="#GET_FA_TSA_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TSOP_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSH_EQ

 DESCRIPTION:


	function to get FAST Teams survey He+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Helium'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tsh_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang		  University of New Hampshire, 
						  Space Physics Lab
       Last modification:    8/21/96.
		     7/15/97  keyword CALIB added 	L.Tang
		     domega removed			L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsh_eq.pro">general/missions/fast/fa_ops/get_fa_tsh_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSOP_HDR">
<H2>GET_FA_TSOP_HDR</H2></A>
<A HREF="#GET_FA_TSH_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TSO_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSOP_HDR

 DESCRIPTION:

	function to load FAST TEAMS HO survey header data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING 'Tms_HO_Survey_Packet_Hdr'; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; Project name
 	   UNITS_NAME    STRING    'Raw'               ; Units of this data
 	   VALUES_PROCEDURE  STRING '&lt;NONE&gt;'           ; Name of proc to
						       ; (Not implemeted)
                                                      ; get values from hdr
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   BYTES         BYTE      Array(86)	       ; Header bytes
	   
	
 CALLING SEQUENCE:

 	data = get_fa_tsop_hdr (time)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tsop_hdr.pro	1.3 12 Jul 1996
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsop_hdr.pro">general/missions/fast/fa_ops/get_fa_tsop_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSO_EQ">
<H2>GET_FA_TSO_EQ</H2></A>
<A HREF="#GET_FA_TSOP_HDR">[Previous Routine]</A>
<A HREF="#GET_FA_TSO_EQ_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSO_EQ

 DESCRIPTION:


	function to get FAST Teams survey O+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Oxygen' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tso_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang		  University of New Hampshire, 
						  Space Physics Lab
       Last modification:    8/21/96.
		     7/15/97  keyword CALIB added 	L.Tang
		     domega removed			L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tso_eq.pro">general/missions/fast/fa_ops/get_fa_tso_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSO_EQ_SP">
<H2>GET_FA_TSO_EQ_SP</H2></A>
<A HREF="#GET_FA_TSO_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TSO_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSO_EQ_SP

 DESCRIPTION:


	function to get FAST Teams survey O+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data. The difference of this routine from 
	GET_FA_TSO_EQ.PRO is that this routine generates one spin 
	resolution data when in TEAMS mode 6 and 7.
	

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Oxygen' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tso_eq_sp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input


 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang	9/17/96	  University of New Hampshire, 
						  Space Physics Lab
       Last modification: 
		     7/15/97  keyword CALIB added 	L.Tang
		              domega removed		L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tso_eq_sp.pro">general/missions/fast/fa_ops/get_fa_tso_eq_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSO_SP">
<H2>GET_FA_TSO_SP</H2></A>
<A HREF="#GET_FA_TSO_EQ_SP">[Previous Routine]</A>
<A HREF="#GET_FA_TSP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSO_SP

 DESCRIPTION:


	function to get FAST Teams survey O+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data. The difference of this routine from 
	GET_FA_TSO.PRO is that this routine generates one spin 
	resolution data when in TEAMS mode 6 and 7.
	

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Oxygen' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.165695            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tso_sp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input


 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:	Eric Lund 2000-05-10	University of New Hampshire, 
						Space Physics Lab
	Based On:	get_fa_tso_eq_sp by Li Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tso_sp.pro">general/missions/fast/fa_ops/get_fa_tso_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSP">
<H2>GET_FA_TSP</H2></A>
<A HREF="#GET_FA_TSO_SP">[Previous Routine]</A>
<A HREF="#GET_FA_TSP_EQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSP

 DESCRIPTION:


	function to load FAST Teams survey proton species data from the SDT
	program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Proton' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Theta angle for bins
	   PHI           FLOAT     Array(nnrgs, nbins) ; Phi angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DPHI          FLOAT     Array(nbins)        ; Delta Phi
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(4)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389           ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015                  ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	
 CALLING SEQUENCE:

 	data = get_fa_tsp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_fa_tsp.pro	1.20 08/15/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   June '95

LAST MODIFICATION:  eff added by Li Tang 10/21/96   Univ. of New Hampshire
		     geomfactor = 0.0015
		     units_procedure = 'convert_tms_units'
			geom(nnrgs, nbins)
		     7/15/97  keyword CALIB added 	L.Tang
		    
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsp.pro">general/missions/fast/fa_ops/get_fa_tsp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSP_EQ">
<H2>GET_FA_TSP_EQ</H2></A>
<A HREF="#GET_FA_TSP">[Previous Routine]</A>
<A HREF="#GET_FA_TSP_EQ_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSP_EQ

 DESCRIPTION:


	function to get FAST Teams survey H+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data

	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Proton' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tsp_eq (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang		  University of New Hampshire, 
						  Space Physics Lab
       Last modification:    8/21/96.
		     7/15/97  keyword CALIB added 	L.Tang
		              domega removed		L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsp_eq.pro">general/missions/fast/fa_ops/get_fa_tsp_eq.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSP_EQ_SP">
<H2>GET_FA_TSP_EQ_SP</H2></A>
<A HREF="#GET_FA_TSP_EQ">[Previous Routine]</A>
<A HREF="#GET_FA_TSP_SP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSP_EQ_SP

 DESCRIPTION:


	function to get FAST Teams survey H+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data. The difference of this routine from 
	GET_FA_TSP_EQ.PRO is that this routine generates one spin 
	resolution data when in TEAMS mode 6 and 7.


	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Proton' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tsp_eq_sp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input


 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	Created By:           Li Tang	9/17/96	  University of New Hampshire, 
						  Space Physics Lab
       Last modification:    
		     7/15/97  keyword CALIB added 	L.Tang
		              domega removed		L.Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsp_eq_sp.pro">general/missions/fast/fa_ops/get_fa_tsp_eq_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_TSP_SP">
<H2>GET_FA_TSP_SP</H2></A>
<A HREF="#GET_FA_TSP_EQ_SP">[Previous Routine]</A>
<A HREF="#GET_FA_V158">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_FA_TSP_SP

 DESCRIPTION:


	function to get FAST Teams survey H+ species eqtuator data from 
	get_fa_tsp.pro routine, calculate pitch angles and add efficiency 
	to the returned data. The difference of this routine from 
	GET_FA_TSP.PRO is that this routine generates one spin 
	resolution data when in TEAMS mode 6 and 7.


	A structure of the following format is returned:

	   DATA_NAME     STRING    'Tms Survey Proton' ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Pitch angle for bins
	   GEOM          FLOAT     Array(nnrgs, nbins) ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   DOMEGA        FLOAT     Array(nbins)        ; Solid angle for bins
	   PT_LIMITS     FLOAT     Array(2)            ; Angle min/max limits
	   EFF           FLOAT     Array(nnrgs, nbins) ; Efficiency (GF)
	   MASS          DOUBLE    0.0104389            ; Mass eV/(km/sec)^2
	   GEOMFACTOR    DOUBLE    0.0015              ; Bin GF
	   HEADER_BYTES  BYTE      Array(86)	       ; Header bytes
	   SPIN_FRACT    FLOAT     Array(nnrgs, nbins) ; Spin fraction of angles
	   EFF_VERSION   FLOAT     1.00		       ; Calibration version
	
 CALLING SEQUENCE:

 	data = get_fa_tsp_sp (time, [START=start | EN=en | ADVANCE=advance |
				RETREAT=retreat])

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:

	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input


 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

       Created By:     Eric Lund 2000-05-10    University of New Hampshire,
                                               Space Physics Lab
       Based On:       get_fa_tsp_eq_sp by Li Tang
</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_tsp_sp.pro">general/missions/fast/fa_ops/get_fa_tsp_sp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FA_V158">
<H2>GET_FA_V158</H2></A>
<A HREF="#GET_FA_TSP_SP">[Previous Routine]</A>
<A HREF="#GET_FIELDS_MODE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_FA_V158

 PURPOSE: - To synthesize and return a structure containing the
          component of the DC electric field perpendicular to the
          V5-V8 boom direction.

 CALLING SEQUENCE: v158 = get_fa_v158,t1, t2, NPTS=npts, START=st, EN=en, $
                     PANF=pf, PANB=pb, ALL = all, STORE = store,
                     STRUCTURE = v158s, SPIN = spin, REPAIR = repair,
                     DEFAULT = default

 INPUTS: T1, T2 - times (strings or double precision seconds since 1970)
       
 KEYWORD PARAMETERS: Just like GET_FA_FIELDS! Ok, with a couple
                     exceptions. There's no such thing as
                     uncalibrated data, for example.

 OUTPUTS: V158 - a fields-type structure, containing V1-(V5+V8)/2 in
          mV/m, UNLESS store is set, and then you get the TPLOT
          string handle.

 SIDE EFFECTS: If STORE is set, a quantity called 'V1-(V5+V8)/2' is
               stored for TPLOT. 

 RESTRICTIONS:  V4_S, V8_S, V1-V4_S, and V5-V8_S must all be loaded
               in to SDT. 

 EXAMPLE: v158 = get_fa_v158('1997-08-26/01:00','1997-08-26/01:05')

 MODIFICATION HISTORY: - Finally written 27-August-1997
                       by Bill Peria, UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fa_v158.pro">general/missions/fast/fa_ops/get_fa_v158.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_FIELDS_MODE">
<H2>GET_FIELDS_MODE</H2></A>
<A HREF="#GET_FA_V158">[Previous Routine]</A>
<A HREF="#GET_ISS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

Takes all the same keywords as GET_FA_FIELDS, returns the mode as a
 function of time, in the requested format (fields structure or
 stored for TPLOT)

</PRE><P>
<STRONG>(See <A href="fa_ops/get_fields_mode.pro">general/missions/fast/fa_ops/get_fields_mode.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_ISS">
<H2>GET_ISS</H2></A>
<A HREF="#GET_FIELDS_MODE">[Previous Routine]</A>
<A HREF="#GET_MD_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	get_iss(time,START=start,EN=en,ADVANCE=advance,RETREAT=retreat)
INPUT:
	time:	real		This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'MM-DD-YY/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.
				Time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
;KEYWORDS:
	START:			If non-zero, get data from the start time
				of the data instance in the SDT buffers
	EN:			If non-zero, get data at the end time
				of the data instance in the SDT buffers
	ADVANCE:		If non-zero, advance to the next data point
				following the time input
	RETREAT:		If non-zero, retreat (reverse) to the previous
				data point before the time input
	VARARR			If non-zero, program will not convert to 48 Energy
				by 32 angle arrays.
PURPOSE:
	To generate fast iesa survey data structures averaged over one spin.
;NOTES:
	Program calls get_iesa_surv.pro multiple times to generate spin averaged data.
	Data is averaged starting at the first &quot;spin phase&quot;=0 after &quot;time&quot;.
	Program checks for header changes, returns dat.valid=2 if less than 1 spin averaged.
	Program only return 48 Energies x 32 Angles, will average if in 96 E or 64 A mode.
	See get_iesa_surv.pro
CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-2		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/get_iss.pro">general/missions/fast/fa_ops/get_iss.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_MD_FROM_SDT">
<H2>GET_MD_FROM_SDT</H2></A>
<A HREF="#GET_ISS">[Previous Routine]</A>
<A HREF="#GET_MD_TS_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_MD_FROM_SDT

 DESCRIPTION:

	function to load generic multi dimensional data sample from the SDT program
 	shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'QTY'                ; Data Quantity name
	   VALID         INT       1                    ; Data valid flag
	   YEAR          LONG      year                 ; Data year
	   MONTH         LONG      month                ; Data month
	   DAY           LONG      day                  ; Data day
	   TIME          DOUBLE    time                 ; Start Time of sample
	   ENDTIME       DOUBLE    end_time             ; End time of sample
	   INTEG_T       DOUBLE    integ_t              ; Integration time
          CALIBRATED    INT       calibrated           ; flags calibrated data
          CALIBRATED_UNITS STRING units                ; calibrated units string
	   VALUES        &lt;TYPE&gt;    Array(dimsizes(0..3)); Data qauantities
	   NDIMS         LONG      ndims                ; Number of data dimensions
	   DIMSIZES      LONG      dimsizes(3)          ; Sizes of each dimension
	   NCOMP         LONG      ncomp                ; number of data components
	   NMINMAX       INT       array(ndims)         ; number of array desc(dim)
	   MIN1          DOUBLE    array(dimsizes(0)    ; Array descriptor min (0)
	   MAX1          DOUBLE    array(dimsizes(0)    ; Array descriptor max (0)
	   MIN2          DOUBLE    array(dimsizes(1)    ; Array descriptor min (1)
	   MAX2          DOUBLE    array(dimsizes(1)    ; Array descriptor max (1)
	   MIN3          DOUBLE    array(dimsizes(2)    ; Array descriptor min (2)
	   MAX3          DOUBLE    array(dimsizes(2)    ; Array descriptor max (2)
	   INDEX         LONG      idx                  ; index into sdt buffers
	
 CALLING SEQUENCE:

	data = get_md_from_sdt (data_name, sat_code, TIME=time, 
	                        [START = start | EN = en | ADVANCE = advance |
				RETREAT=retreat], INDEX=idx)

 ARGUMENTS:

	data_name		The SDT data quantity name
	sat_code		The SDT satellite code

 KEYWORDS:

	TIME 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.
	START			If non-zero, get data from the start time
				of the data instance in the SDT buffers

	EN			If non-zero, get data at the end time
				of the data instance in the SDT buffers

	ADVANCE			If non-zero, advance to the next data point
				following the time input

	RETREAT			If non-zero, retreat (reverse) to the previous
				data point before the time input

	INDEX			If defined, data will be selected by this
				index

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_md_from_sdt.pro	1.11 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '95
</PRE><P>
<STRONG>(See <A href="fa_ops/get_md_from_sdt.pro">general/missions/fast/fa_ops/get_md_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_MD_TS_FROM_SDT">
<H2>GET_MD_TS_FROM_SDT</H2></A>
<A HREF="#GET_MD_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_MD_TS_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_MD_TS_FROM_SDT

 DESCRIPTION:

	function to load generic multi dimensional data time series
	from the SDT program shared memory buffers.

	A structure of the following format is returned:

	   DATA_NAME     STRING    'QTY'                ; Data Quantity name
	   VALID         INT       1                    ; Data valid flag
	   START_TIME    DOUBLE    8.0118726e+08        ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08        ; End time of sample
	   NPTS          INT       npts                 ; Number of time samples
          TIMES         DOUBLE    Array(npts)          ; start timetags
          ENDTIMES      DOUBLE    Array(npts)          ; end timetags
	   INTEG_T       DOUBLE    array(npts)          ; Integration time
          CALIBRATED    LONG      calibrated           ; flags calibrated data
          CALIBRATED_UNITS STRING units                ; calibrated units string
	   VALUES        &lt;TYPE&gt;    Array(dimsizes(0..3)); Data qauantities
	   NDIMS         LONG      ndims                ; Number of data dimensions
	   DIMSIZES      LONG      dimsizes(3)          ; Sizes of each dimension
	   NCOMP         LONG      ncomp                ; number of data components
	   NMINMAX       LONG       array(ndims)         ; number of array desc(dim)
	   MIN1          DOUBLE    array(dimsizes(0),npts) ; Array desc min (0)
	   MAX1          DOUBLE    array(dimsizes(0),npts) ; Array desc max (0)
	   MIN2          DOUBLE    array(dimsizes(1),npts) ; Array desc min (1)
	   MAX2          DOUBLE    array(dimsizes(1),npts) ; Array desc max (1)
	   MIN3          DOUBLE    array(dimsizes(2),npts) ; Array desc min (2)
	   MAX3          DOUBLE    array(dimsizes(2),npts) ; Array desc max (2)
	   ST_INDEX      LONG      stidx                ; index of 1st pt in sdt
	   EN_INDEX      LONG      enidx                ; index of last pt in sdt
	
 CALLING SEQUENCE:

	data = get_md_ts_from_sdt (data_name, sat_code, t1=time1, t2=time2, 
				[NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx])
 ARGUMENTS:

	data_name		The SDT data quantity name
	sat_code		The SDT satellite code

 KEYWORDS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero, DF == defined):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  DF |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |
	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_md_ts_from_sdt.pro	1.3 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Mar '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_md_ts_from_sdt.pro">general/missions/fast/fa_ops/get_md_ts_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_MD_TS_FROM_SDT_TEMPLATE">
<H2>GET_MD_TS_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GET_MD_TS_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_ORBFILE_EPOCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines
	to get a time series of multi-dimensional type data from the SDT
	program shared memory buffers.  The coder should look at the 
	get_&lt;x&gt;d_from_sdt_from_std_template.pro files for info on
	handling your data for each sample.

	Where modifications should be made, they are indicated by strings
	such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.

	At structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_your-data-name_&gt;'  ; Data Quantity name
	   VALID         INT       1                     ; Data valid flag
	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'     ; project name
	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'     ; Units of this data
	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'  ; Units conversion proc
	   START_TIME    DOUBLE    8.0118726e+08         ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08         ; End time of sample
	   NPTS          INT       npts                  ; Number of time samples
	   NDIMS         INT       ndims(rows,cols,echs) ; size of each dimension
	   TIMES         DOUBLE    array(double)         ; Timetags of samples
	   END_TIMES     DOUBLE    array(double)         ; End timetags of samples
          CALIBRATED    INT       calibrated            ; flags calibrated data
          CALIBRATED_UNITS STRING units                 ; calibrated units string
	   DATA          _Type_    array(ndims)          ; Data component 1
	   NMINMAX       INT       nminmax               ; number of arr-desc.           
	   MIN1          DOUBLE    array(nminmax(0))     ; min array descriptors
	   MAX1          DOUBLE    array(nminmax(0))     ; max array descriptors
_ below here, delete unused MIN/MAX array descriptors based upon the number of dims: _&gt;
	   MIN2          DOUBLE    array(nminmax(1))     ; min array descriptors
	   MAX2          DOUBLE    array(nminmax(1))     ; max array descriptors
	   MIN3          DOUBLE    array(nminmax(1))     ; min array descriptors
	   MAX3          DOUBLE    array(nminmax(1))     ; max array descriptors
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time1, time2, [NPTS=npts], [START=st | EN=en |
				PANF=panf | PANB = panb], STIDX=stidx)

 ARGUMENTS:

	time1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.
 KEYWORDS:

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |STIDX|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_md_ts_from_sdt_template.pro	1.1 03/26/97
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Mar '97
</PRE><P>
<STRONG>(See <A href="fa_ops/get_md_ts_from_sdt_template.pro">general/missions/fast/fa_ops/get_md_ts_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_ORBFILE_EPOCH">
<H2>GET_ORBFILE_EPOCH</H2></A>
<A HREF="#GET_MD_TS_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GET_PA_SPEC_TS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:  get_orbfile_epoch

 PURPOSE:   Searches an orbit file for the epoch time of an orbit.
            Uses a relatively fast algorithm.

 ARGUMENTS: ORBIT       The orbit to search for in the orbit file.

 KEYWORDS:  ORBIT_FILE  The orbit file to search in. This defaults to
                        the definitive orbit file in
                        fa_almanac_dir()/orbit/.  If the requested
                        orbit is beyond this file, it will try the
                        predicted file.  A -1 will be returned if the
                        orbit is not found in either file.

 CREATED:   1998/01/30 By J. Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/get_orbfile_epoch.pro">general/missions/fast/fa_ops/get_orbfile_epoch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_PA_SPEC_TS">
<H2>GET_PA_SPEC_TS</H2></A>
<A HREF="#GET_ORBFILE_EPOCH">[Previous Routine]</A>
<A HREF="#GET_PO_ORBIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	get_pa_spec_ts
PURPOSE:	
	Generates pitch angle vs. time spectrogram data structures for tplot
INPUT:		
	get_dat, 	a string (either 'fa_ees','fa_eeb', ...)
			where get_'string'_ts returns a 2D or 3D 
			array of data structures
KEYWORDS:		
	T1:		start time, seconds since 1970
	T2:		end time, seconds since 1970		
	ENERGY:		fltarr(2)		energy range to sum over
	ERANGE:		intarr(2)		energy bin range to sum over
	EBINS:		bytarr(dat.nenergy)	energy bins to sum over
	gap_time: 	time gap big enough to signify a data gap 
			(default 200 sec, 8 sec for FAST)
	NO_DATA: 	returns 1 if no_data else returns 0
	UNITS:		convert to these units if included
	NAME:  		New name of the Data Quantity
	BKG:  		A 3d data structure containing the background counts.
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	Value for bad data.
	RETRACE: 	Set to number of retrace energy steps to be eliminated starting at energy step 0
	EWEIGHT		Weights the energy bin average by bin energy width.
	SHIFT90		If set true, pitch angle range is -90 to 270
	CALIB:		Calib keyword passed on to get_&quot;get_dat&quot;_ts
	n_get_pts: 	Number of points in the array of structures formed by get_&quot;get_dat&quot;_ts, default=200.

CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  97/05/21
MOD HISTORY:
		97/05/15	Variation on get_pa_spec.pro 
		97/07/23	fixed bug - ind1=fix((max(ind)+min(ind))/2) 

NOTES:	  
	Current version only works for FAST
</PRE><P>
<STRONG>(See <A href="fa_ops/get_pa_spec_ts.pro">general/missions/fast/fa_ops/get_pa_spec_ts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_PO_ORBIT">
<H2>GET_PO_ORBIT</H2></A>
<A HREF="#GET_PA_SPEC_TS">[Previous Routine]</A>
<A HREF="#GET_SDT_TIMESPAN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:        get_po_orbit
     
 PURPOSE:          Gets orbit data for the POLAR spacecraft and loads it
                   into tplot structures.  Does not consider thrusters.
     
 METHOD:           1) Extracts position and veloctity vectors from a POLAR
                      CDF file.  The POLAR &quot;master index file&quot; must
                      be in place for this step to work.
                   2) Writes a temporary orbit file to be used as
                      input to the orbit propagator.
                   3) Calls the FAST orbit propagator, with the orbit
                      file as input, to load POLAR orbit data into
                      tplot structures (or save as a single structure).

 NOTE:             This procedure needs permission to create files in
                   the current working directory.  The filenames will
                   begin with &quot;polar_&quot; and should be deleted
                   automatically.

 WARNING:          The POLAR spacecraft is equipped with thrusters.
                   Calculated orbit parameters will be in error if
                   the thrusters were fired between the initial
                   reference time used by this procedure and the
                   end of the requested propagation period.
     
 PARAMETERS:     
     
   arg1            If keyword parameter 'time_array' is not set, then this
                   parameter is the start time of the timespan over which
                   orbit vectors are to be computed else it is the array
                   of times for which orbit vectors are to be computed.
     
   arg2            if keyword parameter 'time_array' is not set, then this
                   parameter is the end time of the timespan over which
                   orbit vectors are to be computed, else it is not used.

 KEYWORDS:

   time_array      If not set, then interpret the two positional
                   parameters as the start time and end time of the 
                   timespan over which orbit vectors are to computed.
                   If set, interpret the first positional parameter
                   as an array.

   ALL             If not set, will get the following data:
                       {x:time, y:orbit, ytitle:'ORBIT'}
                       {x:time, y:pos, ytitle:'po_pos'}
                       {x:time, y:alt, ytitle:'ALT'}
                       {x:time, y:ilat, ytitle:'ILAT'}
                       {x:time, y:ilng, ytitle:'ILNG'}
                       {x:time, y:mlt, ytitle:'MLT'}
                       {x:time, y:vel, ytitle:'po_vel'}
                   If set, will get the quantities above, and also:
                       {x:time, y:lat, ytitle:'LAT'}
                       {x:time, y:lng, ytitle:'LNG'}
                       {x:time, y:flat, ytitle:'FLAT'}
                       {x:time, y:flng, ytitle:'FLNG'}
                       {x:time, y:b, ytitle:'B_model'}
                       {x:time, y:bfootprint, ytitle:'BFOOT'}

   STATUS          The long integer return value of the
                   OrbGetVectors() call in the orbitio library.
                   There are about a dozen different status codes
                   indicating the various possible error conditions.
                   These status codes are shown in the include file
                   $(workspace)/include/orbitlib.h (ORB_OK, ORB_EOF,
                   etc).  The user should explicitly test that status
                   equals 0 (ORB_OK = 0 signifies success) before
                   using the returned data. Other miscellaneous errors
                   may result in nonzero status also.
   NO_STORE        If set, inhibits storage of orbit quantities in
                   tplot structures. This is useful to avoid the
                   overwriting of previously stored data.
   STRUCTURE       A named variable into which a structure containing
                   the requested orbit quantities will be returned.
                   NOTE: As a side effect of using the FAST orbit
                   propagator, the position and velocity tags in this
                   structure will be FA_POS and FA_VEL, not PO_POS
                   and PO_VEL as they should be.
   DELTA_T         Spacing in seconds of the computed orbit vectors
                   (default = 20 sec).  This keyword is ignored if
                   time_array is set.

 CREATED:          97-8-20
                   By J. Rauchleiba

 
</PRE><P>
<STRONG>(See <A href="fa_ops/get_po_orbit.pro">general/missions/fast/fa_ops/get_po_orbit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_SDT_TIMESPAN">
<H2>GET_SDT_TIMESPAN</H2></A>
<A HREF="#GET_PO_ORBIT">[Previous Routine]</A>
<A HREF="#GET_TMS_ANG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: GET_SDT_TIMESPAN

 PURPOSE: To return the start and stop times for data currently
          stored in SDT. 
 
 KEYWORD PARAMETERS: DQD - a string naming a specific quantity for
                     which the timespan is desired. If not set, then
                     the first and last times (among any currently
                     stored quantity) are returned.

 OUTPUTS: T1 and T2 : scalar, double precision seconds since 1970,
          ready to be passed to GET_FA_FIELDS, GET_EN_SPEC,
          whatever. 

 EXAMPLE: if get_sdt_timespan(t1,t2,dqd='Eesa Burst') then begin
             print,'timespan is from ',t1,' to ',t2
          endif else begin
             print,' could not get timespan...'
          endelse

 MODIFICATION HISTORY: written 22-Aug_97 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/get_sdt_timespan.pro">general/missions/fast/fa_ops/get_sdt_timespan.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TMS_ANG">
<H2>GET_TMS_ANG</H2></A>
<A HREF="#GET_SDT_TIMESPAN">[Previous Routine]</A>
<A HREF="#GET_TMS_HM_SPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	get_tms_ang

INPUT:		NONE

PURPOSE:	Select teams survey or himass angle bins.

KEYWORDS:	None

CALLING SEQUENCE:
		  bins = fast_tms_ang()

CREATED BY:	Li Tang 	11/5/96		Univ. of New Hampshire
						Space Physics Lab
						tang@teams.sr.unh.edu
</PRE><P>
<STRONG>(See <A href="fa_ops/get_tms_ang.pro">general/missions/fast/fa_ops/get_tms_ang.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TMS_HM_SPEC">
<H2>GET_TMS_HM_SPEC</H2></A>
<A HREF="#GET_TMS_ANG">[Previous Routine]</A>
<A HREF="#GET_TS_1P_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	get_tms_hm_spec
PURPOSE:	
	Generates energy-time spectrogram data structures for tplot
INPUT:		
	data_str, 	a string (either 'th_3d','ess', ...)
			where get_'string' returns a 2D(if input is 3D) or
			1D(input is 2D) mass data structure
KEYWORDS:		
	STIME:		'1996-10-09/12:23:34'	time to start
	TSPAN:		seconds			time span
	ENERGY:		fltarr(2)		energy range to sum over
	ERANGE:		intarr(2)		energy bin range to sum over
	EBINS:		bytarr(dat.nenergy)	energy bins to sum over
	ANGLE:		fltarr(2),fltarr(4)	angle range to sum over
	ARANGE:		intarr(2)		bin range to sum over
	BINS:		bytarr(dat.nbins)	bins to sum over
	gap_time: 	time gap big enough to signIFy a data gap 
			(default 200 sec, 9 sec for FAST)
	NO_DATA: 	returns 1 IF no_data ELSE returns 0
	UNITS:		convert to these units IF included
	NAME:  		New name of the Data Quantity
	BKG:  		A 3d data structure containing the background counts.
	FLOOR:  	Sets the minimum value of any data point to sqrt(bkg).
	MISSING: 	Value for bad data.

CREATED BY:	Li Tang     Univ. of New Hampshire
			    Space Physics Lab		tang@teams.sr.unh.edu
VERSION:	3.0
LAST MODIFICATION:  96-10-17
MOD HISTORY:  96-8-20  Added ASUM and ESUM keywords  - LT
	       96-9-27  removed asum, esum, aweight, eweight, and etc     LT
	       96-11-4 Able to deal with 2D data type			  LT 
	       97-3-21  Change pitch angle calculation. 		  LT
	       97-3-30  changed the aweight for 2D structure		  LT
NOTES:	  
	Current version only works for FAST
</PRE><P>
<STRONG>(See <A href="fa_ops/get_tms_hm_spec.pro">general/missions/fast/fa_ops/get_tms_hm_spec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TS_1P_FROM_SDT">
<H2>GET_TS_1P_FROM_SDT</H2></A>
<A HREF="#GET_TMS_HM_SPEC">[Previous Routine]</A>
<A HREF="#GET_TS_1P_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_TS_1P_FROM_SDT

 DESCRIPTION:

	function to load one data point of generic time series data
	type from the SDT program shared memory buffers at a 
 	specific time.

	At structure of the following format is returned:

	   DATA_NAME     STRING    'QTY'            ; Data Quantity name
	   VALID         INT       1                ; Data valid flag
	   TIME          DOUBLE    8.0118726e+08    ; Time of sample, returned
	   NCOMP         INT       ncomp            ; Number of components
	   DEPTH         INT       Array(ncomp)     ; depth of component
          CALIBRATED    INT       calibrated       ; flags calibrated data
          CALIBRATED_UNITS STRING units            ; calibrated units string
	   INDEX         LONG      idx              ; index into sdt data
	   COMP1         FLOAT     Array(depth(0))  ; Data component 1
	   COMP2         FLOAT     Array(depth(1))  ; Data component 2
	   COMP3         FLOAT     Array(depth(2))  ; Data component 3
	   COMP4         FLOAT     Array(depth(3))  ; Data component 4
	   COMP5         FLOAT     Array(depth(4))  ; Data component 5
	   COMP6         FLOAT     Array(depth(5))  ; Data component 6
	   COMP7         FLOAT     Array(depth(6))  ; Data component 7
	   COMP8         FLOAT     Array(depth(7))  ; Data component 8
	   COMP9         FLOAT     Array(depth(8))  ; Data component 9
	   COMP10        FLOAT     Array(depth(9))  ; Data component 10
	   COMP11        FLOAT     Array(depth(10)) ; Data component 11
	   COMP12        FLOAT     Array(depth(11)) ; Data component 12
	   COMP13        FLOAT     Array(depth(12)) ; Data component 13
	   COMP14        FLOAT     Array(depth(13)) ; Data component 14
	   COMP15        FLOAT     Array(depth(14)) ; Data component 15
	   COMP16        FLOAT     Array(depth(15)) ; Data component 16
	   COMP17        FLOAT     Array(depth(16)) ; Data component 17
	   COMP18        FLOAT     Array(depth(17)) ; Data component 18
	   COMP19        FLOAT     Array(depth(18)) ; Data component 19
	   COMP20        FLOAT     Array(depth(19)) ; Data component 20
	   
	
 CALLING SEQUENCE:

 	data = get_ts_1p_from_sdt (data_name, sat_code, time)

 ARGUMENTS:

	data_name		The SDT data quantity name
	sat_code		The SDT satellite code
	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 KEYWORDS:
	INDEX:			get data at this index.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_ts_1p_from_sdt.pro	1.8 07/23/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_ts_1p_from_sdt.pro">general/missions/fast/fa_ops/get_ts_1p_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TS_1P_FROM_SDT_TEMPLATE">
<H2>GET_TS_1P_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GET_TS_1P_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_TS_FROM_SDT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines to get 
	1 sample of time series type data from the SDT program shared memory 
	buffers.  Where modifications should be made, they are indicated by 
	strings such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.

	At structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_yourDataName_&gt;'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'   ; project name
 	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'   ; Units of this data
 	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Time of sample
	   NCOMP         INT       &lt;_NumberOfDataComp_&gt;; Number of components
	   DEPTH         INT       &lt;_DepthOfEachComp_&gt; ; depth of component(s)
          CALIBRATED    INT       calibrated          ; flags calibrated data
          CALIBRATED_UNITS STRING units               ; calibrated units string
	   DATA1         &lt;_Type_&gt;  Array(&lt;_depth(0)_&gt;) ; Data component 1
_ Here, enter a data spec for each component in this data set _&gt;
	   DATA2         &lt;_Type_&gt;  Array(&lt;_depth(1)_&gt;) ; Data component 2
	   DATA3         &lt;_Type_&gt;  Array(&lt;_depth(2)_&gt;) ; Data component 3
_ .. _&gt;
	   DATAn         &lt;_Type_&gt;  Array(&lt;_depth(n-1)_&gt;); Data component 4
	   HEADER_BYTES  BYTE      Array(1)	       ; Header bytes (not implemented)
	   
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time1, time2)

 ARGUMENTS:

	time 			This argument gives a time handle from which
				to take data from.  It may be either a string
				with the following possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				time will always be returned as a double
				representing the actual data time found in
				seconds since 1970.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_ts_1p_from_sdt_template.pro	1.3 07/12/96
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_ts_1p_from_sdt_template.pro">general/missions/fast/fa_ops/get_ts_1p_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TS_FROM_SDT">
<H2>GET_TS_FROM_SDT</H2></A>
<A HREF="#GET_TS_1P_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GET_TS_FROM_SDT_TEMPLATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_TS_FROM_SDT

 DESCRIPTION:

	function to load generic time series data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING    'QTY'                 ; Data Quantity name
	   VALID         INT       1                     ; Data valid flag
	   START_TIME    DOUBLE    8.0118726e+08         ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08         ; End time of sample
	   NPTS          INT       npts                  ; Number of time samples
	   NCOMP         INT       ncomp                 ; Number of components
	   DEPTH         INT       Array(ncomp)          ; depth of component
          TIME          DOUBLE    Array(npts)           ; timetags
          CALIBRATED    INT       calibrated            ; flags calibrated data
          CALIBRATED_UNITS STRING units                 ; calibrated units string
	   COMP1         FLOAT     Array(npts,depth(0))  ; Data component 1
	   COMP2         FLOAT     Array(npts,depth(1))  ; Data component 2
	   COMP3         FLOAT     Array(npts,depth(2))  ; Data component 3
	   COMP4         FLOAT     Array(npts,depth(3))  ; Data component 4
	   COMP5         FLOAT     Array(npts,depth(4))  ; Data component 5
	   COMP6         FLOAT     Array(npts,depth(5))  ; Data component 6
	   COMP7         FLOAT     Array(npts,depth(6))  ; Data component 7
	   COMP8         FLOAT     Array(npts,depth(7))  ; Data component 8
	   COMP9         FLOAT     Array(npts,depth(8))  ; Data component 9
	   COMP10        FLOAT     Array(npts,depth(9))  ; Data component 10
	   COMP11        FLOAT     Array(npts,depth(10)) ; Data component 11
	   COMP12        FLOAT     Array(npts,depth(11)) ; Data component 12
	   COMP13        FLOAT     Array(npts,depth(12)) ; Data component 13
	   COMP14        FLOAT     Array(npts,depth(13)) ; Data component 14
	   COMP15        FLOAT     Array(npts,depth(14)) ; Data component 15
	   COMP16        FLOAT     Array(npts,depth(15)) ; Data component 16
	   COMP17        FLOAT     Array(npts,depth(16)) ; Data component 17
	   COMP18        FLOAT     Array(npts,depth(17)) ; Data component 18
	   COMP19        FLOAT     Array(npts,depth(18)) ; Data component 19
	   COMP20        FLOAT     Array(npts,depth(19)) ; Data component 20
	   COMP21        FLOAT     Array(npts,depth(20)) ; Data component 21
	   COMP22        FLOAT     Array(npts,depth(21)) ; Data component 22
	   COMP23        FLOAT     Array(npts,depth(22)) ; Data component 23
	   COMP24        FLOAT     Array(npts,depth(23)) ; Data component 24
	   COMP25        FLOAT     Array(npts,depth(24)) ; Data component 25
	   COMP26        FLOAT     Array(npts,depth(25)) ; Data component 26
	   COMP27        FLOAT     Array(npts,depth(26)) ; Data component 27
	   COMP28        FLOAT     Array(npts,depth(27)  ; Data component 28
	   COMP29        FLOAT     Array(npts,depth(28)) ; Data component 29
	   COMP30        FLOAT     Array(npts,depth(29)) ; Data component 30
	   COMP31        FLOAT     Array(npts,depth(30)) ; Data component 31
	   COMP32        FLOAT     Array(npts,depth(31)) ; Data component 32
	   COMP33        FLOAT     Array(npts,depth(32)) ; Data component 33
	   COMP34        FLOAT     Array(npts,depth(33)) ; Data component 34
	   COMP35        FLOAT     Array(npts,depth(34)) ; Data component 35
	   COMP36        FLOAT     Array(npts,depth(35)) ; Data component 36
	   COMP37        FLOAT     Array(npts,depth(36)) ; Data component 37
	   COMP38        FLOAT     Array(npts,depth(37)) ; Data component 38
	   COMP39        FLOAT     Array(npts,depth(38)) ; Data component 39
	   ST_INDEX      LONG      stidx                 ; index of 1st pt in sdt
	   EN_INDEX      LONG      enidx                 ; index of last pt in sdt
	   
	
 CALLING SEQUENCE:

 	data = get_ts_from_sdt (data_name, sat_code, t1=time1, t2=time2, 
				[NPTS=npts], [START=st | EN=en | 
				PANF=panf | PANB=panb | IDXST=startidx])

 ARGUMENTS:

	data_name		The SDT data quantity name
	sat_code		The SDT satellite code

 KEYWORDS:

	t1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	t2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |IDXST|PANF |PANB |selection            |use time1|use time2|
 |----|-----|-----|-----|-----|-----|-----|---------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  |  0  | start -&gt; end        |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2      |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  |  0  | start -&gt; time1 secs |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  |  0  | end-time1 secs -&gt;end|  X      |         |
 | 0  |  0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from        |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  0  |  0  |  0  |  0  |  0  |  NZ | pan back from       |  X      |  X      |
 |    |     |     |     |     |     |     |   time1-&gt;time2      |         |         |
 | 0  |  NZ |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  |  0  | start -&gt; start+npts |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  |  0  | end-npts -&gt; end     |         |         |
 | 0  |  NZ |  0  |  0  |  NZ |  0  |  0  | st-index -&gt;         |         |         |
 |    |     |     |     |     |     |     |   st_index + npts   |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_ts_from_sdt.pro	1.13 07/26/02
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_ts_from_sdt.pro">general/missions/fast/fa_ops/get_ts_from_sdt.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_TS_FROM_SDT_TEMPLATE">
<H2>GET_TS_FROM_SDT_TEMPLATE</H2></A>
<A HREF="#GET_TS_FROM_SDT">[Previous Routine]</A>
<A HREF="#GET_V1_V4_SURV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 get_&lt;_satellite_&gt;_&lt;_inst_&gt;

 DESCRIPTION:

	This is a template function to be used to build get_* routines to get 
	time series type data from the SDT program shared memory buffers.
	Where modifications should be made, they are indicated by strings
	such as: &lt;_xxxx_&gt;.  Comments should be keeped up as well, which
	we find to be the most time consuming part.

	At structure of the following format is returned:

	   DATA_NAME     STRING    '&lt;_yourDataName_&gt;'  ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    '&lt;_yourProject_&gt;'   ; project name
 	   UNITS_NAME    STRING    '&lt;_unitsOfData_&gt;'   ; Units of this data
 	   UNITS_PROCEDURE  STRING '&lt;_unitsProcedure_&gt;'; Units conversion proc
	   START_TIME    DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   NPTS          INT       npts                ; Number of time samples
	   NCOMP         INT       &lt;_NumberOfDataComp_&gt;; Number of components
	   DEPTH         INT       &lt;_DepthOfEachComp_&gt; ; depth of component(s)
          TIME          DOUBLE    Array(npts)         ; timetags
          CALIBRATED    INT       calibrated          ; flags calibrated data
          CALIBRATED_UNITS STRING units               ; calibrated units string
	   DATA1         &lt;_Type_&gt;  Array(npts,&lt;_depth(0)_&gt;); Data component 1
_ Here, enter a data spec for each component in this data set _&gt;
	   DATA2         &lt;_Type_&gt;  Array(npts,&lt;_depth(1)_&gt;); Data component 2
	   DATA3         &lt;_Type_&gt;  Array(npts,&lt;_depth(2)_&gt;); Data component 3
_ .. _&gt;
	   DATAn         &lt;_Type_&gt;  Array(npts,&lt;_depth(n-1)_&gt;); Data component 4
	   HEADER_BYTES  BYTE      Array(1)	       ; Header bytes (not implemented)
	   
	
 CALLING SEQUENCE:

 	data = get_&lt;_satellite_&gt;_&lt;_inst_&gt; (time1, time2, [NPTS=npts], [START=st | EN=en |
				PANF=panf | PANB = panb])

 ARGUMENTS:

	time1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.
 KEYWORDS:

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_ts_from_sdt_template.pro	1.9 07/12/96
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_ts_from_sdt_template.pro">general/missions/fast/fa_ops/get_ts_from_sdt_template.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GET_V1_V4_SURV">
<H2>GET_V1_V4_SURV</H2></A>
<A HREF="#GET_TS_FROM_SDT_TEMPLATE">[Previous Routine]</A>
<A HREF="#GOPEN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 GET_V1_V4_SURV

 DESCRIPTION:

	function to load FAST V1-V4 Survey fields data from the SDT program
 	shared memory buffers.

	At structure of the following format is returned:

	   DATA_NAME     STRING    'V1-V4 S'           ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   START_TIME    DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   NPTS          INT       npts                ; Number of time samples
	   NCOMP         INT       1                   ; Number of components
	   DEPTH         INT       1                   ; depth of component
          TIME          DOUBLE    Array(npts)         ; timetags
	   DATA          FLOAT     Array(npts)         ; Data qauantities
	   HEADER_BYTES  BYTE      Array(1)	       ; Header bytes (not implemented)
	   
	
 CALLING SEQUENCE:

 	data = get_v1_v4_SURV (time1, time2, [NPTS=npts], [START=st | EN=en |
				PANF=panf | PANB = panb])

 ARGUMENTS:

	time1 			This argument gives the start time from
				which to take data, or, if START or EN keywords
				are non-zero, the length of time to take data.
				It may be either a string with the following
				possible formats:
					'YY-MM-DD/HH:MM:SS.MSC'  or
					'HH:MM:SS'     (use reference date)
				or a number, which will represent seconds
				since 1970 (must be a double &gt; 94608000.D), or
				a hours from a reference time, if set.

				Time will always be returned as a double
				representing the actual data start time found 
				in seconds since 1970.

	time2			The same as time1, except it represents the
				end time.

				If the NPTS, START, EN, PANF or PANB keywords 
				are non-zero, THEN time2 will be ignored as an
				input paramter.
 KEYWORDS:

	Data time selection is determined from the keywords as given in the 
	following truth table (NZ == non-zero):

 |ALL |NPTS |START| EN  |PANF |PANB |selection                  |use time1|use time2|
 |----|-----|-----|-----|-----|-----|---------------------------|---------|---------|
 | NZ |  0  |  0  |  0  |  0  |  0  | start -&gt; end              |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  0  | time1 -&gt; time2            |  X      |  X      |
 | 0  |  0  |  NZ |  0  |  0  |  0  | start -&gt; time1 secs       |  X      |         |
 | 0  |  0  |  0  |  NZ |  0  |  0  | end-time1 secs -&gt; end     |  X      |         |
 | 0  |  0  |  0  |  0  |  NZ |  0  | pan fwd from time1-&gt;time2 |  X      |  X      |
 | 0  |  0  |  0  |  0  |  0  |  NZ | pan back from time1-&gt;time2|  X      |  X      |
 | 0  |  NZ |  0  |  0  |  0  |  0  | time1 -&gt; time1+npts       |  X      |         |
 | 0  |  NZ |  NZ |  0  |  0  |  0  | start -&gt; start+npts       |         |         |
 | 0  |  NZ |  0  |  NZ |  0  |  0  | end-npts -&gt; end           |         |         |

	Any other combination of keywords is not allowed.

 RETURN VALUE:

	Upon success, the above structure is returned, with the valid tag
	set to 1.  Upon failure, the valid tag will be 0.

 REVISION HISTORY:

	@(#)get_v1_v4_surv.pro	1.4 06/19/96
 	Originally written by	 Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jan '96
</PRE><P>
<STRONG>(See <A href="fa_ops/get_v1_v4_surv.pro">general/missions/fast/fa_ops/get_v1_v4_surv.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GOPEN">
<H2>GOPEN</H2></A>
<A HREF="#GET_V1_V4_SURV">[Previous Routine]</A>
<A HREF="#GOPEN_COM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE: gopen, filename
PURPOSE: 
  Prepare to put out a GIF file.
INPUT:    optional;  if:
  string   :  string used as filename,  '.gif' extension is added automatically
  integer X:  filename set to 'plotX.gif'.  value of x is incremented by 1.
  none:       filename set to 'plot.gif'
KEYWORDS: See print_options for info.
  COPY:    pass COPY keyword to set_plot
  INTERP:  pass INTERP keyword to set_plot  (default is to have interp on)

SEE ALSO:	&quot;gclose&quot;,
		&quot;print_options&quot;,
		&quot;gopen_com&quot;

CREATED BY:	Davin Larson (as popen.pro)
SWIPED BY: Bill Peria

</PRE><P>
<STRONG>(See <A href="fa_ops/gopen.pro">general/missions/fast/fa_ops/gopen.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GOPEN_COM">
<H2>GOPEN_COM</H2></A>
<A HREF="#GOPEN">[Previous Routine]</A>
<A HREF="#GTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
COMMON BLOCK:	gopen_com
PURPOSE:	Common block for print routines

SEE ALSO:	&quot;gopen&quot;,&quot;gclose&quot;,
		&quot;print_options&quot;

CREATED BY:	Davin Larson
STOLEN BY: Bill Peria
</PRE><P>
<STRONG>(See <A href="fa_ops/gopen_com.pro">general/missions/fast/fa_ops/gopen_com.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GTS">
<H2>GTS</H2></A>
<A HREF="#GOPEN_COM">[Previous Routine]</A>
<A HREF="#GTS_BATCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:    gts.pro  (Generic Trending System)

 PURPOSE:      Extracts DQIs from SDT SMBs.
               Saves variables to a file.
               Called by gts_batch.pro from sdt_batch, from gts.ksh.

 ARGUMENTS:    None

 ENV. VARS:    output_datafile      File in which to save the data.
               DQIlist              List of SDT Data Quantity Instances

 BY:           J. Rauchleiba 1998/8/20
</PRE><P>
<STRONG>(See <A href="fa_ops/gts.pro">general/missions/fast/fa_ops/gts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GTS_BATCH">
<H2>GTS_BATCH</H2></A>
<A HREF="#GTS">[Previous Routine]</A>
<A HREF="#GTS_CONCATENATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 gts_batch.pro

 Used by GTS (Generic Trending System)
 Called by sdt_batch
 Calls IDL procedure gts.pro, which gets all input from env vars.

 By J.Rauchleiba 1998/8/18
</PRE><P>
<STRONG>(See <A href="fa_ops/gts_batch.pro">general/missions/fast/fa_ops/gts_batch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="GTS_CONCATENATE">
<H2>GTS_CONCATENATE</H2></A>
<A HREF="#GTS_BATCH">[Previous Routine]</A>
<A HREF="#HEAD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:   gts_concatenate.pro

 PURPOSE:     Restores IDL &quot;save&quot; files containing FAST trending data
              and concatenates the contents.

 ARGUMENTS:   (None)

 KEYWORDS:    DATA_DIRECTORY      The directory containing the save
                                  files. (scalar or string array)
              QUANTITIES          String array of variable names
                                  contained in the save files.
              PREFIX              Initial string in filenames. (default=`*')
              YEAR_RE             Regular expression for year field
                                  in filename.
              DOY1_RE             RE for start DOY in file name.
              DOY2_RE             RE for ending DOY in filename.

 BY:          J.Rauchleiba        1998/8/21
</PRE><P>
<STRONG>(See <A href="fa_ops/gts_concatenate.pro">general/missions/fast/fa_ops/gts_concatenate.pro</A>)</STRONG><P>
<HR>
 
<A NAME="HEAD">
<H2>HEAD</H2></A>
<A HREF="#GTS_CONCATENATE">[Previous Routine]</A>
<A HREF="#HELPFAST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
        HEAD.PRO

 DESCRIPTION:

       Procedure to print out the head (first few elements) of an array.

 USAGE:
 
 	HEAD, input_array, [NUMBER=number-of-initial-elements]

 ARGUMENTS:
	input_array 	The array to print.

 KEYWORDS:
	NUMBER		The number if array elements to print.

 REVISION HISTORY:

	@(#)head.pro	1.1 06/04/95
       Originally written by Terry Slocum,  University of 
       California at Berkeley, Space Sciences Lab.   Sep. '91

</PRE><P>
<STRONG>(See <A href="fa_ops/head.pro">general/missions/fast/fa_ops/head.pro</A>)</STRONG><P>
<HR>
 
<A NAME="HELPFAST">
<H2>HELPFAST</H2></A>
<A HREF="#HEAD">[Previous Routine]</A>
<A HREF="#HIST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	helpfast
PURPOSE:	Calls netscape and brings up our on_line help.  One of the pages
		accessed by this on_line help provides documentation on all of
		our procedures and is updated daily. The other is a
		list of Data Quantity Descriptor (DQD) strings
		recognized by SDT, for use in the SDT/IDL
		interface. Use: 

                    http://sprg.ssl.berkeley.edu/~fastsw/fastidl.html
               
               The links to view the source code will not work when
               the pages are accessed in this way, unfortunately. 
 

INPUT:		none
KEYWORDS:	
	MOSAIC:	if set uses mosaic instead of netscape

CREATED BY:	Jasper Halekas (Wind)
STOLEN BY: Bill Peria (FAST)
 MODIFIED BY: Jon Loran (FAST also)
FILE:   helpfast.pro
VERSION:  1.0
LAST MODIFICATION: @(#)helpfast.pro	1.6 10/07/99
</PRE><P>
<STRONG>(See <A href="fa_ops/helpfast.pro">general/missions/fast/fa_ops/helpfast.pro</A>)</STRONG><P>
<HR>
 
<A NAME="HIST">
<H2>HIST</H2></A>
<A HREF="#HELPFAST">[Previous Routine]</A>
<A HREF="#HIST_NORM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: HIST

 PURPOSE: To actually produce a histogram plot. This is a radical
          departure from the IDL HISTOGRAM function, which is for
          something else, as far as anyone can tell. The default
          binsize is set such that the middle two quartiles of the
          data land in five bins.

 CALLING SEQUENCE: hist, my_data

 INPUTS: MY_DATA - an array of numerical values. Can be multi-D, but
         can't be complex. 
       
 KEYWORD PARAMETERS: Everything you can pass to IDL's HISTOGRAM
                     function can be passed to HIST. Also, any
                     keyword accepted by the PLOT procedure will be
                     passed thru as well. In addition to that, HIST
                     has these keywords:

                     XBINS - a named variable in which the centers of
                             the histogram bins can be returned to
                             the caller.

                     HIST - a named variable in which the histogram
                            itself can be returned. 

                     SIGMA - Error bar for the bins...sqrt(hist)

                     NO_PLOT - if set, the histogram is not
                               plotted. By default, a plot is made. 

                     NO_ERROR - if set, prevents error bars from
                                being drawn on the plot.

                     QUIET - suppresses some warnings
 
                    
 SIDE EFFECTS: The amount of redundant coding when looking at
               histograms is drastically reduced. 

 EXAMPLE: To see how SOME_DATA are distributed, using a text-only
          terminal at 300 Baud, do this: 

           hist, some_data, /no_plot, xbins = bins, hist = hist 
           for i=0,n_elements(bins)-1 do print,bins[i],hist[i]

 MODIFICATION HISTORY: written about 10 years late, by Bill Peria. 

</PRE><P>
<STRONG>(See <A href="fa_ops/hist.pro">general/missions/fast/fa_ops/hist.pro</A>)</STRONG><P>
<HR>
 
<A NAME="HIST_NORM">
<H2>HIST_NORM</H2></A>
<A HREF="#HIST">[Previous Routine]</A>
<A HREF="#ICON_CROSSING_IDL5">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: HIST_NORM

 PURPOSE: To compute and plot a normalized histogram. By default, a
          plot with error bars is made. 

 INPUTS: DATA - the stuff you want to histogram
       
 KEYWORD PARAMETERS: HIST_NORM takes all the keywords of IDL
                     HISTOGRAM. Keywords accepted by PLOT, such as
                     titles and the like, may also be
                     passed. HIST_NORM also has these keywords:

         CONDITION - A byte array, of the same size as DATA, which is
                     either 1 (true) or 0 (false). The histogram of
                     those elements of DATA where CONDITION is 1 is
                     divided by the histogram of all elements of
                     DATA, to form a normalized histogram. CONDITION
                     must be defined, otherwise calling HIST_NORM
                     makes no sense.

         COMPLEMENT - if set, causes the histogram where CONDITION is
                      true to be normalized by the histogtram where
                      CONDITION is false. 

         XBINS - named variable in which the bin centers can be
                 returned. 

         NO_PLOT - if set, inhibits display of the normalized
                   histogram

         NPOINTS - The minimum number of points per bin for which the
                   normalized histogram is considered computed. The
                   default is 0.

         SHOW_NUMBERS - if set, causes the number of points per bin
                        to be displayed on the histogram plot. 

         NO_ERROR - if set, inhibits the display of error bars. 

         SIGMA - a named variable in which the bin standard
                 deviations can be returned.

 EXAMPLE: hist_norm, density, condition = (wavepower gt .001), $
             title='Density dependence of wave power'

    This will show the likelihood of wave power greater than .001, as
 a function of density. 

 MODIFICATION HISTORY: Written in early 1999, by Bill Peria

</PRE><P>
<STRONG>(See <A href="fa_ops/hist_norm.pro">general/missions/fast/fa_ops/hist_norm.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ICON_CROSSING_IDL5">
<H2>ICON_CROSSING_IDL5</H2></A>
<A HREF="#HIST_NORM">[Previous Routine]</A>
<A HREF="#INREAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	icon_crossing_idl5.pro

PURPOSE:	
	Add a small plot to the summary plots showing the auroral region and
	the path of FAST.  This procedure must use IDL 5 or greater
	due to a bug in earlier versions.

KEYWORDS:
	ORBIT:	The orbit number
	SOUTH:  Set this keyword to plot the south polar region.  The default
               is the north polar region.

CREATED BY:   Sandra Wittenbrock
ADAPTED FROM: plot_fa_crossing.pro by J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/icon_crossing_idl5.pro">general/missions/fast/fa_ops/icon_crossing_idl5.pro</A>)</STRONG><P>
<HR>
 
<A NAME="INREAL">
<H2>INREAL</H2></A>
<A HREF="#ICON_CROSSING_IDL5">[Previous Routine]</A>
<A HREF="#INT_UP_TO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: INREAL

 PURPOSE: To obtain a floating point number from the keyboard.

 CALLING SEQUENCE: x = inreal(prompt,default)
 
 INPUTS: PROMPT - a string that tells the user what to type. You must
         provide this string, sorry, there's no default.

 OPTIONAL INPUTS: DEFAULT - a value to be used if the user just hits
                  return in response to PROMPT. The default for
                  DEFAULT is zero.

 OUTPUTS: X - if the user manages to type something that can be
          parsed as a real number, then that number gets returned in
          X. 

 EXAMPLE: gain = inreal('What is the gain?',1.0)

 MODIFICATION HISTORY: Written before the dawn of time by Bill Peria,
                       documented 14-May-1997. 

</PRE><P>
<STRONG>(See <A href="fa_ops/inreal.pro">general/missions/fast/fa_ops/inreal.pro</A>)</STRONG><P>
<HR>
 
<A NAME="INT_UP_TO">
<H2>INT_UP_TO</H2></A>
<A HREF="#INREAL">[Previous Routine]</A>
<A HREF="#ISIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: INT_UP_TO

 PURPOSE: Computes the succesive definite integrals of an array 

 CALLING SEQUENCE: int = int_up_to(time,data)
 
 INPUTS: TIME - the independent variable 
         DATA - dependent variable


 KEYWORDS: ADAMS - if set, uses the somewhat more accurate
           Adams-Bashforth two-step method. 

                    /time
 OUTPUTS: INT =     |        data*d(time)
                    /time(0)


 RESTRICTIONS: You must make sure about things like sufficient
               resolution, etc., because no error estimate or sorting
               or anything of the kind is done, and the area under
               the curve between adjacent points is approximated by a
               trapezoid. 

 MODIFICATION HISTORY: written long, long ago by Bill Peria. Finally
                       documented 16-March-1997. 

</PRE><P>
<STRONG>(See <A href="fa_ops/int_up_to.pro">general/missions/fast/fa_ops/int_up_to.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ISIN">
<H2>ISIN</H2></A>
<A HREF="#INT_UP_TO">[Previous Routine]</A>
<A HREF="#IS_LEAP_YEAR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
        ISIN.PRO

 DESCRIPTION:

 	Function to return an array of values in array &quot;a&quot; that are inclusive
 	of array &quot;b&quot;.  We assume that array's &quot;a&quot; and &quot;b&quot; are of the same type.
 	If no matchs are found, -1 is returned

 USAGE:
 
 	result = ISIN (a, b)

 ARGUMENTS:
	a 	First array to search
	b 	Second array to search

 REVISION HISTORY:

	@(#)isin.pro	1.1 06/04/95       
       Originally written by Jonathan M Loran,  University of 
       California at Berkeley, Space Sciences Lab.   Oct. '91

</PRE><P>
<STRONG>(See <A href="fa_ops/isin.pro">general/missions/fast/fa_ops/isin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="IS_LEAP_YEAR">
<H2>IS_LEAP_YEAR</H2></A>
<A HREF="#ISIN">[Previous Routine]</A>
<A HREF="#JE_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: is_leap_year

 PURPOSE: determine if a given year (or array of years) is leap

 INPUTS:     
     year:
         year is an int or long or an array of ints or longs
     
 OUTPUTS:
     return value is a byte (or byte array of same size as year if year is array)
     value is 1 for each year that is a leap year

 CREATED BY: Vince Saba, 9/96

 VERSION: @(#)is_leap_year.pro	1.1 10/02/96
</PRE><P>
<STRONG>(See <A href="fa_ops/is_leap_year.pro">general/missions/fast/fa_ops/is_leap_year.pro</A>)</STRONG><P>
<HR>
 
<A NAME="JE_2D">
<H2>JE_2D</H2></A>
<A HREF="#IS_LEAP_YEAR">[Previous Routine]</A>
<A HREF="#JE_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	je_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned energy flux, JEz, ergs/cm^2-sec
NOTES:	
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-4-22		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/je_2d.pro">general/missions/fast/fa_ops/je_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="JE_2D_B">
<H2>JE_2D_B</H2></A>
<A HREF="#JE_2D">[Previous Routine]</A>
<A HREF="#JE_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	je_2d_b(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned energy flux, JEz, ergs/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Similar to je_2d.pro, treats the anodes within 5 deg of the magnetic field differently.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	97-5-14		Created from je_2d.pro
					Treats narrow beams correctly, no do loops
LAST MODIFICATION:
	97-5-14		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/je_2d_b.pro">general/missions/fast/fa_ops/je_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="JE_2D_FS">
<H2>JE_2D_FS</H2></A>
<A HREF="#JE_2D_B">[Previous Routine]</A>
<A HREF="#J_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	je_2d_fs(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_ies, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned energy flux, JEz, ergs/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Same as je_2d_b.pro, accept separates 64 angle fast survey data 
		for FAST to do a more accurated calculation.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
		time series data for &quot;tplot.pro&quot;.
	Note that the EBINS, ARANGE, and BINS keywords below may not work 
		properly since their meaning changes with 32 or 64 angle bins.

CREATED BY:
	J.McFadden	97-8-13		Treats FAST fast survey narrow beams correctly, calls je_2d_b.pro
LAST MODIFICATION:
	97-8-13		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/je_2d_fs.pro">general/missions/fast/fa_ops/je_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="J_2D">
<H2>J_2D</H2></A>
<A HREF="#JE_2D_FS">[Previous Routine]</A>
<A HREF="#J_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	j_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned flux, Jz, #/cm^2-sec
NOTES:	
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-4-22		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/j_2d.pro">general/missions/fast/fa_ops/j_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="J_2D_B">
<H2>J_2D_B</H2></A>
<A HREF="#J_2D">[Previous Routine]</A>
<A HREF="#J_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	j_2d_b(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned flux, Jz, #/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Similar to j_2d.pro, treats the anodes within 5 deg of the magnetic field differently.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	97-5-14		Created from j_2d.pro
					Treats narrow beams correctly, no do loops
LAST MODIFICATION:
	97-5-14		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/j_2d_b.pro">general/missions/fast/fa_ops/j_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="J_2D_FS">
<H2>J_2D_FS</H2></A>
<A HREF="#J_2D_B">[Previous Routine]</A>
<A HREF="#KILLSDT0">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	j_2d_fs(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_ies, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the field aligned flux, Jz, #/cm^2-sec, assumes a narrow (&lt; 5 deg) field aligned beam.
NOTES:	
	Same as j_2d_b.pro, accept separates 64 angle fast survey data 
		for FAST to do a more accurated calculation.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
		time series data for &quot;tplot.pro&quot;.
	Note that the EBINS, ARANGE, and BINS keywords below may not work 
		properly since their meaning changes with 32 or 64 angle bins.

CREATED BY:
	J.McFadden	97-8-2		Treats FAST fast survey narrow beams correctly, calls j_2d_b.pro
LAST MODIFICATION:
	97-8-2		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/j_2d_fs.pro">general/missions/fast/fa_ops/j_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="KILLSDT0">
<H2>KILLSDT0</H2></A>
<A HREF="#J_2D_FS">[Previous Routine]</A>
<A HREF="#KILLSDT_ALL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
This program kills SDT (assuming there is only one running, which
should always be the case) and can be called from a shell script,
removes the lock file, so that the process can restart cleanly next time
</PRE><P>
<STRONG>(See <A href="fa_ops/killsdt0.pro">general/missions/fast/fa_ops/killsdt0.pro</A>)</STRONG><P>
<HR>
 
<A NAME="KILLSDT_ALL">
<H2>KILLSDT_ALL</H2></A>
<A HREF="#KILLSDT0">[Previous Routine]</A>
<A HREF="#KILL_RKL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
This program kills SDT (assuming there is only one running, which
should always be the case) and can be called from a shell script,
removes the lock file, so that the process can restart cleanly next time
</PRE><P>
<STRONG>(See <A href="fa_ops/killsdt_all.pro">general/missions/fast/fa_ops/killsdt_all.pro</A>)</STRONG><P>
<HR>
 
<A NAME="KILL_RKL">
<H2>KILL_RKL</H2></A>
<A HREF="#KILLSDT_ALL">[Previous Routine]</A>
<A HREF="#LEGENDRE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
  KILL_RKL
  Read a file of csh-style lines like:
      set &quot;RKL = `kill -9 12345`&quot;
  and execute the command inside the backticks using IDL's SPAWN.

  Usage:
      KILL_RKL, 'commands.txt'              ; executes
      KILL_RKL, 'commands.txt', /DRYRUN     ; just prints what it would do
      KILL_RKL, 'commands.txt', LOG=log     ; returns vector of log lines

  Notes:
  - Blank lines and lines starting with # are ignored.
  - If a line has no backticks, its skipped.
  - Captures shell output and exit status per command.
</PRE><P>
<STRONG>(See <A href="fa_ops/kill_rkl.pro">general/missions/fast/fa_ops/kill_rkl.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LEGENDRE">
<H2>LEGENDRE</H2></A>
<A HREF="#KILL_RKL">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_ACF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 returns the Legendre polynomials in SVDFIT ready form.
</PRE><P>
<STRONG>(See <A href="fa_ops/legendre.pro">general/missions/fast/fa_ops/legendre.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_ACF">
<H2>LOAD_FA_K0_ACF</H2></A>
<A HREF="#LEGENDRE">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_DCF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_acf
PURPOSE:	
	Load summary data from the FAST AC fields instrument into TPLOT
	structures. Up to eight TPLOT quantities are stored, namely VLF
	E, VLF E POWER, VLF B POWER, VLF B, HF E, HF B, HF E POWER, HF
	B POWER. 

	
INPUT:	
	none 
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set, 
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'
	trange		trange[2], time range used to get files from index list
	indexfile	string, complete path name for indexfile of times and filenames
				Used if trange is set.
				Default = indexfiledir+'/fa_k0_acf_file'
				indexfiledir = '$FAST_CDF_MAST_DIR' 
	orbit		int, orbit for file load
	var		strarr(n) of cdf variable names

	default=['VLF_E_SPEC','VLF_PWR','VLF_B_SPEC','HF_E_SPEC','HF_PWR', $
         'HF_B_SPEC','ELF_E_SPEC','ELF_B_SPEC','ELF_PWR','MODEBAR']


	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
                       default = ['VLF_E_FREQ','','VLF_B_FREQ','HF_E_FREQ','','HF_B_FREQ',
                       'ELF_E_FREQ','ELF_B_FREQ','','VMBAR']


CREATED BY:	J. McFadden 96-9-8
 modified for fields  B. Peria 96-10-7

</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_acf.pro">general/missions/fast/fa_ops/load_fa_k0_acf.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_DCF">
<H2>LOAD_FA_K0_DCF</H2></A>
<A HREF="#LOAD_FA_K0_ACF">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_EES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_dcf
PURPOSE:	
	Load summary data from the FAST DC fields instrument into TPLOT
	structures. Up to eight TPLOT quantities are stored, namely
	EX, EZ, DENSITY, BX, BY, BZ, S/C POTENTIAL, SPIN ANGLE, and MODEBAR. 
	
INPUT:	
	none 
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set, 
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'
	trange		trange[2], time range used to get files from index list
	indexfile	string, complete path name for indexfile of times and filenames
				Used if trange is set.
				Default = indexfiledir+'/fa_k0_dcf_file'
				indexfiledir = '$FAST_CDF_MAST_DIR' 
	orbit		int, orbit for file load
	var		strarr(n) of cdf variable names
             default is ['EX','EZ','DENSITY','BX','BY','BZ','S/C POTENTIAL','SPIN ANGLE']

	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
			default=['','','','','','']

CREATED BY:	J. McFadden 96-9-8
 modified for fields  B. Peria 96-10-7

</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_dcf.pro">general/missions/fast/fa_ops/load_fa_k0_dcf.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_EES">
<H2>LOAD_FA_K0_EES</H2></A>
<A HREF="#LOAD_FA_K0_DCF">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_EES_DAY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_ees
PURPOSE:	
	Load summary data from the FAST electron experiment into tplot structure.

		Loads el_0	electon energy spectrogram, 0-30 pitch angle 
		Loads el_90	electon energy spectrogram, 60-120 pitch angle 
		Loads el_180	electon energy spectrogram, 150-180 pitch angle 
		Loads el_low	electon pitch angle spectrogram, .1-1 keV energy 
		Loads el_high	electon pitch angle spectrogram, &gt; 1 keV energy 
		Loads JEe	electon energy flux - mapped to 100 km, positive earthward 
		Loads Je	electon particle flux  - mapped to 100 km, positive earthward
	
INPUT:	
	none 
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set, 
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'
	trange		trange[2], time range used to get files from index list
	indexfile	string, complete path name for indexfile of times and filenames
				Used if trange is set.
				Default = indexfiledir+'/fa_k0_ees_files'
				indexfiledir = '$CDF_INDEX_DIR' 
	orbit		int, intarr, orbit(s) for file load
	var		strarr(n) of cdf variable names
			default=['el_0','el_90','el_180','el_low','el_high','JEe','Je']
	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
			default=['el_en','el_en','el_en','el_low_pa','el_high_pa','','']
	nodata		returns 1 if no data is found

CREATED BY:	J. McFadden 96-9-8
LAST MODIFICATION:  97-04-03
MOD HISTORY:
		96-09-24	corrections
		97-03-04	get_fa_orbit call changed
		97-03-13	orbit keyword can be an array, version number check
		97-03-25	added label to Je,JEe
		97-04-03	can load daily cdf files with &quot;unix_time&quot; rather than &quot;TIME&quot;
		97-04-15	added no_orbit, nodata keywords; loads &quot;MODEBAR&quot;
				
</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_ees.pro">general/missions/fast/fa_ops/load_fa_k0_ees.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_EES_DAY">
<H2>LOAD_FA_K0_EES_DAY</H2></A>
<A HREF="#LOAD_FA_K0_EES">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_IES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_ees_day
PURPOSE:	
	Load daily summary data from the FAST electron experiment into tplot structure.

		Loads el_0	electon energy spectrogram, 0-30 pitch angle 
		Loads el_90	electon energy spectrogram, 60-120 pitch angle 
		Loads el_180	electon energy spectrogram, 150-180 pitch angle 
		Loads el_low	electon pitch angle spectrogram, .1-1 keV energy 
		Loads el_high	electon pitch angle spectrogram, &gt; 1 keV energy 
		Loads JEe	electon energy flux - mapped to 100 km, positive earthward 
		Loads Je	electon particle flux  - mapped to 100 km, positive earthward

		Loads Attitude and Orbit data from the cdf file
	
INPUT:	
	filename	string, filename of daily cdf file to be loaded
				File is obtained from &quot;dir&quot; if dir is set, 
				otherwise file obtained from local dir.
KEYWORDS:
	dir		string, directory where filename can be found
	var		strarr(n) of cdf variable names
			default=['el_0','el_90','el_180','el_low','el_high','JEe','Je']
	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
			default=['el_en','el_en','el_en','el_low_pa','el_high_pa','','']

CREATED BY:	J. McFadden 97-04-18
LAST MODIFICATION:  97-04-18
MOD HISTORY:
</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_ees_day.pro">general/missions/fast/fa_ops/load_fa_k0_ees_day.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_IES">
<H2>LOAD_FA_K0_IES</H2></A>
<A HREF="#LOAD_FA_K0_EES_DAY">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_IES_DAY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_ies
PURPOSE:	
	Load summary data from the FAST ion experiment into tplot structure.

		Loads ion_0	ion energy spectrogram, 0-30 pitch angle 
		Loads ion_90	ion energy spectrogram, 40-140 pitch angle 
		Loads ion_180	ion energy spectrogram, 150-180 pitch angle 
		Loads ion_low	ion pitch angle spectrogram, .05-1 keV energy 
		Loads ion_high	ion pitch angle spectrogram, &gt; 1 keV energy 
		Loads JEi	ion energy flux - mapped to 100 km, positive earthward 
		Loads Ji	ion particle flux - mapped to 100 km, positive earthward 
	
INPUT:	
	none 
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set, 
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'
	trange		trange[2], time range used to get files from index list
	indexfile	string, complete path name for indexfile of times and filenames
				Used if trange is set.
				Default = indexfiledir+'/fa_k0_ies_files'
				indexfiledir = '$CDF_INDEX_DIR' 
	orbit		int, intarr, orbit(s) for file load
	var		strarr(n) of cdf variable names
			default=['ion_0','ion_90','ion_180','ion_low','ion_high','JEi','Ji']
	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
			default=['ion_en','ion_en','ion_en','ion_low_pa','ion_high_pa','','']

CREATED BY:	J. McFadden 96-9-8
LAST MODIFICATION:	97-04-03
MOD HISTORY:
		96-09-24	corrections
		97-03-04	get_fa_orbit call changed
		97-03-13	orbit keyword can be an array, version number check
		97-03-25	added label to Ji,JEi
		97-04-03	can load daily cdf files with &quot;unix_time&quot; rather than &quot;TIME&quot;
</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_ies.pro">general/missions/fast/fa_ops/load_fa_k0_ies.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_IES_DAY">
<H2>LOAD_FA_K0_IES_DAY</H2></A>
<A HREF="#LOAD_FA_K0_IES">[Previous Routine]</A>
<A HREF="#LOAD_FA_K0_TMS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_ies_day
PURPOSE:	
	Load daily summary data from the FAST ion experiment into tplot structure.

		Loads ion_0	ion energy spectrogram, 0-30 pitch angle 
		Loads ion_90	ion energy spectrogram, 40-140 pitch angle 
		Loads ion_180	ion energy spectrogram, 150-180 pitch angle 
		Loads ion_low	ion pitch angle spectrogram, .05-1 keV energy 
		Loads ion_high	ion pitch angle spectrogram, &gt; 1 keV energy 
		Loads JEi	ion energy flux - mapped to 100 km, positive earthward 
		Loads Ji	ion particle flux - mapped to 100 km, positive earthward 

		Loads Attitude and Orbit data from the cdf file
	
INPUT:	
	none 
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set, 
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'

CREATED BY:	J. McFadden 97-04-03
LAST MODIFICATION:  97-04-03
MOD HISTORY:
</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_ies_day.pro">general/missions/fast/fa_ops/load_fa_k0_ies_day.pro</A>)</STRONG><P>
<HR>
 
<A NAME="LOAD_FA_K0_TMS">
<H2>LOAD_FA_K0_TMS</H2></A>
<A HREF="#LOAD_FA_K0_IES_DAY">[Previous Routine]</A>
<A HREF="#MAKE5SEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	load_fa_k0_tms
PURPOSE:
	Load summary data from the FAST TEAMS experiment into tplot structure.

	Loads H+ 	Hydrogen Differential Energy Flux vs Energy, 0-360    deg pitch angle
	Loads He+ 	Helium Differential Energy Flux vs Energy, 0-360    deg pitch angle
	Loads O+	Oxygen   Differential Energy Flux vs Energy, 0-360  deg pitch angle
	Loads H+_low	Hydrogen Differential Energy Flux vs Pitch Angle, .01-1 keV
	Loads H+_high	Hydrogen Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Loads He+_low	Helium Differential Energy Flux vs Pitch Angle, .01-1 keV
	Loads He+_high	Helium Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Loads O+_low	Oxygen   Differential Energy Flux vs Pitch Angle, .01-1 keV
	Loads O+_high	Oxygen   Differential Energy Flux vs Pitch Angle, &gt; 1 keV
	Loads hm	MassSpectrum Counts Rate vs Mass, 1eV - 12keV, 4*Pi angles

INPUT:
	none
KEYWORDS:
	filenames	strarr(m), string array of filenames of cdf files to be entered
				Files are obtained from &quot;dir&quot; if dir is set,
					otherwise files obtained from local dir.
				If filenames not set, then orbit or trange keyword must
					be set.
	dir		string, directory where filenames can be found
				If dir not set, default is &quot;environvar&quot; or local directory
	environvar	string, name of environment variable to set &quot;dir&quot;
				Used if filenames not set
				Default environvar = '$FAST_CDF_HOME'
	trange		trange[2], time range used to get files from index list
	indexfile	string, complete path name for indexfile of times and filenames
				Used if trange is set.
				Default = indexfiledir+'/fa_k0_tms_files'
				indexfiledir = '$CDF_INDEX_DIR'
	orbit		int, orbit for file load
	var		strarr(n) of cdf variable names
			default=['H+','He+','O+','H+_low','H+_high','He+_low',$
				'He+_high','O+_low','O+_high']
	dvar		strarr(n) of cdf dependent variable names
			set dvar(n)='' if no dependent variable for variable
			dvar must be same dimension as var
			default=['H+_en','He+_en','O+_en','H+_low_pa',$
				'H+_high_pa','He+_low_pa','He+_high_pa',$
				'O+_low_pa','O+_high_pa']

	tplot		if set, loads hm data from &quot;filenames&quot;.tplot
			*.tplot files are assumed to be in the cdf dir

CREATED BY:	J. McFadden 96-10-6
VERSION: 1.03
LAST MODIFICATION:	97-06-04
MODIFICATION HISTORY:
		97-06-04	added He+ to cdf's
		97-03-25	get_fa_orbit call changed
		97-03-25	orbit keyword can be an array, version number check
</PRE><P>
<STRONG>(See <A href="fa_ops/load_fa_k0_tms.pro">general/missions/fast/fa_ops/load_fa_k0_tms.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAKE5SEC">
<H2>MAKE5SEC</H2></A>
<A HREF="#LOAD_FA_K0_TMS">[Previous Routine]</A>
<A HREF="#MAKE_ARRAY_STRUC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: MAKE5SEC

 PURPOSE: To obtain data with 5 second time resolution from
          tplot-like structures. 2-nearest-neighbor linear interpolation is
          performed to obtain the data. 


 CALLING SEQUENCE: make5sec,data
 
 INPUTS: DATA: a tplot-like structure, which must contain a TIME tag
         and one or more COMP* tags. 


 KEYWORD PARAMETERS: DATA_TAGS: used to pass in an array of tag names
                     containing data for conversion to 5 second
                     resolution. If not set, then COMP* tags will be
                     used. 

                     OVERWRITE: if set, causes in-place conversion
                                 of the original data. This is
                                 probably much faster for large
                                 structures. 

                     TAG_TYPE: used to pass in an alternate tag type,
                               for example DATA instead of COMP. 

                     TIME_BIN: used to pass in an alternate time
                               resolution, instead of the default 5.0
                               seconds.

                     TZERO: if non-zero, then the first time in the
                            reduced resolution timetags will be
                            DATA.START_TIME + TZERO, instead of just
                            DATA.START_TIME. 

                     GAPS:  used to pass in an array of indices which
                           refer to the beginning of time gaps in the
                           original data. If set and of the correct
                           type, 5-second times which fall in the
                           gaps will be set to NAN. 

                     IGNORE_GAPS: if set, causes find_gaps to be
                                  called, and 5 second times in the
                                  gaps will be set to NAN. 

                     TIMES_ONLY: if set, prevents interpolation of
                                 the data, and merely returns a
                                 reduced resolution time
                                 column. Believe it or not, this can
                                 be useful. 

                     SPIN_PHASE: if defined, then this value is used
                                 to generate the time column, rather
                                 than TZERO or TIME_BIN. The times
                                 where phase is equal to SPIN_PHASE
                                 (in degrees) will be selected. 

                     RAW_PHASE:  if set, and SPIN_PHASE is defined,
                                causes SPIN_PHASE to be interpreted
                                in units of (degrees * 360/1024). 

                     GIVEN_TIMES: an array of times to use, probably
                                  generated from a spin phase quantity.

 OUTPUTS: The DATA structure is returned, with the 5 second data in
          either the COMP* tags, the DATA_TAGS tags, or some new
          *_5 tags. 

 SIDE EFFECTS: Addition of *_5 tags, *OR* overwriting of COMP*
               tags. Also a tag (FIVE_SEC) indicating success of the
               conversion is added.

 MODIFICATION HISTORY: Written 26-July-1996 by Bill Peria

</PRE><P>
<STRONG>(See <A href="fa_ops/make5sec.pro">general/missions/fast/fa_ops/make5sec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAKE_ARRAY_STRUC">
<H2>MAKE_ARRAY_STRUC</H2></A>
<A HREF="#MAKE5SEC">[Previous Routine]</A>
<A HREF="#MAKE_DATA_DOUBLE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	make_array_struct
PURPOSE:	
	Makes an array of structures from input function, output used by get_array_struc.pro
INPUT:		
	data_str, 	a string (either 'eh','pl','fa_eesa_surv','fa_ess', ...)
			where get_'string' returns a 2D or 3D 
			data structure
KEYWORDS:		

CREATED BY:	J.McFadden
VERSION:	1
LAST MODIFICATION:  96-11-7	McFadden
MOD HISTORY:

NOTES:	  
	Used to make an array of structures that is called by get_array_struc.pro
	Current version only works for FAST
	Written to speed up summary plot production for ees and ies
</PRE><P>
<STRONG>(See <A href="fa_ops/make_array_struc.pro">general/missions/fast/fa_ops/make_array_struc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAKE_DATA_DOUBLE">
<H2>MAKE_DATA_DOUBLE</H2></A>
<A HREF="#MAKE_ARRAY_STRUC">[Previous Routine]</A>
<A HREF="#MAKE_FA_ESA_STRUCT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PRO: MAKE_DATA_DOUBLE, dat

 PURPOSE: Converts data.comp* to double. Written for MagAC data. 
 Can be used for any standard dqd. 

 CALLING: make_data_double(dat)
 	   Pretty simple! 

 INPUTS: A valid data structure.
       
 KEYWORD PARAMETERS:  	NONE!

 OUTPUTS: Makes data.comp* into double.

 INITIAL VERSION: REE 96_11_06
 REVISED: REE 97_10_20. Fixed bug on multiple components.
 MODIFICATION HISTORY: 
 Space Sciences Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/make_data_double.pro">general/missions/fast/fa_ops/make_data_double.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAKE_FA_ESA_STRUCT">
<H2>MAKE_FA_ESA_STRUCT</H2></A>
<A HREF="#MAKE_DATA_DOUBLE">[Previous Routine]</A>
<A HREF="#MAKE_QUALITY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:  make_fa_esa_struct

 PURPOSE:

	Build an esa dat structure given dimentions

 CALLING SEQUENCE:

	dat=make_fa_esa_struct(dimsizes)
 
 INPUTS:

	dimsizes:	a two (or three) dimensional array

 OUTPUTS:

	A structure of the following format is returned:

	   DATA_NAME     STRING    'data name'         ; Data Quantity name
	   VALID         INT       1                   ; Data valid flag
 	   PROJECT_NAME  STRING    'FAST'              ; project name
 	   UNITS_NAME    STRING    'Counts'            ; Units of this data
 	   UNITS_PROCEDURE  STRING 'proc'              ; Units conversion proc
	   TIME          DOUBLE    8.0118726e+08       ; Start Time of sample
	   END_TIME      DOUBLE    7.9850884e+08       ; End time of sample
	   INTEG_T       DOUBLE    3.0000000           ; Integration time
	   NBINS         INT       nbins               ; Number of angle bins
	   NENERGY       INT       nnrgs               ; Number of energy bins
	   DATA          FLOAT     Array(nnrgs, nbins) ; Data qauantities
	   ENERGY        FLOAT     Array(nnrgs, nbins) ; Energy steps
	   THETA         FLOAT     Array(nnrgs, nbins) ; Angle for bins
	   GEOM          FLOAT     Array(nbins)        ; Geometry factor
	   DENERGY       FLOAT     Array(nnrgs, nbins) ; Energies for bins
	   DTHETA        FLOAT     Array(nbins)        ; Delta Theta
	   EFF           FLOAT     Array(nnrgs)        ; Efficiency (GF)
	   MASS          DOUBLE    5.68566e-6          ; Particle Mass
	   GEOMFACTOR    DOUBLE    0.000147            ; Bin GF
	   HEADER_BYTES  BYTE      Array(44)	       ; Header bytes
	   INDEX         LONG      idx                 ; Index in sdt buffers

 MODIFICATION HISTORY:
	@(#)make_fa_esa_struct.pro	1.1 05/30/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   May '97

</PRE><P>
<STRONG>(See <A href="fa_ops/make_fa_esa_struct.pro">general/missions/fast/fa_ops/make_fa_esa_struct.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAKE_QUALITY">
<H2>MAKE_QUALITY</H2></A>
<A HREF="#MAKE_FA_ESA_STRUCT">[Previous Routine]</A>
<A HREF="#MATFROMBAS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: make_quality

 PURPOSE: create a quality flag for use in a CDF from a
          representation of a set of variables

 DETAILS:
     When dealing with a set of variables that are all time-based
     arrays, based on the same time array, one simple notion of data
     quality is that quality = 0 for those times for which all data
     variables have defined values, and quality = 255 for any time
     for which one or more variables have a value for which 1 or more
     components are missing or invalid.  This routine is used to
     generate such a simple form of quality flag.

 INPUTS:     
     data:
         a structure of the following form:
     
         data = {dummy1: {name:'time', value:time}, $
                 dummy2: {name:'var1', value:var1}, $
                 dummy3: {name:'var2', value:var2}, $
                 dummy4: {name:'var3', value:var3}}

         that is used to represent the data to be written to a CDF file.
         The values of the 'name' fields are the names of the
         variables, and the values of the 'value' fields are the
         values of the variables.  The first field of 'data' is an
         array of times, and the other variables are all arrays based
         on this time array.  See makecdf2.pro for more details.
         Some of the values may contain missing or invalid values.
         Missing or invalid values are signified either by NaN, or by
         the following special values that are used by CHDF CDF files
         as FILLVAL's.

                 type            FILLVAL
                 ----            -------
                 BYTE            -128
                 INT2            -32768
                 INT4            -2147483648
                 REAL4           -1.0e31
                 REAL8           -1.0d31

         Any value containing either NaN or the appropriate above
         FILLVAL for the type is considered either missing or otherwise 
         invalid.

 OUTPUT:
     return value: the return value (which we will call 'quality'
     here), is an byte array of the same size as the time array from
     'data'.  That is, n_elements(quality) =
     n_elements(data.(0).value).  Also, quality(i) = 0 if all the
     variables are defined and present for the ith time value, and
     quality(i) = 255 if any of the variables contain a NaN or
     FILLVAL for the ith time value.

 VERSION: @(#)make_quality.pro	1.3 05/03/99
</PRE><P>
<STRONG>(See <A href="fa_ops/make_quality.pro">general/missions/fast/fa_ops/make_quality.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MATFROMBAS">
<H2>MATFROMBAS</H2></A>
<A HREF="#MAKE_QUALITY">[Previous Routine]</A>
<A HREF="#MAXWELLIAN_1">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Form the matrix for transforming components expressed in OLD system
 to NEW system...all six basis vectors must be expressed in the same
 system, although it doesn't matter what that system is.
</PRE><P>
<STRONG>(See <A href="fa_ops/matfrombas.pro">general/missions/fast/fa_ops/matfrombas.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MAXWELLIAN_1">
<H2>MAXWELLIAN_1</H2></A>
<A HREF="#MATFROMBAS">[Previous Routine]</A>
<A HREF="#MCP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE: maxwellian_1,x,a,f,pder,units=units,mass=mass,index=ind
PURPOSE:
	Procedure returns maxwellian function f(x,a) and df/da, where f=a0*exp(a1*x), x-vector of energies.
INPUTS:
	x	fltarr(n)	array of energy values
	a	dblarr(2)	array of function parameters
	f	dblarr(n)	array of function values to be returned 
	pder	dblarr(n,2)	array of partial derivative, df/da returned 

KEYWORDS:
	UNITS	string		units for function (df,eflux,flux), def='df' 
	INDEX	intarr(2)	indexes used for estimate of &quot;a&quot;
				if set, returns initial estimate of &quot;a.&quot; 
				call before calling curvefit.pro

NOTES:
	see funct_fit2d.pro
	see curvefit.pro
	see maxwellian_2.pro, maxwellian_3.pro

CREATED BY:	J. McFadden  96-11-14
FILE:  maxwellian_1.pro
VERSION 1.
LAST MODIFICATION: mcfadden 97-10-16	
MOD HISTORY:
		97-5		delory	 
		97-10-16	mcfadden	mass in common 
</PRE><P>
<STRONG>(See <A href="fa_ops/maxwellian_1.pro">general/missions/fast/fa_ops/maxwellian_1.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MCP">
<H2>MCP</H2></A>
<A HREF="#MAXWELLIAN_1">[Previous Routine]</A>
<A HREF="#MD_DIMS_OK">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       MCP

 PURPOSE:
       MCP (Map CDF Parameter) is used to map (look up) the numeric value
       associated with the (IDL) variables defined in `cdf.pro'.  MCP would
       be used in those cases where it is not possible to include `cdf.pro'
       (by executing `@cdf.pro' at the IDL command line) because of the limit
       on the number of local variable which may exist in a function/procedure
       (as imposed by IDL).

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       value = MCP (name)

 INPUTS:
       name:           STRING.  Symbolic name of the parameter whose value
                       is desired.

 OUTPUTS:
       value:          LONG.  The associated value.

 EXAMPLE:
       IDL&gt; numDims = 1L
       IDL&gt; dimSizes = lonarr(1)
       IDL&gt; dimSizes(0) = 100L
       IDL&gt; status = CDFcreate ('flux1', numDims, dimSizes, $
       IDL&gt;                     MCP('HOST_ENCODING'), MCP('ROW_MAJOR'), id)
       IDL&gt; if (status lt MCP('CDF_WARN')) print, 'CDFcreate failed.'

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       23-Aug-93        Original version.
       26-Jun-95        IDL 4.0.
       21-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/mcp.pro">general/missions/fast/fa_ops/mcp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MD_DIMS_OK">
<H2>MD_DIMS_OK</H2></A>
<A HREF="#MCP">[Previous Routine]</A>
<A HREF="#MII">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 MD_DIMS_OK

 DESCRIPTION:


	function to check that the array descriptors have the correct
	number of elements.  This function assumes that all dimensions
	should have array descriptors.

	
 CALLING SEQUENCE:

 	ok = md_dims_ok(dat)

 ARGUMENTS:

	dat		the structure returned from the
			get_md_from_sdt routine.

 RETURN VALUE:

	Upon success, 1 is returned, else 0

 REVISION HISTORY:

	@(#)md_dims_ok.pro	1.1 09/04/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '96
</PRE><P>
<STRONG>(See <A href="fa_ops/md_dims_ok.pro">general/missions/fast/fa_ops/md_dims_ok.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MII">
<H2>MII</H2></A>
<A HREF="#MD_DIMS_OK">[Previous Routine]</A>
<A HREF="#MINMAX_RANGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       MII

 PURPOSE:
       MII (Map Internal Interface) is used to map (look up) the numeric value
       associated with the (IDL) variables defined in `cdf2.pro'.  MII would
       be used in those cases where it is not possible to include `cdf2.pro'
       (by executing `@cdf2.pro' at the IDL command line) because of the
       limit on the number of local variable which may exist in a function
       or procedure (as imposed by IDL).

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       value = MII (name)

 INPUTS:
       name:           STRING.  Symbolic name of the Internal Interface
                       parameter whose value is desired.

 OUTPUTS:
       value:          LONG.  The associated value.

 EXAMPLE:
       IDL&gt; format = MCP('SINGLE_FILE')
       IDL&gt; status = CDFlib (MII('OPEN_'), MII('CDF_'), 'rain1', id, $
       IDL&gt;                  MII('GET_'), MII('CDF_FORMAT_'), format, $
       IDL&gt;                  MII('NULL_'))
       IDL&gt; if (status lt MCP('CDF_WARN')) print, 'CDFlib failed.'

       Note that `MCP' is used to map the CDF parameters in `cdf.pro'.

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       23-Aug-93        Original version.
       26-Jun-95        IDL 4.0.
       21-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/mii.pro">general/missions/fast/fa_ops/mii.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MINMAX_RANGE">
<H2>MINMAX_RANGE</H2></A>
<A HREF="#MII">[Previous Routine]</A>
<A HREF="#MISSING_DQDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:   minmax_range,array 
PURPOSE:  returns a two element array of min, max values
INPUT:  array
KEYWORDS:
  MAX_VALUE:  ignore all numbers greater than this value
  MIN_VALUE:  ignore all numbers less than this value
  POSITIVE:   forces MINVALUE to 0

CREATED BY:	Davin Larson
LAST MODIFICATION:	@(#)minmax_range.pro	1.4 95/11/07
</PRE><P>
<STRONG>(See <A href="fa_ops/minmax_range.pro">general/missions/fast/fa_ops/minmax_range.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MISSING_DQDS">
<H2>MISSING_DQDS</H2></A>
<A HREF="#MINMAX_RANGE">[Previous Routine]</A>
<A HREF="#MISSING_TAGS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: missing_dqds


 PURPOSE: to check a SDT session for a set of required dqds


 CALLING SEQUENCE: missing = missing_dqds(required_dqds)

 
 INPUTS: REQ_DQDS_CALL: a string or string array of dqds to look for in the
         SDT session.


 KEYWORDS: The keyword ABSENT can be used to return the mising tag
           names. If no dqds are missing, ABSENT contains the null
           string on return. 
           QUIET can be used to get MISSING_DQDS to not report
           missing dqds to the user.

 OUTPUTS: The number of missing dqds is returned. A -1 is returned if
           MISSING_DQDS was called incorrectly.

 MODIFICATION HISTORY: Written 19-August-1997 by Bill Peria, UCBerkeley
                       Space Sciences Lab

</PRE><P>
<STRONG>(See <A href="fa_ops/missing_dqds.pro">general/missions/fast/fa_ops/missing_dqds.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MISSING_TAGS">
<H2>MISSING_TAGS</H2></A>
<A HREF="#MISSING_DQDS">[Previous Routine]</A>
<A HREF="#MONTHYRFROM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: missing_tags


 PURPOSE: to check a structure for a set of required tags


 CALLING SEQUENCE: missing = missing_tags(my_structure,required_tags)

 
 INPUTS: REQ_TAGS_CALL: a string or string array of tags to look for in the
         structure STRUCT.  


 KEYWORDS: The keyword ABSENT can be used to return the mising tag
           names. If no tags are missing, ABSENT contains the null
           string on return. 
           QUIET can be used to get MISSING_TAGS to not report
           missing tags to the user.

 OUTPUTS: The number of missing tags is returned. A -1 is returned if
           MISSING_TAGS was called incorrectly.

 MODIFICATION HISTORY: Written 23-July-1996 by Bill Peria, UCBerkeley
                       Space Sciences Lab

</PRE><P>
<STRONG>(See <A href="fa_ops/missing_tags.pro">general/missions/fast/fa_ops/missing_tags.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MONTHYRFROM">
<H2>MONTHYRFROM</H2></A>
<A HREF="#MISSING_TAGS">[Previous Routine]</A>
<A HREF="#MSC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 MONTHYRFROM

 DESCRIPTION:

	 Function to build an array of strings of the format:
 
	'YR-MN-1' 

	given a start time in seconds since 1970.  

	The date in each string increases monotonically, in the specified
	number of months increments for the number of strings requested, 
	from the start time given.

 	Input parameters are the time to start the strings in seconds 
	since 1970, Jan 1, 00:00, the number of strings to output, and
	the number of months to increment by.


 USAGE (SAMPLE CODE FRAGMENT):
 
    ; set an array of strings to month and year date representions

	date_strings = monthyrfrom(16156800.0,8,2)  ; 8 dates, in 2 month
	                                            ; increments, starting at 
                                                   ; 7 Jul 1970 0:0:0.00
    ; output result

	PRINT, date_strings

 --- Sample output would be

	70-7-1 70-9-1 70-11-1 70-1-1 70-3-1 70-5-1 70-7-1 70-9-1

 NOTES:

 	The start time in seconds is normally a float type, though
	this isn't necessary.

	If the input start time is negitive, this is an error, and the string
	'ERROR' is returned.

	If an array of start times is given, then a two dimensional array
	of dimensions (n_dates,N_ELEMENTS(inputs vals)) of stings will 
	be returned.

	the increment can have any sign.

	This routine calls the function &quot;secdate&quot;.

 REVISION HISTORY:

	@(#)monthyrfrom.pro	1.3 08/18/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Feb. '92

</PRE><P>
<STRONG>(See <A href="fa_ops/monthyrfrom.pro">general/missions/fast/fa_ops/monthyrfrom.pro</A>)</STRONG><P>
<HR>
 
<A NAME="MSC">
<H2>MSC</H2></A>
<A HREF="#MONTHYRFROM">[Previous Routine]</A>
<A HREF="#NAN_GAP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       MSC

 PURPOSE:
       MSC (Map Status Code) is used to map (look up) the numeric value
       associated with the (IDL) variables defined in `cdf1.pro'.  MSC would
       be used in those cases where it is not possible to include `cdf1.pro'
       (by executing `@cdf1.pro' at the IDL command line) because of the
       limit on the number of local variable which may exist in a function
       or procedure (as imposed by IDL).

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       value = MSC (name)

 INPUTS:
       name:           STRING.  Symbolic name of the status code whose value
                       is desired.

 OUTPUTS:
       value:          LONG.  The associated value.

 EXAMPLE:
       IDL&gt; status = CDFopen ('flux1', id)
       IDL&gt; if (status lt MCP('CDF_WARN')) print, 'CDFopen failed.'
       IDL&gt; if (status eq MSC('NO_SUCH_CDF')) print, 'No such CDF.'

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       23-Aug-93        Original version.
       26-Jun-95        IDL 4.0.
       21-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/msc.pro">general/missions/fast/fa_ops/msc.pro</A>)</STRONG><P>
<HR>
 
<A NAME="NAN_GAP">
<H2>NAN_GAP</H2></A>
<A HREF="#MSC">[Previous Routine]</A>
<A HREF="#NOISE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 A program to insert NaN's into an X array whenever there is a gap
 larger then GAP_SIZE in the T array. The X point beginning and
 ending each gap is lost. This compensates for a feature of TPLOT,
 where spectrograms are interpolated 1/2 way back to the previous
 NaN. 

 Bill Peria 29-April-1999

</PRE><P>
<STRONG>(See <A href="fa_ops/nan_gap.pro">general/missions/fast/fa_ops/nan_gap.pro</A>)</STRONG><P>
<HR>
 
<A NAME="NOISE">
<H2>NOISE</H2></A>
<A HREF="#NAN_GAP">[Previous Routine]</A>
<A HREF="#NORMN3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: NOISE, dqd_name



 PURPOSE: Produces the DSP noise level for a dqd. This is the noise
 	   limit due to the ADC and DSP/ or SFA - NOT the sensor! 

 CALLING: dat = NOISE(dqd_name)
 	   Pretty simple! 
                         

 INPUTS: A valid SDT dqd name such as 'Dsp_V5-V8HG'
       
 KEYWORD PARAMETERS:  	BASE: The minimum value.

 OUTPUTS: A IDL data structure.

 SIDE EFFECTS: Does not include sensor noise.

 INITIAL VERSION: REE 96_11_01
 MODIFICATION HISTORY: 
 Space Scienes Lab, UCBerkeley
 
</PRE><P>
<STRONG>(See <A href="fa_ops/noise.pro">general/missions/fast/fa_ops/noise.pro</A>)</STRONG><P>
<HR>
 
<A NAME="NORMN3">
<H2>NORMN3</H2></A>
<A HREF="#NOISE">[Previous Routine]</A>
<A HREF="#NOTIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 Normalizes vectors, must be n by 3. 
</PRE><P>
<STRONG>(See <A href="fa_ops/normn3.pro">general/missions/fast/fa_ops/normn3.pro</A>)</STRONG><P>
<HR>
 
<A NAME="NOTIN">
<H2>NOTIN</H2></A>
<A HREF="#NORMN3">[Previous Routine]</A>
<A HREF="#N_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	notin

 PURPOSE:
 	Function to return an array of values in array &quot;a&quot; that are exclusive
 	of array &quot;b&quot;.  We assume that array's &quot;a&quot; and &quot;b&quot; are of the same type.

 CALLING SEQUENCE:
	c = notin (a, b)

 ARGUMENTS:
	a 	First array to search
	b 	Second array to search

 SIDE EFFECTS:
	none

 INPUTS:
	two arrays: a and b both of the same type.
	
 MODIFICATION HISTORY:

	@(#)notin.pro	1.1 06/04/95
	Written By Jonathan Loran, UCB Feb. 25 '92
</PRE><P>
<STRONG>(See <A href="fa_ops/notin.pro">general/missions/fast/fa_ops/notin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="N_2D">
<H2>N_2D</H2></A>
<A HREF="#NOTIN">[Previous Routine]</A>
<A HREF="#N_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	n_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the density, n, 1/cm^3
NOTES:	
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-4-22		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/n_2d.pro">general/missions/fast/fa_ops/n_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="N_2D_B">
<H2>N_2D_B</H2></A>
<A HREF="#N_2D">[Previous Routine]</A>
<A HREF="#N_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	n_2d_b(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the density, n, 1/cm^3, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Similar to n_2d.pro, treats the anodes within 5 deg of the magnetic field differently.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	97-7-11		Created from j_2d_b.pro
					Treats narrow beams correctly, no do loops
LAST MODIFICATION:
	97-7-11		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/n_2d_b.pro">general/missions/fast/fa_ops/n_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="N_2D_FS">
<H2>N_2D_FS</H2></A>
<A HREF="#N_2D_B">[Previous Routine]</A>
<A HREF="#PARSEEPOCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	n_2d_fs(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_ies, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the density, n, 1/cm^3, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Same as n_2d_b.pro, accept separates 64 angle fast survey data 
		for FAST to do a more accurated calculation.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
		time series data for &quot;tplot.pro&quot;.
	Note that the EBINS, ARANGE, and BINS keywords below may not work 
		properly since their meaning changes with 32 or 64 angle bins.

CREATED BY:
	J.McFadden	97-8-13		Treats FAST fast survey narrow beams correctly, calls n_2d_b.pro
LAST MODIFICATION:
	97-8-13		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/n_2d_fs.pro">general/missions/fast/fa_ops/n_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PARSEEPOCH">
<H2>PARSEEPOCH</H2></A>
<A HREF="#N_2D_FS">[Previous Routine]</A>
<A HREF="#PDQPLOT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       parseEPOCH

 PURPOSE:
       `parseEPOCH' is used to parse a CDF_EPOCH value from the standard
       EPOCH character string.

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       epoch = parseEPOCH (epString)

 INPUTS:
       epString:       STRING.  The standard EPOCH character string.  The
                       syntax of this string is `dd-mmm-yyyy hh:mm:ss.ccc'
                       where `dd' is the day of the month (1-31), `mmm' is
                       the month (`Jan', `Feb', `Mar', `Apr', `May', `Jun',
                       `Jul', `Aug', `Sep', `Oct', `Nov', or `Dec'), `yyyy'
                       is the year, `hh' is the hour (0-23), `mm' is the
                       minute (0-59), `ss' is the second (0-59), and `ccc'
                       is the millisecond (0-999).

       All input variables must have been created/initialized before calling
       `parseEPOCH'.

 OUTPUTS:
       epoch:          DOUBLE (double precision floating-point).  The
                       parsed CDF_EPOCH value.

       All output variables are (re)created/assigned by `parseEPOCH'.

 EXAMPLE:
       IDL&gt; epString = '04-Jan-1956 11:34:55.010'
       IDL&gt; epoch = parseEPOCH (epString)

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       24-Jan-94        Original version.
        1-Nov-94        CDF V2.5.
       26-Jun-95        IDL 4.0.
       16-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/parseepoch.pro">general/missions/fast/fa_ops/parseepoch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PDQPLOT">
<H2>PDQPLOT</H2></A>
<A HREF="#PARSEEPOCH">[Previous Routine]</A>
<A HREF="#PLOT_FA_ATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: PDQPLOT



 PURPOSE: to make quick line plots of quantities in FA_FIELDS
          structures, mostly for debugging purposes.

 CALLING SEQUENCE: pdqplot,DATA

 INPUTS: DATA is a structure which has a TIME tag and some COMP*
 tags. The data in the COMP tags will be plotted vs. the TIME tags.

 SIDE EFFECTS: plot(s) appear in the default window. The plot(s) will
 begin from time = 0, defined as the earliest time in DATA. 

 EXAMPLE: v14 = get_fa_fields('V1-V4_S',/all)
          pdqplot,v14

 MODIFICATION HISTORY: written pdq, 16-July-1996 by Bill Peria

</PRE><P>
<STRONG>(See <A href="fa_ops/pdqplot.pro">general/missions/fast/fa_ops/pdqplot.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_FA_ATT">
<H2>PLOT_FA_ATT</H2></A>
<A HREF="#PDQPLOT">[Previous Routine]</A>
<A HREF="#PLOT_FA_K0_EES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

 plot_fa_att.pro

 PURPOSE:

   Displays the orientation of the FAST spacecraft.  Shows model
   magnetic field, spacecraft velocity, and Sun direction in the s/c
   spin plane.  Also tells the angles of these vectors out of the
   spin plane as well as other orbit quantities.

 INPUTS:

   time    String or double float.

 KEYWORDS:

   NOTEXT  Set this to suppress printing of textual info so the output image
           may be used as an icon.
   PS      If set, the name of the output postscript file.
           Preset width of plot is 5 cm, but can be scaled with SCALE.
   SCALE   Scale factor for PS plot width. Default is 1.
   BW      Output is in black and white.
   VECTOR  Use vector-drawn font instead of hardware font.

 NOTES:

   Created: 6-9-97
   Creator: J.Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/plot_fa_att.pro">general/missions/fast/fa_ops/plot_fa_att.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_FA_K0_EES">
<H2>PLOT_FA_K0_EES</H2></A>
<A HREF="#PLOT_FA_ATT">[Previous Routine]</A>
<A HREF="#PLOT_FA_K0_IES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	plot_fa_k0_ees.pro
INPUT:	none

PURPOSE:
	Plots FAST electron key parameter data.

	Plot 1: Electron Differential Energy Flux vs Energy, 0-45    deg pitch angle 
	Plot 2: Electron Differential Energy Flux vs Energy, 45-135  deg pitch angle 
	Plot 3: Electron Differential Energy Flux vs Energy, 135-180 deg pitch angle 
	Plot 4: Electron Differential Energy Flux vs Pitch Angle, &lt; 1 keV  
	Plot 5: Electron Differential Energy Flux vs Pitch Angle, &gt; 1 keV  
	Plot 6: Electron Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Electron Flux - mapped to 100 km, positive earthward  

KEYWORDS

NOTES:	
	Run load_fa_k0_ees.pro first to get the k0 data

CREATED BY:	J.McFadden		96-9-24
VERSION:	1
LAST MODIFICATION:  97-03-25
MOD HISTORY:	
	97-03-04	color=4 used for positive (earthward) Ji,JEi; color=6 used for negative Ji,JEi
				upgrade for Ji,JEi definition changes - mapped to 100 km now
	97-3-25		Lists multiple orbit numbers in title	
</PRE><P>
<STRONG>(See <A href="fa_ops/plot_fa_k0_ees.pro">general/missions/fast/fa_ops/plot_fa_k0_ees.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_FA_K0_IES">
<H2>PLOT_FA_K0_IES</H2></A>
<A HREF="#PLOT_FA_K0_EES">[Previous Routine]</A>
<A HREF="#PLOT_FA_K0_TMS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	plot_fa_k0_ies.pro
INPUT:	none

PURPOSE:
	Plots FAST ion key parameter data.

	Plot 1: Ion Differential Energy Flux vs Energy, 0-45    deg pitch angle 
	Plot 2: Ion Differential Energy Flux vs Energy, 45-135  deg pitch angle 
	Plot 3: Ion Differential Energy Flux vs Energy, 135-180 deg pitch angle 
	Plot 4: Ion Differential Energy Flux vs Pitch Angle, &lt; 1 keV  
	Plot 5: Ion Differential Energy Flux vs Pitch Angle, &gt; 1 keV  
	Plot 6: Ion Energy Flux - mapped to 100 km, positive earthward  
	Plot 7: Ion Flux - mapped to 100 km, positive earthward  

KEYWORDS

NOTES:	
	Run load_fa_k0_ies.pro first to get the k0 data

CREATED BY:	J.McFadden		96-9-24
VERSION:	1
LAST MODIFICATION:  97-03-25
MOD HISTORY:	
	97-03-04	color=4 used for positive (earthward) Ji,JEi; color=6 used for negative Ji,JEi
				upgrade for Ji,JEi definition changes - mapped to 100 km now
	97-3-25		Lists multiple orbit numbers in title	
</PRE><P>
<STRONG>(See <A href="fa_ops/plot_fa_k0_ies.pro">general/missions/fast/fa_ops/plot_fa_k0_ies.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_FA_K0_TMS">
<H2>PLOT_FA_K0_TMS</H2></A>
<A HREF="#PLOT_FA_K0_IES">[Previous Routine]</A>
<A HREF="#PLOT_ORBIT2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:	plot_fa_k0_tms.pro
INPUT:	none

PURPOSE:
	Plots FAST TEAMS key parameter data.

	Plot 1: Hydrogen Differential Energy Flux vs Energy, 0-360    deg pitch angle 
	Plot 2: Oxygen   Differential Energy Flux vs Energy, 0-360  deg pitch angle 
	Plot 3: Hydrogen Differential Energy Flux vs Pitch Angle, &lt; 1 keV  
	Plot 4: Hydrogen Differential Energy Flux vs Pitch Angle, &gt; 1 keV  
	Plot 5: Oxygen   Differential Energy Flux vs Pitch Angle, &lt; 1 keV  
	Plot 6: Oxygen   Differential Energy Flux vs Pitch Angle, &gt; 1 keV  
	Plot 7: MassSpectrum Counts Rate vs Mass, 1eV - 12keV, 4*Pi angles

KEYWORDS

NOTES:	
	Run load_fa_k0_tms.pro first to get the k0 data

CREATED BY:	J.McFadden		96-10-7
VERSION:	1
LAST MODIFICATION:  97-3-25
MOD HISTORY:
	97-3-25		Checks for &quot;hm&quot; data and includes it in plot if it exists
	97-3-25		Lists multiple orbit numbers in title	
</PRE><P>
<STRONG>(See <A href="fa_ops/plot_fa_k0_tms.pro">general/missions/fast/fa_ops/plot_fa_k0_tms.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_ORBIT2">
<H2>PLOT_ORBIT2</H2></A>
<A HREF="#PLOT_FA_K0_TMS">[Previous Routine]</A>
<A HREF="#PLOT_PO_OVERLAY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:    plot_orbit2, data_name
PURPOSE:   To do an xyplot of orbital or other data
INPUT:      String associated with spacecraft position data quantity. 
      Default is 'GSE_pos_def'.  (see &quot;get_orbit&quot;) 
KEYWORDS:   
   ZPLOT:    will produce an x-z plot, rather than x-y
   BOW:      structure that determines bow shock parameters.
   FREQ:     if set will draw a star every freq days
   INIT_FREQ:    first date to label. (date string: yy-mm-dd)
   DATE_LAB: if set will label a date every date_lab days
   INIT_DATE_LAB:  first date to start labeling. (date string: yy-mm-dd)
   LIMITS:   A limit structure that defines plot limits. 
          (see &quot;OPTIONS&quot;, &quot;XLIM&quot; or &quot;YLIM&quot;)
   TRANGE:   Two element vector of time values giving the time range. 
          (see &quot;GETTIME&quot;)
   DAT3D:   A data structure that contains some of the following:
        magf:   3 components of magnetic field.
        sc_pos: 3 components of spacecraft position.
        vsw:    3 components of solar wind velocity.
   NOCOLOR:  Plot everything in black and white.   
   

Written by: Davin Larson    95-9-12
Modified from xyplot.pro by Jasper Halekas.
Modified by J. McFadden to work better with FAST
Modified 00-08-14 by J. McFadden replacing plot_pos.pro with plot_positions.pro
FILE: plot_orbit2.pro
VERSION:  1.13
LAST MODIFICATION: 96/04/17
</PRE><P>
<STRONG>(See <A href="fa_ops/plot_orbit2.pro">general/missions/fast/fa_ops/plot_orbit2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_PO_OVERLAY">
<H2>PLOT_PO_OVERLAY</H2></A>
<A HREF="#PLOT_ORBIT2">[Previous Routine]</A>
<A HREF="#PLOT_TMS_COUNTS[1]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:     PLOT_PO_OVERLAY

 PURPOSE:       Plots the orbit of the POLAR spacecraft over the
                existing map display.  The plot timespan is acquired
                through the keyword TIME_ARRAY.

 KEYWORDS:

   TIME_ARRAY   The time array for which to get POLAR orbit data.  If
                EXPAND is set, only the first and last elements of
                this array are used.
   EXPAND       Expands the timespan.  The new timespan will be:
                new = (2*[expand] + 1)*old
                If this keyword is NOT set, then POLAR orbit data is
                calculated for the same times as the preloaded data.

   TAG_COLOR    The color of the time stamps.
   FLAT         A named variable to receive POLAR footprint latitudes
   FLNG         A named variable to receive POLAR footprint longitudes

 CREATED:       97-8-25
                By J. Rauchleiba

</PRE><P>
<STRONG>(See <A href="fa_ops/plot_po_overlay.pro">general/missions/fast/fa_ops/plot_po_overlay.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_TMS_COUNTS[1]">
<H2>PLOT_TMS_COUNTS[1]</H2></A>
<A HREF="#PLOT_PO_OVERLAY">[Previous Routine]</A>
<A HREF="#PLOT_TMS_COUNTS[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROGRAM    (main program, a few functions down....)
       plot_tms_counts

DESCRIPTION
       function to calculate velocity of ions in a 2-D mag-field referenced system
       and to plot each count as an individual symbol in polar angle-energy plot.
       (The program also contains a presently non-functional option to do v_x-v_y plots.) 
       In order not to have a number of symbols covering each other, each count is plotted
       at a random position within the (energy,angle) acceptance range of a pixel.
       There are various options to be entered intereactively by typing, all with defaults.
        These include norm=1 to correct for the projection effect when the acceptance
        range of teams covers  

       A structure of the following format is used: 
                 DATA_NAME       STRING    'Tms Burst All'
                 TIMES           DOUBLE    Array(76)
                 END_TIMES       DOUBLE    Array(76)
                 DATA            FLOAT     Array(48, 16, 4, 76)
                 ENERGY          DOUBLE    Array(48, 76)
                 THETA           FLOAT     Array(16, 76)
                 THETA_FOV       FLOAT     Array(16, 76)
                 SPHASE          INT       Array(76)
                 SNUMBER         BYTE      Array(76)
                 MAGDIR          INT       Array(76)
                 MASS            FLOAT     Array(4)
                 GEOMFACTOR      FLOAT        0.00150000
                 HEADER_BYTES    BYTE      Array(44, 76)
                 HDR_TIME        DOUBLE    Array(76)
                 EFF_VERSION     FLOAT           1.00000

CALLING SEQUENCE
       plot__tms_counts, dat

ARGUMENTS
       dat              data structure in plot_dists.sav

KEYWORDS

RETURN VALUE

REVISION HISTORY
       Written by Jennifer Law, Cheryl Kang, and Tim Lee
       July 18, 1997
       Repeatedly modified by m. boehm, last aug 25, 1997
LAST MODIFICATION


</PRE><P>
<STRONG>(See <A href="fa_ops/plot_tms_counts.pro">general/missions/fast/fa_ops/plot_tms_counts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="PLOT_TMS_COUNTS[2]">
<H2>PLOT_TMS_COUNTS[2]</H2></A>
<A HREF="#PLOT_TMS_COUNTS[1]">[Previous Routine]</A>
<A HREF="#POLY_OUT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION
       logtick

 DESCRITPION
 very specific routine for formatting labels on a  logarithmic
 polar dist fn plot. The values are expected to run -5 to 5.
 Absolute valeus of these values are taken, and they are then
 regarded as log base 10 of the energy, with an offset such that
 0 represents 0.0001 keV. The actual labeling in keV is to start at
 .01 keV (input value 2) and run upwards to what ever values are presented.
 This is a separate routine only because the [xyz]tickformat graphics 
 keyword requires it.
unction logtick,axis,index,value  ; axis and index exist here because [xyz]tickformat
                                   ; passes them; not used.
ommon pllims,plotlim,plotlim0
ruevalue=exp((abs(value)-4.)*alog(10.))*plotlim0(0) ; plotting is done explcitly
; in log-10 coordinates, with 0 radius corresponding to plotlim0(0)/10. (in eV)
; (alog is natural log, not anti-log; -4 rather than -1 because labeling is in keV, not eV) 
print,truevalue
f abs(value) ge .1 then retstring=string(truevalue,format=&quot;(f6.2)&quot;)
f abs(value) lt .1 then retstring=' '
eturn,retstring
nd


</PRE><P>
<STRONG>(See <A href="fa_ops/plot_tms_counts.pro">general/missions/fast/fa_ops/plot_tms_counts.pro</A>)</STRONG><P>
<HR>
 
<A NAME="POLY_OUT">
<H2>POLY_OUT</H2></A>
<A HREF="#PLOT_TMS_COUNTS[2]">[Previous Routine]</A>
<A HREF="#POWER_SPEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: POLY_OUT

 PURPOSE: Polynomial fit with 3-sigma throw-away. Essentially the
          same as POLY_FIT, which is supplied with IDL.


 CALLING SEQUENCE: c = poly_out(x,y,ndegree)
 
 INPUTS: X - array of independent variables corresponding to Y
         Y - dependent variables
         NDEGREE - order of desired polynomial fit

 OPTIONAL INPUTS: see documentation for IDL routine POLY_FIT.

 OUTPUTS: an array of coefficients for polynomial fit. If NDEGREE is
          2, then Y is approximated best by:
                 y ~ c(0) + c(1)*x + c(2)*x^2

 OPTIONAL OUTPUTS: see documentation for IDL routine POLY_FIT.

 MODIFICATION HISTORY: written October 1996 by Bill Peria, UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/poly_out.pro">general/missions/fast/fa_ops/poly_out.pro</A>)</STRONG><P>
<HR>
 
<A NAME="POWER_SPEC">
<H2>POWER_SPEC</H2></A>
<A HREF="#POLY_OUT">[Previous Routine]</A>
<A HREF="#P_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: POWER_SPEC

 PURPOSE: Transform time series data into averaged frequency power
          spectra using FFT's. Result is the two-sided Power Spectral
          Density (PSD) given in (input units)^2/Hz.

 CALLING SEQUENCE: power_spec, data, n_ave=n_ave, npnts=npts,
                   sample=sample, freq, ave_spec, overlap=overlap

 INPUTS: 
         DATA -     A one-dimensional array containing the values of
                    the time series data for which an average power
                    spectra is desired.

 OUTPUTS:
         FREQ     - An array returned by the routine containing the
                    frequency axis of the power spectra.

         AVE_SPEC -An array returned by the routine containing the
                   amplitudes of the power spectra. The units
                   returned are (input units)^2/Hz. Thus EACH
                   AMPLITUDE in the FFT is divided by the bandwidth
                   in Hz of each frequency interval.

 KEYWORDS:
         OVERLAP - Set this keyword to slide the FFT interval by
                   one-half of an interval instead of averaging
                   together each separate interval. For most data
                   types this will yield a higher number of averages
                   and less error per data point than straight
                   sequential averaging (see below!). Note that N_AVE
                   specifies how many sequential averages are taken
                   without overlap. Thus N_AVE=4 with /OVERLAP yields
                   a total of 7 averages, etc.

         N_AVE -   The number of FFT's to average together within
                   the data series provided. This specifies how many
                   sequential segments in which to divide the
                   data. Setting the /OVERLAP keyword increases the
                   number of segments by 2*N_AVE-1.

         NPNTS -   The number of time series points that each
                   interval will be for the discrete FFT's.

         SAMPLE -   The sample time (in secs) of each time series
                    point. If unspecified, an arbitrary sample time
                    of 1 is assigned to the data.

 EXAMPLE: You have 8192 continuous time series points. You want to
          average together 8 FFT's to obtain a single average spectra
          for this data. Set n_ave = 8, npnts=1024. Result is
          a power_spectra obtained by taking a single FFT of each
          1024 pt sequential interval in the data and averaging them
          together. For the same parameters, if you set /overlap,
          then the interval slides 1/2 and then averages, i.e. an FFT
          is taken of the first 1024 points, then moves forward 512
          points, another FFT, then slide again by 512 points. Thus
          for num_ave = 8 and /overlap, you average together 8+7 = 15
          FFT's for the interval of 8192 points.

    A note about errors:
          For n sequential (non-sliding) averages FFT's have a
          statistical error of 1/n^0.5. For the same time interval,
          if a sliding average is used of 1/2 a window overlap, n
          goes up by a factor of 2 but the errors are no longer
          completely independent -- so the new error per point is
          1/(0.81*N)^0.5 -- but N=2n so there is less error per point
          than in the non-sliding average case. See any of the
          numerical recipes books by Press et al for a complete
          description of this and other aspects of computational FFT's.

    A note about the data:
          Results may not be valid if the number of points per FFT
          (npts) is not 2^j where j = any integer.
          This routine assumes that the input data is continuous and
          that there are no data gaps or bad time points.

 REVISION HISTORY
  ver 1.0 11/15/96 G.T.Delory
  ver 1.1 03/26/97 G.T.Delory
  ver 1.2 04/10/97 G.T.Delory

</PRE><P>
<STRONG>(See <A href="fa_ops/power_spec.pro">general/missions/fast/fa_ops/power_spec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="P_2D">
<H2>P_2D</H2></A>
<A HREF="#POWER_SPEC">[Previous Routine]</A>
<A HREF="#P_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	p_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3
NOTES:	
	Function calls j_2d.pro and n_2d.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-5		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/p_2d.pro">general/missions/fast/fa_ops/p_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="P_2D_B">
<H2>P_2D_B</H2></A>
<A HREF="#P_2D">[Previous Routine]</A>
<A HREF="#P_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	p_2d_b(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3, z along B, off diagonal terms are zero
		assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Similar to p_2d.pro, treats the anodes within 5 deg of the magnetic field differently.
	Function calls j_2d_b.pro and n_2d_b.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	97-8-19		Created from n_2d_b.pro and p_2d.pro
					Treats narrow beams correctly, no do loops
LAST MODIFICATION:
	97-8-19		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/p_2d_b.pro">general/missions/fast/fa_ops/p_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="P_2D_FS">
<H2>P_2D_FS</H2></A>
<A HREF="#P_2D_B">[Previous Routine]</A>
<A HREF="#RAVEN_SUN_POS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	p_2d_fs(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_fa_ees, get_fa_ies, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the pressure tensor, [Pxx,Pyy,Pzz,Pxy,Pxz,Pyz], eV/cm^3, z along B, off diagonal terms are zero
NOTES:	
	Same as p_2d_b.pro, accept separates 64 angle fast survey data 
		for FAST to do a more accurated calculation.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
		time series data for &quot;tplot.pro&quot;.
	Note that the EBINS, ARANGE, and BINS keywords below may not work 
		properly since their meaning changes with 32 or 64 angle bins.

CREATED BY:
	J.McFadden	97-8-20		Treats FAST fast survey narrow beams correctly, calls p_2d_b.pro
LAST MODIFICATION:
	97-8-20		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/p_2d_fs.pro">general/missions/fast/fa_ops/p_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RAVEN_SUN_POS">
<H2>RAVEN_SUN_POS</H2></A>
<A HREF="#P_2D_FS">[Previous Routine]</A>
<A HREF="#READ_ASCII_NONX">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 !!!WARNING!!!

   This procedure is still in its testing phase and should not be
   used yet.

 PROCECURE

   raven_sun_pos

 PURPOSE

   Calculates the position of the Sun using algorithm of Walraven

 INPUT
 
   time

 OUTPUT

   slong
      Longitude of the Sun (deg GEI)
   srasn
      Right ascension of Sun (deg)
   sdec
      Declination of Sun (deg)
   vector
      Normalized coordinates of Sun in GEI

</PRE><P>
<STRONG>(See <A href="fa_ops/raven_sun_pos.pro">general/missions/fast/fa_ops/raven_sun_pos.pro</A>)</STRONG><P>
<HR>
 
<A NAME="READ_ASCII_NONX">
<H2>READ_ASCII_NONX</H2></A>
<A HREF="#RAVEN_SUN_POS">[Previous Routine]</A>
<A HREF="#READ_AU_ULAW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	READ_ASCII_NONX

 PURPOSE:
	Read data from an ASCII file into IDL. (Identical to
	READ_ASCII.PRO except for the absence of one line, which
	allows it to run not connected to an X terminal.)

 CATEGORY:
	Input/Output.

 CALLING SEQUENCE:
	data = READ_ASCII_NONX(file)

 INPUTS:
	file		  - Name of file to read.

 INPUT KEYWORD PARAMETERS:
	record_start	  - 1st sequential &quot;record&quot; (see DESCRIPTION) to read.
			    Default = 0 (the first record of the file).
	num_records	  - Number of records to read.
			    Default = Read up to and including the last record.

	template	  - ASCII file template (e.g., generated by function
			    ASCII_TEMPLATE) describing attributes of the file
			    to read.  Specific attributes contained in the
			    template may be overridden by keywords below.
			    Default = (see the keywords below).

	data_start	  - Number of lines of header to skip.
			    Default (if no template) = 0L.
	delimiter	  - Character that delimits fields.
			    Default (if no template) = '' = use fields(*).loc.
	missing_value	  - Value to replace any missing/invalid data.
			    Default (if no template) = !VALUES.F_NAN.
	comment_symbol	  - String identifying comments
			    (from comment_symbol to the next end-of-line).
			    Default (if no template) = '' = no comments.

    [Note:  The 'fields' keyword has not been implemented yet.]
	fields		  - Descriptions of the data fields, formatted as
                           an array of structures containing the tags:
                              name  = name of the field (string)
                              type  = type of field as returned by SIZE (long)
                              loc   = offset from the beginning of line to
                                      the start of the field (long)
                              group = sequential group the field is in (int)
			    Default (if no template) =
                              {name:'field', type:4L, loc:0L, group:0}.

	verbose		  - If set, print runtime messages.
			    Default = Do not print them.

 OUTPUT KEYWORD PARAMETERS:
	header	  	  - The header read (string array of length
			    data_start).  If no header, empty string returned.

	count		  - The number of records read.

 OUTPUTS:
	The function returns an anonymous structure, where each field in
	the structure is a &quot;field&quot; of the data read (see DESCRIPTION).
	If no records are read, 0 is returned.

 COMMON BLOCKS:
	None.

 SIDE EFFECTS:
	None.

 RESTRICTIONS:
	See DESCRIPTION.

 DESCRIPTION:
	ASCII files handled by this routine consist of an optional header
	of a fixed number of lines, followed by columnar data.  Files may
	also contain comments, which exist between a user-specified comment
	string and the corresponding end-of-line.

	One or more rows of data constitute a &quot;record.&quot;  Each data element
	within a record is considered to be in a different column, or &quot;field.&quot;
	Adjacent fields may be &quot;grouped&quot; into multi-column fields.
	The data in one field must be of, or promotable to, a single
	type (e.g., FLOAT).

 EXAMPLES:
	; Using default file attributes.
	data = READ_ASCII_NONX(file)

	; Setting specific file attributes.
	data = READ_ASCII_NONX(file, DATA_START=10)

	; Using a template to define file attributes.
	data = READ_ASCII_NONX(file, TEMPLATE=template)

	; Using a template to define file attributes,
	; and overriding some of those attributes.
	data = READ_ASCII_NONX(file, TEMPLATE=template, DATA_START=10)

	; Using the ASCII_TEMPLATE GUI to generate a template in place.
	data = READ_ASCII_NONX(file, TEMPLATE=ASCII_TEMPLATE(file))

    [Note:  The 'fields' keyword has not been implemented yet.]
	; An example defining fields by hand.
	fields = REPLICATE({name:'', type:0L, loc:0L, group:0}, 2, 3)
	num = N_ELEMENTS(fields)
	fields(*).name  = 'field' + STRTRIM(STRING(INDGEN(num) + 1), 2)
	fields(*).type  = REPLICATE(4L, num)
	fields(*).loc   = [0L,10L, 0L,15L, 0L,12L]
	fields(*).group = INDGEN(num)
	data = READ_ASCII_NONX(file, FIELDS=fields)

    [Note:  The 'fields' keyword has not been implemented yet.]
	; Another example defining fields by hand.
	void = {sMyStructName, name:'', type:0L, loc:0L, group:0}
	fields = [ [ {sMyStructName, 'frog', (SIZE(''))(1),  0L, 0},   $
	             {sMyStructName, 'bird', (SIZE(0 ))(1), 15L, 1} ], $
	           [ {sMyStructName, 'fish', (SIZE(0.))(1),  0L, 2},   $
	             {sMyStructName, 'bear', (SIZE(0D))(1), 15L, 3} ], $
	           [ {sMyStructName, 'boar', (SIZE(0B))(1),  0L, 4},   $
	             {sMyStructName, 'nerd', (SIZE(OL))(1), 15L, 5} ]  ]
	data = READ_ASCII_NONX(file, FIELDS=fields)

 DEVELOPMENT NOTES:

	- See ???,xxx in the code.

	- Error check input 'delimiter' to be a string (not a byte).

	- Implement the 'fields' keyword.

 MODIFICATION HISTORY:
	AL &amp; RPM, 8/96 - Written.

</PRE><P>
<STRONG>(See <A href="fa_ops/read_ascii_nonx.pro">general/missions/fast/fa_ops/read_ascii_nonx.pro</A>)</STRONG><P>
<HR>
 
<A NAME="READ_AU_ULAW">
<H2>READ_AU_ULAW</H2></A>
<A HREF="#READ_ASCII_NONX">[Previous Routine]</A>
<A HREF="#REDUCE_RESOLUTION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

   read_au_ulaw

 PURPOSE:

   Extracts specifications and sound data from a Sun audio &quot;.au&quot;
   file.

 ARGUMENTS:

   FILE      The file to open.
   DATA      Variable in which to return the sound data.  This will be
             a byte array containing value from 0 to 255.

 KEYWORDS:

   PLAY      Play the sound data on the local audio device once it is
             read.  Sample will loop PLAY times.

   The following keywords are optional.  They return various file
   specs.

   OFFSET    The offset in bytes of the data from the beginning of
             the file. 
   SIZE      The size in bytes of the sound data array
   RATE      The sampling rate.
   CHANNELS  Number of interleaved channels. (1=mono, 2=stereo)
   TEXT      Arbitrary textual description embedded in the file.

 CREATED:

   By Joseph Rauchleiba
   1998/4/22
</PRE><P>
<STRONG>(See <A href="fa_ops/read_au_ulaw.pro">general/missions/fast/fa_ops/read_au_ulaw.pro</A>)</STRONG><P>
<HR>
 
<A NAME="REDUCE_RESOLUTION">
<H2>REDUCE_RESOLUTION</H2></A>
<A HREF="#READ_AU_ULAW">[Previous Routine]</A>
<A HREF="#ROTMAT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: REDUCE_RESOLUTION

 PURPOSE: To reduce obnoxiously large numbers of data points to more
          manageable ones, for applications which don't need such high
          time resolution, like summary plots.

 INPUTS: T is an array of times, X is an array of time-ordered
         data. T_RES is the requested time resolution.

 KEYWORDS: KEPT is a named array in which the indices of the
           surviving elements are returned. These indices are with
           respect to the original T and X, not the reduced
           ones. This is useful for reducing, say all three
           components of a magnetometer...call REDUCE_RESOLUTION with
           the first component, and reduce the other two with the
           KEPT indices. 
 
 OUTPUTS: Again, T and X. On output, the time between adjacent points
          will be between T_RES/2 and T_RES, *except*, of course, in
          gaps, which may already have been considerably larger than
          T_RES.

 SIDE EFFECTS: T and X will be decimated. 

 RESTRICTIONS: None. No input checking is performed either, however. 

 MODIFICATION HISTORY: written 13-Jan-97 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/reduce_resolution.pro">general/missions/fast/fa_ops/reduce_resolution.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ROTMAT">
<H2>ROTMAT</H2></A>
<A HREF="#REDUCE_RESOLUTION">[Previous Routine]</A>
<A HREF="#ROW_TO_COL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:
    ROTMAT,time,geogei,geigse,geigsm,geism,geigsq,geigsr,dgei,rgei,s

PURPOSE:
	generates rotation matrices for coordinate transformations for a given time

     ------------------------------------------------------------------
     ROTMAT generates various rotation matrices for coordinate trans-
            formations for a given instant of time

     INPUT: TIME: in seconds since 1970

     OUTPUT (cf. Russell, Cosm. Electrodyn. 2, 184,
                               1971 for names and definitions)

     matrices: GEOGEI ... GEIGSR = rotation matrices transforming from
               GEO to GEI system etc.; transposed matrix transforms
               from GEI to GEO etc.

     GEO = geographic                  GEI = geoc. equat. inertial
     GSE = geoc. solar ecliptic        GSM = geoc. solar magnetospheric
     SM  = geoc. solar magnetic        GSQ = geoc. solar equatorial
     GSR = y axis as in gsq, z axis = sun's rot. axis,
           earth-sun line in x-z plane

     vectors:  dgei = earth's dipole axis in gei
               rgei = sun's rotation axis in gei
               s    = position of sun (earth-sun line) in gei


</PRE><P>
<STRONG>(See <A href="fa_ops/rotmat.pro">general/missions/fast/fa_ops/rotmat.pro</A>)</STRONG><P>
<HR>
 
<A NAME="ROW_TO_COL">
<H2>ROW_TO_COL</H2></A>
<A HREF="#ROTMAT">[Previous Routine]</A>
<A HREF="#RUN_CMD_FILE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       row_to_col

 PURPOSE:
       `row_to_col' is used to switch the majority of a multi-dimensional
       array from row-major to column-major (the majority expected by IDL).
       This function would be used after reading a buffer of rVariable
       values with `CDFvarHyperGet' from a column-major CDF.

       This function is part of the CDF interface provided with the CDF
       distribution.  IDL also provides its own built-in interface to CDFs.

 CALLING SEQUENCE:
       status = row_to_col (iBuffer, oBuffer, numDims, dimSizes, numBytes, $
                            numRecs)

 INPUTS:
       iBuffer:        DATA TYPE DEPENDENT.  The multi-dimensional array
                       (IDL variable) whose majority is to be reversed.
       numDims:        LONG.  The number of dimensions (in each record).
       dimSizes:       LONG array.  The dimension sizes (in each record).
       numBytes:       LONG.  The number of bytes per value.
       numRecs:        LONG.  The number of CDF records in the buffer.
                       Note that the majority is only changed within each
                       record - the ordering of the records remains the
                       same (the last dimension of the IDL variable is not
                       affected).

       All input variables must have been created/initialized before calling
       `row_to_col'.

 OUTPUTS:
       oBuffer:        DATA TYPE DEPENDENT.  A newly created/recreated IDL
                       variable (with the same dimensionality as `iBuffer')
                       with reversed (column-major) majority.

       status:         LONG.  A completion status code.  CDF_OK indicates
                       success.  The possible status codes are defined by
                       `cdf0x.pro'.

       All output variables are (re)created/assigned by `row_to_col'.

 EXAMPLE:
       Assume that 5 records from an rVariable each with a dimensionality
       of 2:[10,30] have been read from a CDF with column-major majority
       into an IDL variable named `iBuffer' which was created by the
       `CDFvarHyperGet' as `fltarr(10,30,5)'.  If the data type of the
       rVariable was CDF_REAL4 (4-byte floating-point), the majority would
       be reversed as follows...

       IDL&gt; @cdf0x.pro
       IDL&gt; dimSizes = lonarr(2)
       IDL&gt; dimSizes(0) = 10
       IDL&gt; dimSizes(1) = 30
       IDL&gt; status = row_to_col (iBuffer, oBuffer, 2L, dimSizes, 4L, 5L)
       IDL&gt; if (status lt CDFx.CDF_WARN) print, 'row_to_col failed.'

       `oBuffer' would also be created/recreated as `fltarr(10,30,5)' by
       `row_to_col'.

 RESTRICTIONS:
       None.

 REVISION HISTORY:
       13-May-93        Original version.
        7-Nov-94        Fixed example (`lonarr' to `fltarr').
       26-Jun-95        IDL 4.0.
       21-Aug-96        CDF V2.6.
</PRE><P>
<STRONG>(See <A href="fa_ops/row_to_col.pro">general/missions/fast/fa_ops/row_to_col.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_CMD_FILE">
<H2>RUN_CMD_FILE</H2></A>
<A HREF="#ROW_TO_COL">[Previous Routine]</A>
<A HREF="#RUN_DESPIN_TEST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
  RUN_CMD_FILE
  Execute each non-empty, non-comment line in a file as a Unix shell command.

  Format:
    - One command per line.
    - Lines starting with '#' (after trimming leading spaces) are ignored.
    - A trailing backslash '\' at the end of a line joins with the next line.

  Usage:
    RUN_CMD_FILE, 'commands.txt'                       ; execute
    RUN_CMD_FILE, 'commands.txt', /DRYRUN              ; print only
    RUN_CMD_FILE, 'commands.txt', /HALT_ON_ERROR       ; stop on first failure
    RUN_CMD_FILE, 'commands.txt', LOG=log              ; returns log lines
    RUN_CMD_FILE, 'commands.txt', /QUIET               ; suppress PRINT output

  Notes:
    - Commands run under /bin/sh -c &quot;&lt;line&gt;&quot; to allow pipes, redirects, etc.
    - Exit status is captured; 0 = success (per POSIX), nonzero = failure.
</PRE><P>
<STRONG>(See <A href="fa_ops/run_cmd_file.pro">general/missions/fast/fa_ops/run_cmd_file.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_DESPIN_TEST">
<H2>RUN_DESPIN_TEST</H2></A>
<A HREF="#RUN_CMD_FILE">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_DESPIN_E16K">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_despin_test.pro">general/missions/fast/fa_ops/run_despin_test.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_DESPIN_E16K">
<H2>RUN_PROCESS_DESPIN_E16K</H2></A>
<A HREF="#RUN_DESPIN_TEST">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_DESPIN_E4K">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_despin_e16k.pro">general/missions/fast/fa_ops/run_process_despin_e16k.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_DESPIN_E4K">
<H2>RUN_PROCESS_DESPIN_E4K</H2></A>
<A HREF="#RUN_PROCESS_DESPIN_E16K">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_DESPIN_ESV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_despin_e4k.pro">general/missions/fast/fa_ops/run_process_despin_e4k.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_DESPIN_ESV">
<H2>RUN_PROCESS_DESPIN_ESV</H2></A>
<A HREF="#RUN_PROCESS_DESPIN_E4K">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_DESPIN_ESV_LONG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_despin_esv.pro">general/missions/fast/fa_ops/run_process_despin_esv.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_DESPIN_ESV_LONG">
<H2>RUN_PROCESS_DESPIN_ESV_LONG</H2></A>
<A HREF="#RUN_PROCESS_DESPIN_ESV">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_DSP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_despin_esv_long.pro">general/missions/fast/fa_ops/run_process_despin_esv_long.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_DSP">
<H2>RUN_PROCESS_DSP</H2></A>
<A HREF="#RUN_PROCESS_DESPIN_ESV_LONG">[Previous Routine]</A>
<A HREF="#RUN_PROCESS_SFA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_dsp.pro">general/missions/fast/fa_ops/run_process_dsp.pro</A>)</STRONG><P>
<HR>
 
<A NAME="RUN_PROCESS_SFA">
<H2>RUN_PROCESS_SFA</H2></A>
<A HREF="#RUN_PROCESS_DSP">[Previous Routine]</A>
<A HREF="#SDT_DATA_CACHE_DEFS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 FAST_BATCH

 DESCRIPTION:

	This is the fast idl batch processing file.  It is used to
	produce plots for day to day production runs.  It is meant to
	called from sdt.  It runs as the main procedure calling the
	routines which produce plots for the various instruments.
	Sdt would wait till this batch script is complete and then exit.
	   
	
 CALLING SEQUENCE:

 	idl fast_batch

 REVISION HISTORY:

	@(#)fast_batch.pro	1.6 11/11/96
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   July '96
</PRE><P>
<STRONG>(See <A href="fa_ops/run_process_sfa.pro">general/missions/fast/fa_ops/run_process_sfa.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SDT_DATA_CACHE_DEFS">
<H2>SDT_DATA_CACHE_DEFS</H2></A>
<A HREF="#RUN_PROCESS_SFA">[Previous Routine]</A>
<A HREF="#SEARCH_FA_INDEX">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 DEFINITIONS FILE:
 	 SDT_DATA_CACHE_DEFS

 DESCRIPTION:

	Defs for idl caches while getting sdt data.

 REVISION HISTORY:

	@(#)sdt_data_cache_defs.pro	1.1 05/31/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Apr '97
</PRE><P>
<STRONG>(See <A href="fa_ops/sdt_data_cache_defs.pro">general/missions/fast/fa_ops/sdt_data_cache_defs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SEARCH_FA_INDEX">
<H2>SEARCH_FA_INDEX</H2></A>
<A HREF="#SDT_DATA_CACHE_DEFS">[Previous Routine]</A>
<A HREF="#SECDATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
  FUNCTION:         SEARCH_FA_INDEX.PRO

   PURPOSE:         Finds FAST summary plot files associated with a
                    given timespan.  Timespan may be specified by
                    orbit or a pair of dates.  This function searches
                    the FAST index file using a quick algorithm.

                    Returns an array of filenames.  If timespan is
                    specified by orbit, array will contain one
                    filename.  If specified by dates, array will
                    contain all files with timespans that overlap the
                    given timespan.

                    Only the latest version of a file will be
                    returned.  There should be no duplication.

     NOTES:         Assumes index file is well organized.  Columns
                    are of constant width.  Entries are sorted first
                    by orbit number, then version number.

                    Returns [''] if no associated files found.

                    Function will need editing if filename field
                    changes length.

                    Uses environment variable CDF_INDEX_DIR.

 ARGUMENTS:

        T1          Double float or string,  scalar or 2-element
                    array. If scalar, this is the start time.  If
                    this is a 2-element array, start time is T1[0],
                    and end time is T1[1].  Ignored if ORBIT set.
        T2          If T1 is scalar, this is the end time.  Ignored
                    if ORBIT set.

  KEYWORDS:

     ORBIT          The orbit requested.  If unset, must supply 
                    timespan arguments.

     MASTERFILE     Name of a masterfile that contains times and associated 
                    filenames.  Overrides EES,IES,TMS,ACF,DCF keywords.

     EES,IES,TMS,   Set one of these keywords to identify the data
     ACF,DCF        quantity, and thus the index file. Must set one
                    of these or MASTERFILE. 

     EXISTS         Only files that actually exist will be returned.



  EXAMPLES:         files = search_fa_index(orbit=5000, /ies, /exists)
                    files = search_fa_index(t1, t2, master='/path/index_file')


   CREATED:         98/7/31 By J. Rauchleiba
</PRE><P>
<STRONG>(See <A href="fa_ops/search_fa_index.pro">general/missions/fast/fa_ops/search_fa_index.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SECDATE">
<H2>SECDATE</H2></A>
<A HREF="#SEARCH_FA_INDEX">[Previous Routine]</A>
<A HREF="#SECDATETIME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 SECDATE

 DESCRIPTION:

	function to return a date string from the number of seconds since
	1970, Jan. 1 00:00.  Output format is controled by the keyword
	FMT.  This function will return a string in the format:
 	
	FMT=0 		YYYY-MM-DD  		(e.g. &quot;1991-03-21&quot;);   
	FMT NE 0 	DD MMM YY  		(e.g. &quot; 3 Mar 91&quot;);   

	In addition, the remander in seconds of the day are returned through
	the remainder formal, which can be used in a subsiquent call to the 
	function sectime if the full representation of time in date/time is
 	desired.

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	seconds_date = 6.6951720e+08           ; 21 Mar 91, 01:00:00.000
    
    ; convert to string    
    
	date_string = secdate(seconds_date,remainder, FMT=0)
    
    ; print it out
    
	PRINT, date_string, remainder

 --- Sample output would be 
    
	1991-03-21, 3600.
    
 KEYWORDS:

	FMT	Controls the output string format.  See description above.

 NOTES:

	The seconds and remainder parameters should be double precision.

	If seconds is given negitive, this is an error and the string 'ERROR' is 
	returned.

	If seconds is greater than 5e9, this is past the year 2100,
	and this is considered an error, and 'ERROR' is returned. 
	(I hope this code doesn't last past the year 2100!)

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings and remainders will be returned.

 	Credits: adapted from The C Programming Lanuage, by Kernighan and 
 	Ritchie, 2nd Ed. page 111

 REVISION HISTORY:

	@(#)secdate.pro	1.6 02/10/97 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Jan. '91
 
 	Revised to check for time too large.  Before it would
	go into a rediculously long loop finding the year.
</PRE><P>
<STRONG>(See <A href="fa_ops/secdate.pro">general/missions/fast/fa_ops/secdate.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SECDATETIME">
<H2>SECDATETIME</H2></A>
<A HREF="#SECDATE">[Previous Routine]</A>
<A HREF="#SECTIME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 SECDATETIME

 DESCRIPTION:

	function to return a date-time string from the number of seconds since
	1970, Jan. 1 00:00.  Output format is controled by the keyword
	FMT.  This function will return a string in the format:
 	
	FMT=0 	 YYYY-MM-DD/HH:MM:SS.MSC   (e.g. &quot;1991-03-21/10:35:22.156&quot;);   
	FMT NE 0 DD MMM YY HH:MM:SS.MSC    (e.g. &quot; 3 Mar 91 10:35:22.156&quot;);   

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	seconds_date_time = 6.6951720e+08           ; 21 Mar 91, 01:00:00.000
    
    ; convert to string    
    
	date_time_string = secdatetime(seconds_date_time FMT=0)
    
    ; print it out
    
	PRINT, date_time_string

 --- Sample output would be 
    
	1991-03-21/10:35:22.156
    
 KEYWORDS:

	FMT	Controls the output string format.  See description above.

 NOTES:

	The seconds parameter should be double precision.

	If seconds is given negitive, this is an error and the string 'ERROR'
	is returned.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings will be returned.

	This function relies upon the secdate and sectime functions

 	Credits: adapted from The C Programming Lanuage, by Kernighan and 
 	Ritchie, 2nd Ed. page 111

 REVISION HISTORY:

	@(#)secdatetime.pro	1.1 07/26/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jul. '95
</PRE><P>
<STRONG>(See <A href="fa_ops/secdatetime.pro">general/missions/fast/fa_ops/secdatetime.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SECTIME">
<H2>SECTIME</H2></A>
<A HREF="#SECDATETIME">[Previous Routine]</A>
<A HREF="#SELECT_RANGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 SECTIME

 DESCRIPTION:

	function to return a time string from time of day given in seconds---
	Given an input time in the seconds of the day, this function will
	return a string in the format:

		HH:MM:SS.MSC

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds of the day

	seconds_day = 43200.00           ; 12 noon    
    
    ; convert to string    
    
	time_string = sectime(seconds_day)
    
    ; print it out
    
	PRINT, time_string

 --- Sample output would be 
    
	12:00:00.000
    

 NOTES:

	The seconds parameter should be of a floating point type (i.e float
	or double)                                                                  

	If the input is greater than 86400. (24 hours), time will be subtracted
	in 24 hour chunks, until the time is less than 24 hours.

	If seconds is given negative, this is an error and the string 'ERROR' is     
	returned.                                                                    

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of time strings will be returned.


 REVISION HISTORY:

	@(#)sectime.pro	1.2 06/30/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Dec. '91
       Added &quot;carry&quot; to seconds, S. Claflin, June, 97.
</PRE><P>
<STRONG>(See <A href="fa_ops/sectime.pro">general/missions/fast/fa_ops/sectime.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SELECT_RANGE">
<H2>SELECT_RANGE</H2></A>
<A HREF="#SECTIME">[Previous Routine]</A>
<A HREF="#SERIES_COMPRESS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: SELECT_RANGE

 PURPOSE: to obtain the indices where an array's values lie in a
          specified range. 

 CALLING SEQUENCE: indices = select_range(array, range_min,
                                          range_max, n_in_range)
 
 INPUTS: ARRAY - any type but structure, string, or complex. 
         RANGE_MIN - the minimum value of the desired range. 
         RANGE_MAX - the maximum value of the desired range. 

 OUTPUTS: INDICES - a longword array of the indices, if any are in
          range, or -1L if not. 

 OPTIONAL OUTPUTS: N_IN_RANGE - the number of points found in the
                   range. 

 EXAMPLE: comfortable = select_range(temperatures,60,70,ncomf)

 MODIFICATION HISTORY: written summer 1996 by Bill Peria UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/select_range.pro">general/missions/fast/fa_ops/select_range.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SERIES_COMPRESS">
<H2>SERIES_COMPRESS</H2></A>
<A HREF="#SELECT_RANGE">[Previous Routine]</A>
<A HREF="#SHOW_DQIS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
        SERIES_COMPRESS.PRO

 DESCRIPTION:

 	Routine to return a series of numbers as a string in a compressed
	(abreviated) format.  Contiguous series of numbers (n and m, in a
	subarray) are displayed as:

		n&lt;delimiter&gt;..m

 	If the series is not contiguous, they are displayed as:

		n&lt;delimiter&gt;m

 	The string delimiter is specified by the user with the delimit
	parameter.  The series must be a numeric type.
       
 USAGE:
 
 	SERIES_COMPRESS, input_array, delimit

 ARGUMENTS:
	input_array 	The input series, as an array to compress.
	delimit		The delimiter to use between values

 REVISION HISTORY:

	@(#)series_compress.pro	1.1 06/04/95
       Originally written by Jonathan M. Loran,  University of 
       California at Berkeley, Space Sciences Lab.   Sep. '91

</PRE><P>
<STRONG>(See <A href="fa_ops/series_compress.pro">general/missions/fast/fa_ops/series_compress.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SHOW_DQIS">
<H2>SHOW_DQIS</H2></A>
<A HREF="#SERIES_COMPRESS">[Previous Routine]</A>
<A HREF="#SOLAR_POS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 SHOW_DQIS

 DESCRIPTION:

	Procedure to show what sdt data quantities are loaded into 
	local shared memory.  These quantities should be accessable
	from the loadSDTBuf package.

 CALLING SEQUENCE:

	show_dqis

 REVISION HISTORY:

	@(#)show_dqis.pro	1.4 08/19/97
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep '95
       Added RESULT keyword 19-Aug-97, Bill Peria
</PRE><P>
<STRONG>(See <A href="fa_ops/show_dqis.pro">general/missions/fast/fa_ops/show_dqis.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SOLAR_POS">
<H2>SOLAR_POS</H2></A>
<A HREF="#SHOW_DQIS">[Previous Routine]</A>
<A HREF="#STARTUP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 PROCEDURE   solar_pos.pro

 PURPOSE     Calculates the position of the Sun.

 INPUTS

   TIME     String or double float

 OUTPUTS

   GST      Greenwich Mean Siderial Time (deg)
   SLONG    Longitude along ecliptic (GEI, deg)
   SRASN    Right Ascension of Sun (GEI, deg)
   SDEC     Declination of Sun (GEI, deg)
   S        Earth-Sun vector (GEI, normalized)

 NOTES

   Only handles one point at a time.  The ease of calling this script
   sacrifices its array capability.  If you want to use arrays,
   compile rotmat.pro and use the SUN procedure therein.

   Good for years 1901 through 2099.   
   Accuracy .006 degree.
   Cartesian coordinates of Earth-Sun vector are:

   X = cos(SRASN)*cos(SDEC)
   Y = sin(SRASN)*cos(SDEC)
   Z = sin(SDEC)

 Algorithm by: G.D.Mead
 Translated into IDL by: J.Raucheiba 97/6/30
</PRE><P>
<STRONG>(See <A href="fa_ops/solar_pos.pro">general/missions/fast/fa_ops/solar_pos.pro</A>)</STRONG><P>
<HR>
 
<A NAME="STARTUP">
<H2>STARTUP</H2></A>
<A HREF="#SOLAR_POS">[Previous Routine]</A>
<A HREF="#STRARR_TO_ARRSTR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
Startup procedure for Space Physics Research Group idl routines.
Calling procedure:
@startup
PURPOSE:  Initializes various settings.

CREATED BY:	Davin Larson, generalized by J. M. Loran
LAST MODIFICATION:	@(#)startup.pro	1.4 10/03/97
</PRE><P>
<STRONG>(See <A href="fa_ops/startup.pro">general/missions/fast/fa_ops/startup.pro</A>)</STRONG><P>
<HR>
 
<A NAME="STRARR_TO_ARRSTR">
<H2>STRARR_TO_ARRSTR</H2></A>
<A HREF="#STARTUP">[Previous Routine]</A>
<A HREF="#STR_TO_TIME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: strarr_to_arrstr

 USAGE: strarr_to_arrstr, strarr, arrstr

 PURPOSE:
     convert a structure of time-based arrays to a time-based array of structures

 INPUTS: 
     strarr:
         a structure, each tag of which contains a time-based array

 OUTPUTS:
     arrstr:
         the time-based array of structures that corresponds to the input structure
         of time-based arrays, such that arrstr(i).(j) = (strarr.(j))(i).
     
 DETAILS:
     This routine is used in the building of a CDF file that is to contain the data
     from a number of tplot structures that have been created with &quot;store_data&quot;.
     (See &quot;make_cdf_structs.pro&quot; and &quot;makecdf.pro&quot;).
     Make_cdf_structs.pro first builds a structure containing all the data values
     that are to be written to the cdf (each tag of this structure is a time-based
     array of data quantities), then this structure of time-based arrays is converted
     into the equivalent time-based array of structures (using this routine), and this
     resulting array of structures can then be used to call makecdf.pro, which
     writes the cdf.

 SEE ALSO:
     &quot;make_cdf_structs.pro&quot;, &quot;makecdf.pro&quot;

 CREATED BY: Vince Saba

 LAST MODIFICATION: @(#)strarr_to_arrstr.pro	1.1 08/22/96
</PRE><P>
<STRONG>(See <A href="fa_ops/strarr_to_arrstr.pro">general/missions/fast/fa_ops/strarr_to_arrstr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="STR_TO_TIME">
<H2>STR_TO_TIME</H2></A>
<A HREF="#STRARR_TO_ARRSTR">[Previous Routine]</A>
<A HREF="#SUBSTR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 STR_TO_TIME

 DESCRIPTION:

	function to parse out a date/time string with format of
	YY-MM-DD/HH:MM:SS.MSC.  Any trailing component of the date
	or time may be left off	(e.g. '95-8/1 is legal).  The year
	may be either 2 or 4 digits, where 1970 is assumed to be
	the epoch.  The RETURN value is double float in seconds
	since 1 Jan 1970, 00:00 UT.

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	string_date_time = '1991-03-21/04:04:04'
    
    ; convert to string    
    
	seconds_date = str_to_time(string_date_time)
    
    ; print it out
    
	PRINT, seconds_date

 --- Sample output would be 
    
	6.6952824e+08
    

 NOTES:

	If conversion fails, this function returns -1.
 
	If any of the fields is to large then a carry operation will
	occur.  i.e. 34/13/89 would come out to year 90, month 2, day 3.
	The same is true of the time portion.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings and remainders will be
	returned.


 REVISION HISTORY:

	@(#)str_to_time.pro	1.7 10/06/95
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Sep. '91

	Revised to handle arrays of input values, JML, Jan. '92
</PRE><P>
<STRONG>(See <A href="fa_ops/str_to_time.pro">general/missions/fast/fa_ops/str_to_time.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SUBSTR">
<H2>SUBSTR</H2></A>
<A HREF="#STR_TO_TIME">[Previous Routine]</A>
<A HREF="#SUM3D_HDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: SUBSTR

 PURPOSE:
   a function for replacing substrings inside strings.

 CATEGORY: string manipulation

 INPUTS: SS - a string to be operated on.
         FROM - subtring from SS, to be replaced 
         TO - a string which will replace FROM
         NUM - The first NUM occurrences of FROM in SS are replaced
         with TO. 

 OUTPUTS: The return value is a string or array of strings, with the
          requested replacements made. 

 RESTRICTIONS: Strings only, please. 

 EXAMPLE: tplot_date = substr('1997/08/21/15:00', '/', '-', 2),
          i.e. replace the first two slashes with dashes. 

 MODIFICATION HISTORY: written on a slow day in July 1997, by Bill
                       Peria, UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/substr.pro">general/missions/fast/fa_ops/substr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SUM3D_HDR">
<H2>SUM3D_HDR</H2></A>
<A HREF="#SUBSTR">[Previous Routine]</A>
<A HREF="#SVDFIT4">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: sum3d_hdr
PURPOSE: Takes two 3D structures and returns a single 3D structure
  whose data is the sum of the two, checks header and spin compatibility.
INPUTS: d1,d2  each must be 3D structures obtained from the get_?? routines
	e.g. &quot;get_el&quot;
KEYWORDS:
	HDR=hdr		array(n)	List of array indexes in dat.header_bytes 
					to be compared. 
					If not the same, returns d1 with d1.valid=2
	Spin		1,0		If set, will check FAST spin number.
					If not the same, returns d1 with d1.valid=2
RETURNS: single 3D structure

CREATED BY:	modified from sum3d.pro created by Davin Larson
LAST MODIFICATION: Mcfadden 	 96/7/1

Notes: This is a very crude subroutine. Use at your own risk.
</PRE><P>
<STRONG>(See <A href="fa_ops/sum3d_hdr.pro">general/missions/fast/fa_ops/sum3d_hdr.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SVDFIT4">
<H2>SVDFIT4</H2></A>
<A HREF="#SUM3D_HDR">[Previous Routine]</A>
<A HREF="#SVDOUT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	SVDFIT4

 PURPOSE:
	Perform a general least squares fit with optional error estimates.

	This version uses SVD.  A user-supplied function or a built-in
	polynomial is fit to the data.
       THIS VERSION IS THE IDL VERSION 4 PROCEDURE

 CATEGORY:
	Curve fitting.

 CALLING SEQUENCE:
	Result = SVDFIT4(X, Y, M)

 INPUTS:
	X:	A vector representing the independent variable.

	Y:	Dependent variable vector.  This vector should be same length 
		as X.

	M:	The number of coefficients in the fitting function.  For 
		polynomials, M is equal to the degree of the polynomial + 1.

 OPTIONAL INPUTS:
	Weight:	A vector of weights for Y(i).  This vector should be the same
		length as X and Y.

		If this parameter is ommitted, 1 is assumed.  The error for 
		each term is weighted by Weight(i) when computing the fit.  
		Frequently, Weight(i) = 1./Sigma(i) where Sigma is the 
		measurement error or standard deviation of Y(i).

	Funct:	A string that contains the name of an optional user-supplied 
		basis function with M coefficients. If omitted, polynomials
		are used.

		The function is called:
			R = FUNCT(X,M)
		where X is an N element vector, and the function value is an 
		(N, M) array of the N inputs, evaluated with the M basis 
		functions.  M is analogous to the degree of the polynomial +1 
		if the basis function is polynomials.  For example, see the 
		function COSINES, in the IDL User Library, which returns a 
		basis function of:
			R(i,j) = cos(j*x(i)).
		For more examples, see Numerical Recipes, page 519.

		The basis function for polynomials, is R(i,j) = x(i)^j.
		
 OUTPUTS:
	SVDFIT4 returns a vector of M coefficients.

 OPTIONAL OUTPUT PARAMETERS:
	NOTE:  In order for an optional keyword output parameter
	to be returned, it must be defined before calling SVDFIT.
	The value or structure doesn't matter.  For example:

		YF = 1				;Define output variable yf.
		C = SVDFIT4(X, Y, M, YFIT = YF) 	;Do SVD, fitted Y vector is now
						;returned in variable YF.

	YFIT:	Vector of calculated Y's.

	CHISQ:	Sum of squared errors multiplied by weights if weights
		are specified.

	COVAR:	Covariance matrix of the coefficients.

    VARIANCE:	Sigma squared in estimate of each coeff(M).

    SINGULAR:	The number of singular values returned.  This value should
		be 0.  If not, the basis functions do not accurately
		characterize the data.

 COMMON BLOCKS:
	None.

 SIDE EFFECTS:
	None.

 MODIFICATION HISTORY:
	Adapted from SVDFIT, from the book Numerical Recipes, Press,
	et. al., Page 518.
	minor error corrected April, 1992 (J.Murthy)
</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_lib.pro">general/missions/fast/fa_ops/ucla_mag_lib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SVDOUT">
<H2>SVDOUT</H2></A>
<A HREF="#SVDFIT4">[Previous Routine]</A>
<A HREF="#SYBCON">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: SVDOUT

 PURPOSE: Fit to a model function with outlier throw-away. Essentially the
          same as SVDFIT, which is supplied with IDL.

 CALLING SEQUENCE: c = svdout(x,y,nsvd)
 
 INPUTS: X - array of independent variables corresponding to Y
         Y - dependent variables
         NSVD - order of desired polynomial fit, or number of
         coefficients in arbitrary linear model function. 

 KEYWORDS: All the same as for SVDFIT, plus...
          USED - a named variable in which the indices of the data
          used for the final fit are returned. 

          TOSSED - a named variable in which the indices of the data
          removed from the final fit are returned.

          SHOW - if set, causes successive fits to be plotted
          interactively, so you can see what's going on, set weights
          properly, etc. 

 OPTIONAL INPUTS: see documentation for IDL routine SVDFIT.

 OUTPUTS: an array of coefficients for polynomial fit. If NSVD is
          2, then Y is approximated best by:
                 y ~ c(0) + c(1)*x + c(2)*x^2

 OPTIONAL OUTPUTS: see documentation for IDL routine SVDFIT.

 MODIFICATION HISTORY: written October 1996 by Bill Peria, UCB/SSL
                       11-March-97 began using Mozer's 1.2 + 0.4*i scheme
                       14-April-97 inserted SVDFIT2, which is just
                       SVDFIT with /CONTINUE added to the warning
                       message, so that it won't just quit!
                       23-June-97 Moved SVDFIT2 into separate module,
                       to avoid horrible IDL 5 implementation of
                       SVDFIT! 
</PRE><P>
<STRONG>(See <A href="fa_ops/svdout.pro">general/missions/fast/fa_ops/svdout.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SYBCON">
<H2>SYBCON</H2></A>
<A HREF="#SVDOUT">[Previous Routine]</A>
<A HREF="#SYBCON__FETCH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
CLASS: sybcon

FUNCTION: sybcon()

PURPOSE:
  Create an instance of the sybcon class to manage 
  a connection to a sybase server.

METHODS:
  sybcon::INIT
  sybcon::send
  sybcon::fetch
  sybcon::results
  sybcon::cleanup

DESTRUCTOR:
  sybclose, con
  obj_destroy, con
     both have the same functionality.  If con is not destroyed, this
     will cause a 'connection leak' which will eventually
     fill up all available connections on the server.

INPUT:  no inputs

OUTPUT:
  a pointer to a sybcon class instance.

KEYWORDS:
  config - name of database config file.
           $FASTCONFIG/fast_archive.conf used by default.
  appname - appname to use for connection.  Default: 'idl'


CALLING SEQUENCE:
  con = sybcon()
  print,  con-&gt;send('select start, finish from orbits where orbit = 500')
  print, con-&gt;fetch(orbittime)
  print, time_string(orbittime.start)
  print, time_string(orbittime.finish)
  sybclose, con


CREATED BY:	Ken Bromund  Dec 1997
</PRE><P>
<STRONG>(See <A href="fa_ops/sybcon.pro">general/missions/fast/fa_ops/sybcon.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SYBCON__FETCH">
<H2>SYBCON__FETCH</H2></A>
<A HREF="#SYBCON">[Previous Routine]</A>
<A HREF="#SYBCON__RESULTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: sybcon::fetch(row)
 Class:  sybcon
 Method: fetch
 
 Fetches a row of result set after sybcon::send or sybcon::results
 returns &gt; 0.  Must be called until returns 0 before calling
 sybcon::results to process next result set in batch.
 
 result:
       1 - row successfully fetched
       0 - no more rows. 
       &lt; 0 - error.

 parameters:
       row - named variable in which to store the structure
             containing the row result.

</PRE><P>
<STRONG>(See <A href="fa_ops/sybcon__fetch.pro">general/missions/fast/fa_ops/sybcon__fetch.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SYBCON__RESULTS">
<H2>SYBCON__RESULTS</H2></A>
<A HREF="#SYBCON__FETCH">[Previous Routine]</A>
<A HREF="#SYBCON__SEND">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: sybcon::results(name)
 Class:  sybcon
 Method: results
 
 For second and subsequent result sets produced by SQL batch sent with the
 sybcon::send method, sybcon::results creates a structure internal
 to the class to recieve the result columns.  
 Structure tags will correspond to 
 result column names.  Unnamed columns will be tagged &quot;col#&quot; where
 '#' is the number of the column.  Supply the name argument 
 if you want to fetch data into a named structure.
 
 result:
       &gt; 0 - number of columns in result set.  
       0   - no results to fetch.
       &lt; 0 - error, or no more results.

 parameters:
       name - name for named structure in which fetch rows will be returned.
              Optional.
</PRE><P>
<STRONG>(See <A href="fa_ops/sybcon__results.pro">general/missions/fast/fa_ops/sybcon__results.pro</A>)</STRONG><P>
<HR>
 
<A NAME="SYBCON__SEND">
<H2>SYBCON__SEND</H2></A>
<A HREF="#SYBCON__RESULTS">[Previous Routine]</A>
<A HREF="#TAIL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION: sybcon::send(comm, name)
 Class:  sybcon
 Method: send
 
 sends sql batch to server, creates a structure internal to the class to
 recieve the result columns.  Structure tags will correspond to 
 result column names.  Unnamed columns will be tagged &quot;col#&quot; where
 '#' is the number of the column.  Supply the name argument 
 if you want to fetch data into a named structure.
 
 result:
       &gt; 0 - number of columns in result set.  
       0   - no results to fetch.
       &lt; 0 - error.

 parameters:
       comm - string containing sql command to send
       name - name for named structure in which fetch rows will be returned.
              Optional.
</PRE><P>
<STRONG>(See <A href="fa_ops/sybcon__send.pro">general/missions/fast/fa_ops/sybcon__send.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TAIL">
<H2>TAIL</H2></A>
<A HREF="#SYBCON__SEND">[Previous Routine]</A>
<A HREF="#TIMESEC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
        TAIL.PRO

 DESCRIPTION:

       Procedure to print out the tail (last few elements) of an array.

 USAGE:
 
 	TAIL, input_array, [NUMBER=number-of-final-elements]

 ARGUMENTS:
	input_array 	The array to print.

 KEYWORDS:
	NUMBER		The number if array elements to print.

 REVISION HISTORY:

	@(#)tail.pro	1.1 06/04/95
       Originally written by Terry Slocum,  University of 
       California at Berkeley, Space Sciences Lab.   Sep. '91

</PRE><P>
<STRONG>(See <A href="fa_ops/tail.pro">general/missions/fast/fa_ops/tail.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TIMESEC">
<H2>TIMESEC</H2></A>
<A HREF="#TAIL">[Previous Routine]</A>
<A HREF="#TIMETICK">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 TIMESEC

 DESCRIPTION:

	function to parse out a time string of the form hh:mm:sec.msc.
	The return value is in seconds of the day.
	
 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; set up a time string

	time_string = '25:01:01.001'
    
    ; convert to seconds
    
	time_seconds = timesec(time_string, carries=nc)
    
    ; print it out
    
	PRINT, time_seconds, nc

 --- Sample output would be 
    
	3661.0010, 1
    

 NOTES:

	if the input time is greater than 24 hours, then 24 hours will
	subtracted until time is less than 24 hours.  The CARRIES keyword
	if set, will contain the number of rollovers.

	The return value is a double float.  

	if conversion fails, this functin returns -1.

	The input is interpreted in the following way:

	 1) only the last 2 digits of any field is significant, except 
	    for the case of miliseconds, where only the first 3 digits are 
	    significant.  e.g. if the second field is 1160, it will be taken 
	    as 60 for fields other than msc, and taken as 116 for millisecond.

	 2) if the hour is greater than 23, then 24 is subtracted from it
	    successivly till it is less than 24.  e.g. if the hour field is
	    73, then it will be set to 1

	 3) if the min or sec is greater than 60, 60 is subtracted and 
	    the remander is caried over to the hour and min, respectively

	 4) anything after the msc field will be ignored.

	 5) input is interpreted from left to right for the hour:min:sec parts
	    e.g. '03:12' is inturpeted as hour=3,  min=12, sec=0 and msc=0.  
	    '03' is taken to mean hour=3 and min = sec = msc = 0, however 1.1 
	    is taken to mean hour=1, msc=100, min=sec=0.

	 6) everything up to the last two digits before the first colon will
	    be ignored, if the colon is presant.  So a string formed thusly:
	    '1995/1/31 03:00:00.0' will give the hour=3 and min = sec = msc=0.

	 7) if there is trailing information in the input string, the
	    time must contain all fields, and the string must not have
	    other ':' or '.'  characters.  This allows times to be pulled
	    off of strings containing other information.

	If input sting is an array, then an array of N_ELEMENTS(inputs val) 
	of date strings and remainders will be returned. 


 REVISION HISTORY:

	@(#)timesec.pro	1.3 10/06/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Nov. '91

	Revised to handle arrays of input values, JML, Mar. '92
 	Revised to implement carry keyword, JML Oct. '95
</PRE><P>
<STRONG>(See <A href="fa_ops/timesec.pro">general/missions/fast/fa_ops/timesec.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TIMETICK">
<H2>TIMETICK</H2></A>
<A HREF="#TIMESEC">[Previous Routine]</A>
<A HREF="#TIME_ALIGN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 TIMETICK

 DESCRIPTION:

	Function to build the anotatation for time axes labeling.

 	Input parameters are the start and end seconds since 1970, Jan 1,
 	00:00:00.

 	The return value is a structure of the format:

	 {time_tk_str                       $
	             ,xtickname: STRARR(22) $   ; Actual labels for ticks
	             ,xtickv:    FLTARR(22) $   ; Actual tick locations
	             ,xticks:    1          $   ; number of major ticks
	             ,xminor:    1          $   ; number of minor ticks
	             ,xrange:    FLTARR(2)  $   ; min and max time of plot
		     ,xstyle:    1          $   ; const specifying plot style
	 }

 USAGE (SAMPLE CODE FRAGMENT):
 
    ; get the start and end values.  Assume time_pts array has been
    ; sorted appropriately

       start_sec = time_pts(0)                
       end_sec = time_pts(N_ELEMENTS(time_pts)-1)

    ; now we do the plot 

 	time_setup = timetick(start_sec, end_sec, min_max_flag, offset,
		datelab)
 	PLOT, time_pts-offset, value_pts, _EXTRA=time_setup,
		XTITLE='Time UT from: ' + datelab

 KEYWORDS:

    FMT	Controls the format of the dates in the time labels.
		If FMT is zero, or is not given, then dates will be given as
		95/12/30.  If FMT is non-zero, then dates will be given as
		30 Dec 95.

    DATELABFMT	Controls the format of the datelab string.  If it's
		not set or zero, the datelab string will include the full
		date and time for the start of the plot.  If it's non-zero,
		the datelab string will include only the most significant
		portion of the date and time of the start of the plot that is
 		not included in the actual tick marks.
	
 NOTES:

	The returned time_tk_str has tags named so that it can be used
	with the special _EXTRA keyword in the call to PLOT or OPLOT.

	The offset value that is returned from timetick must be
	subtracted from the time-axis data values before plotting.
	This is to maintain resolution in the PLOT routines, which use
	single precision floating point internally.  Remember that if
	the CURSOR routine is used to read a cursor position from the
	plot, this offset will need to be added back to the time-axis
	value to get seconds since 00:00:00 1-1-1970.

 	The datelab returned parameter gives the most significant part
	of the date/time that is not included in the tick labels.  It will
 	be derived from the first tick time.  It can then be used in
	a title to give the date/time of the start of the data, when the
	plot duration is to short for this to be included in the xticks.
	if the full date is included in the xticks, datelab will be a
	null string.

	The parameter min_max_flag determines how the start and end times
	for the plot will be calculated.  If it greater than or equal to 1, 
	the start and end times will be fourced to align upon a major 
	tick mark.  Otherwise, the start and end times will be set to
	the start_sec and end_sec parameters.

 	This function only makes sense for linear X-axes, though it
 	should work with the log case as well.

 	Be warned that usage of large fonts may cause the time labels
 	to run into eachother.  Time labels can be much wider than normal
 	numeric labels.

	Time plot durations of approximately 10 milliseconds to 20 years
	are handled.

	If arrays of start and end times are given, then an array
	of N_ELEMENTS(inputs vals) of time_tk_str, offset and datelab
	will be returned.

	If an error is encountered, then -1 is returned

	This function calls upon the &quot;sectime&quot;, &quot;secdate&quot;, &quot;datesec&quot;,
	&quot;monthyrfrom&quot; and  &quot;yrfrom&quot; procedures.

 REVISION HISTORY:

	@(#)timetick.pro	1.7 01/15/98 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Dec. '91

	Revised Jan. '92 to cover time durations up to 20 years
</PRE><P>
<STRONG>(See <A href="fa_ops/timetick.pro">general/missions/fast/fa_ops/timetick.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TIME_ALIGN">
<H2>TIME_ALIGN</H2></A>
<A HREF="#TIMETICK">[Previous Routine]</A>
<A HREF="#TIME_TO_STR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: time_align, tplist

 PURPOSE: interpolate a colloction of stored data so that they have a common time array

 INPUTS:
     tplist:
         an array of either tplot numbers of tplot names
     
 KEYWORDS:
     times:
         an array of times to which all the tplot variables will be interpolated.
         if this keyword is not set, its default value is the 'x' component of the
         first tplot variable in the argument 'tplist'.
     overwrite:
         if set, store all the interpolated variables with the same names as the
         original input variables.
     output_names:
         this keyword parameter must be set if the keyword parameter 'overwrite' is
         not set.  It is a list of strings giving the names under which all the
         interpolated variables should be stored.
     status:
         if set, a value of 0 will be written to this variable if the procedure
         executes normally, else a value of -1 will be written to this variable.
         It is suggested that, in general, this keyword parameter always be set
         in order for the user to determine if this procedure completed normally.

 CREATED BY: Vince Saba, 09/96

 LAST MODIFICATION: @(#)time_align.pro	1.2 10/23/96
</PRE><P>
<STRONG>(See <A href="fa_ops/time_align.pro">general/missions/fast/fa_ops/time_align.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TIME_TO_STR">
<H2>TIME_TO_STR</H2></A>
<A HREF="#TIME_ALIGN">[Previous Routine]</A>
<A HREF="#TMS_HIMASS_GET_ANGLES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 TIME_TO_STR

 DESCRIPTION:

	function to return a date-time string from the number of seconds since
	1970, Jan. 1 00:00.  Output format is controled by the keyword
	FMT.  This function will return a string in the format:
 	
	FMT=0 	 YYYY-MM-DD/HH:MM:SS.MSC   (e.g. &quot;1991-03-21/10:35:22.156&quot;);   
	FMT NE 0 DD MMM YY HH:MM:SS.MSC    (e.g. &quot; 3 Mar 91 10:35:22.156&quot;);   

 USAGE (SAMPLE CODE FRAGMENT):
 
    
    ; seconds since 1970 

	seconds_date_time = 6.6951720e+08           ; 21 Mar 91, 01:00:00.000
    
    ; convert to string    
    
	date_time_string = time_to_str(seconds_date_time, FMT=0)
    
    ; print it out
    
	PRINT, date_time_string

 --- Sample output would be 
    
	1991-03-21/10:35:22.156
    
 KEYWORDS:

	FMT	Controls the output string format.  See description above.
       MSEC    returns string with millisec accuracy if set.

 NOTES:

	The seconds parameter should be double precision.

	If seconds is given negitive, this is an error and the string 'ERROR'
	is returned.

	If input seconds is an array, then an array of 
	N_ELEMENTS(inputs vals) of date strings will be returned.

	This function relies upon the secdate and sectime functions

 	Credits: adapted from The C Programming Lanuage, by Kernighan and 
 	Ritchie, 2nd Ed. page 111

 REVISION HISTORY:

	@(#)time_to_str.pro	1.1 31 Jul 1995
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Jul. '95
</PRE><P>
<STRONG>(See <A href="fa_ops/time_to_str.pro">general/missions/fast/fa_ops/time_to_str.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TMS_HIMASS_GET_ANGLES">
<H2>TMS_HIMASS_GET_ANGLES</H2></A>
<A HREF="#TIME_TO_STR">[Previous Routine]</A>
<A HREF="#TMS_HIMASS_GET_MASSES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 tms_himass_get_angles

 DESCRIPTION:

	Procedure to return the theta and phi arrays for TEAMS HiMass data

 CALLING SEQUENCE:

 	tms_himass_get_angles, theta, dtheta, phi, dphi

 ARGUMENTS:

	theta:	the returned array of theta angles vs bins
	dtheta:	the returned array of delta theta angles vs bins
	phi:	the returned array of phi angles vs bins
	dphi:	the returned array of delta phi angles vs bins

 REVISION HISTORY:

	@(#)tms_himass_get_angles.pro	1.1 08/16/95
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '95
</PRE><P>
<STRONG>(See <A href="fa_ops/tms_himass_get_angles.pro">general/missions/fast/fa_ops/tms_himass_get_angles.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TMS_HIMASS_GET_MASSES">
<H2>TMS_HIMASS_GET_MASSES</H2></A>
<A HREF="#TMS_HIMASS_GET_ANGLES">[Previous Routine]</A>
<A HREF="#TMS_SURV_GET_ANGLES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 tms_himass_get_masses

 DESCRIPTION:

	Procedure to return the mass for TEAMS HiMass data for a given mass bin

 CALLING SEQUENCE:

 	ret = tms_himass_get_masses (mass, dmass, bin)

 ARGUMENTS:

	bin:	the bin to get mass for
	mass:	the returned array of mass angles vs bins
	dmass:	the returned array of delta mass angles vs bins

 RETURN VALUE:

	Upon success 0 is returned.  Upon failure, -1 is returned.

 REVISION HISTORY:

	@(#)tms_himass_get_masses.pro	1.1 08/16/95
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '95
</PRE><P>
<STRONG>(See <A href="fa_ops/tms_himass_get_masses.pro">general/missions/fast/fa_ops/tms_himass_get_masses.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TMS_SURV_GET_ANGLES">
<H2>TMS_SURV_GET_ANGLES</H2></A>
<A HREF="#TMS_HIMASS_GET_MASSES">[Previous Routine]</A>
<A HREF="#TOTAL_TRAILING_DIMS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:
 	 tms_surv_get_angles

 DESCRIPTION:

	Procedure to return the theta and phi arrays for TEAMS survey data

 CALLING SEQUENCE:

 	tms_surv_get_angles, theta, dtheta, phi, dphi

 ARGUMENTS:

	theta:	the returned array of theta angles vs bins
	dtheta:	the returned array of delta theta angles vs bins
	phi:	the returned array of phi angles vs bins
	dphi:	the returned array of delta phi angles vs bins

 REVISION HISTORY:

	@(#)tms_surv_get_angles.pro	1.1 08/16/95
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Aug '95
</PRE><P>
<STRONG>(See <A href="fa_ops/tms_surv_get_angles.pro">general/missions/fast/fa_ops/tms_surv_get_angles.pro</A>)</STRONG><P>
<HR>
 
<A NAME="TOTAL_TRAILING_DIMS">
<H2>TOTAL_TRAILING_DIMS</H2></A>
<A HREF="#TMS_SURV_GET_ANGLES">[Previous Routine]</A>
<A HREF="#T_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION: total_trailing_dims

 PURPOSE: totals the input array over all dimensions other than the first

 INPUT:
     array:
         any numerical input array

 OUTPUT:
     return value:
         1 dimensional array of size equal to the first dimension of 'array',
         formed by summing 'array' over all other dimensions.

 EXAMPLE:
     IDL&gt; x = [[1,2],[3,4]]     
     IDL&gt; y = total_trailing_dims(x)

     Then y will equal the array [4.0, 6.0].

 VERSION: @(#)total_trailing_dims.pro	1.1 03/16/97
</PRE><P>
<STRONG>(See <A href="fa_ops/total_trailing_dims.pro">general/missions/fast/fa_ops/total_trailing_dims.pro</A>)</STRONG><P>
<HR>
 
<A NAME="T_2D">
<H2>T_2D</H2></A>
<A HREF="#TOTAL_TRAILING_DIMS">[Previous Routine]</A>
<A HREF="#T_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	t_2d(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the temperature, [Tx,Ty,Tz,Tavg], eV
NOTES:	
	Function calls p_2d.pro and n_2d.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-5		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/t_2d.pro">general/missions/fast/fa_ops/t_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="T_2D_B">
<H2>T_2D_B</H2></A>
<A HREF="#T_2D">[Previous Routine]</A>
<A HREF="#T_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	t_2d_b(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the temperature, [Tx,Ty,Tz,Tavg], eV, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Function calls p_2d_b.pro and n_2d_b.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	97-8-20		Created from t_2d.pro
					Treats narrow beams correctly, no do loops
LAST MODIFICATION:
	97-8-20		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/t_2d_b.pro">general/missions/fast/fa_ops/t_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="T_2D_FS">
<H2>T_2D_FS</H2></A>
<A HREF="#T_2D_B">[Previous Routine]</A>
<A HREF="#UCLA_MAG_DESPIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	t_2d_fs(dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the temperature, [Tx,Ty,Tz,Tavg], eV, assumes a narrow (&lt; 5 deg) field aligned beam
NOTES:	
	Same as p_2d_b.pro, accept separates 64 angle fast survey data 
		for FAST to do a more accurated calculation.
	Function normally called by &quot;get_2dt.pro&quot; to generate 
		time series data for &quot;tplot.pro&quot;.
	Note that the EBINS, ARANGE, and BINS keywords below may not work 
		properly since their meaning changes with 32 or 64 angle bins.

CREATED BY:
	J.McFadden	97-8-13		Treats FAST fast survey narrow beams correctly, calls p_2d_b.pro
LAST MODIFICATION:
	97-8-20		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/t_2d_fs.pro">general/missions/fast/fa_ops/t_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="UCLA_MAG_DESPIN">
<H2>UCLA_MAG_DESPIN</H2></A>
<A HREF="#T_2D_FS">[Previous Routine]</A>
<A HREF="#UNWRAP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE: UCLA_MAG_DESPIN
       
 PURPOSE: Orthogonalize and despin fluxgate magnetometer data.
          Also return a smoothed spinning component, for use
          in other magnetometer despinning routines.
          Finally calculate measured-model field residuals, and return
          data in several coordinate systems.

          Currently uses IGRF field to determine spin-axis pointing.
          Currently uses Housekeeping (AttitudeCtrl) data to determine 
          spin-phase.
          Eventually will include an over-ride to use definitive attitude and
          spin-phase data when available.

          Note that the routine calls get_fa_orbit, overwriting
          any data stored from a previous call to get_fa_orbit.

 INPUT: 
          SDT data quantities REQUIRED to be plotted:

               Any AttitudeCtrl data quantity (e.g. SUN)

               MagXDC, MagYDC, MagZDC or
               MagX, MagY, MagZ or
               Mag1dc_S, Mag2dc_S, Mag3dc_S

               It is recommended that at least 20 minutes of data
               are plotted in SDT, since the measured fields are fit to
               model data.


 KEYWORDS:

      OPTIONAL RETURNED DATA:
          tw_mat    Named variable to store interim tweaker matrix
          orbit     Named variable to store orbit number
          spin_axis Named variable to store deduced spin axis RA/DEC
          delta_phi Named variable to store deduced spin phase correction

      OPTIONS FOR TPLOT DATA QUANTITIES:
          not_rgb   If set color of vector components determined from color 
                    table, otherwise forced to Red-Green-Blue
          vec_cols  Three element array containing color indices for
                    vector components (over-rides Red-Green-Blue),
                    no effect if not_rgb set
          labflag   Passed to the tplot options routine if set 
                    [see tplot routines]

      DATA PROCESSING OPTIONS (usually only set to diagnoze problems):
          not_raw   If set force routine to use SDT-calibrated data
          no_torq   If set do not calculate torquer values
          query     If set query user about torquer coil and spin phase
                    fixes
          not_fdf   If set don't use in-code FDF predict for 
                    attitude
          old_igrf  If set use the IGRF model returned from get_orbit, 
                    otherwise recalculate IGRF
          no_patch  If set don't attempt to patch the eclipse spin phase data 
          force_patch If set force the patch of the eclipse data
                    (no_patch takes precedence)
          no_spin_tone If set disable spin-tone harmonic removal

 OLD KEYWORDS:
          (kept for compatibility with earlier versions - newer keywords over-ride 
           in that these keywords are assumed to be set unless turned off by the
           newer keywords)

          useraw    If set force routine to use raw data (optional)
          calctorq  If set attempts to calculate torquer values (optional)
          no_query  If set don't query user about torquer coil and spin phase
                    fixes (optional)
          use_fdf   If set force use of in-code FDF predict for 
                    attitude (optional)
          use_rgb   If set force vector components to red-green-blue,
                    otherwise determined from color table (optional)
          default   If set use default options - useraw if data in SDT,
                    calctorq, no_query, use_fdf, use_rgb (optional)

 CALLING: 

          Simplest:
          ucla_mag_despin

          More detailed:
          ucla_mag_despin,tw_mat=tw_mat,orbit=orbit,spin_axis=spin_axis,delta_phi=delta_phi,/query

 OUTPUT: 
          tplot variables:

           Basic Magnetometer data:
          'Bx_sp'      Spinning spacecraft Bx (not smoothed, not deglitched)
          'By_sp'      Spinning spacecraft By (not smoothed, not deglitched)
          'Bz_sp'      Spinning spacecraft Bz (not smoothed, not deglitched)
          'Bx_sc'      Despun Bx (in spin plane, to sun, smoothed, deglitched)
          'By_sc'      Despun By (in spin plane, perp sun, smoothed, deglitched)
          'Bz_sc'      Despun Bz (spin axis component, smoothed, deglitched)
          'Bx_sp_sm'   Respun smoothed and deglitched Bx
          'By_sp_sm'   Respun smoothed and deglitched By
          'Bz_sp_sm'   Respun smoothed and deglitched Bz

           Transformed data:
          'B_gei'      Smoothed and deglitched field in GEI coordinates
          'B_sm'       Smoothed and deglitched field in SM coordinates

           Detrended data:
          'dB_sc'      Detrended field in despun spacecraft coordinates
          'dB_gei'     Detrended field in GEI coordinates
          'dB_sm'      Detrended field in SM coordinates
          'dB_fac'     Detrended field in field-aligned coordinates
          'dB_fac_v'   Detrended field in field-aligned/spacecraft velocity 
                       coordinates

           Diagnostic data:
          'MAG_FLAGS'  Data quality flag - see below
          'spin_freq'  Fixed up spin frequency from housekeeping
          'spin_phase' Fixed up spin phase from Housekeeping
          'TORQ_X'     Torquer coil Bx (if torquers removed)
          'TORQ_Y'     Torquer coil By (if torquers removed) 
          'TORQ_Z'     Torquer coil Bz (if torquers removed)
          'BX_DEL'     Bx values deleted through outlier rejection (if deglitched)
          'BY_DEL'     By values deleted through outlier rejection (if deglitched)
          'BZ_DEL'     Bz values deleted through outlier rejection (if deglitched)
          'TW_ZX'      Time-varying tweaker matrix zx-coefficient
          'TW_ZY'      Time-varying tweaker matrix zy-coefficient
          'TW_YY'      Time-varying tweaker matrix yy-coefficient
          'TW_YX'      Time-varying tweaker matrix yx-coefficient
          'O_X         Time-varying x-sensor offset
          'O_Y'        Time-varying y-sensor offset

           Orbit quantities are also returned - orbit data obtained through
           get_fa_orbit,t1,t2,/all,status=no_model,delta=1.,/definitive,/drag_prop
           following orbit quantities stored:
          'BFOOT','LAT','LNG','FLAT','FLNG','B_model','ORBIT','fa_pos', 
          'ALT','ILAT','ILNG','MLT','fa_vel']

           Coordinate transformations returned:
          'despun_to_gei'
          'gei_to_sm'
          'gei_to_fac'
          'gei_to_fac_v'

           
          'MAG_FLAGS' is data quality flag array:    
                    0   good
                    1   spin phase object set to zero
                    2   in eclipse (using nadir table)
                    4   spin phase data not smoothed
                    8   spin phase data patched with nadir or MUE phase data
                   16   Missing spin phase data
           The flags are additive, and higher numbers are more serious.
           Any magnetometer data with a flag &gt;= 16 should be viewed with 
           caution.

 DETAILED DESCRIPTION:
 
   UCLA_MAG_DESPIN does the following:
   
   1) Get spin phase from AttitudeCtrl quantities.

   2) Get data from SDT (any of the mag data quantities, it knows
   how to handle whichever one it gets). Interpolate high rate data 
   (if not MAGDC). Re-register the data and back out the recursive 
   filter (if not MAGDC).

   3) Run an SVDFIT spin fit routine that computes DC, since and cosine 
   coefficients. This process is SLOW - be patient.

   4) Calculate torquer coil offsets
   
   5) Compute an interim coupling matrix plus offsets and orthogonalize the
   data with this matrix.

   6) Rerun the SVDFIT routine - it takes just as long as the first time -
   to get &quot;on the fly&quot; tweaker coefficients. These on the fly coefficients
   have outliers thrown out, and are smoothed and interpolated. A recursive
   filter is insufficient to reject the outliers.

   7) Remove spin-tone harmonics.
   
   8) Tweak up the data with &quot;on the fly&quot; tweaker coefficients.

   9) Patch the spin phase data and smooth phase information.
   
   10) Despin the magnetometer data, without smoothing. Store in tplot
   structures.

   11) Get the model (IGRF) field, and fit spin axis data to model field
   to get the first cut at spin-axis pointing. Calculate a despun_to_gei
   transformation matrix.

   12) 7-point smooth and deglitch magnetometer data, using residuals in
   despun coordinates as basis for spike removal. Respin the deglitched 
   and smoothed data, for possible use in other despinning routines.

   13) Rotate spin plane data to minimize phase difference between model and
   measured field.

   14) Re-tweak spin-axis pointing through regression of all three measured 
   field components. Recalculate despun_to_gei transformation. Re-tweak
   the spin phase offset.

   15) Calculate Delta-B's in despun spacecraft, GEI, SM, and field-aligned
   coordinates (both magnetic meridian and velocity aligned). 
 

 DEPENDENCIES:
          (these routines are included in the file ucla_mag_lib.pro)
          GET_MAG_TWEAK
          GET_MAG_DQIS
          GET_CAL_HISTORY
          INTERP_MAG
          FIX_MAGX
          FIX_MAGY
          FIX_MAGZ
          SPIN_TONE_FIT
          SPINBASE_MAG
          GET_QUARTILES
          TWEAKER_COEFF_FIT
          RUNNING_TOTAL
          OUTLIER_REJECTION
          GET_TORQUER_MAG
          FIX_UP_SPIN
          GET_SUN_RA_DEC
          INTERPOLATE_MATRIX
          INTERPOLATE_PHASE
          VECTOR_CROSS_PRODUCT
          VECTOR_DOT_PRODUCT
          SET_DIPOLE_ORIENT
          TRANSFORM_VECTOR
          SET_IGRF_COEFFICIENTS
          CALCULATE_IGRF
          GET_NEW_IGRF
          GET_PHASE_FROM_ATTCTRL
          PATCH_SPIN_PHASE

 INITIAL VERSION: R J Strangeway 97-04-28
 MODIFICATION HISTORY:
     Use SPIN_TONE_FIT instead of RCE_LOOP2_RJS - RJS 4/30/97
     changed to use BX for spin-period estimator - RJS 4/30/97
     do mag field clean up before final smoother - RJS 5/2/97
     change tplot variable names - RJS 5/7/97
     Smooth before deglitch back in - RJS 5/9/97
     Included check for zero length arrays in interp_mag - RJS 5/15/97
     Fixed short integer arithmetic in outlier_rejection - RJS 5/21/97
     Modified outlier_rejection to include weights, 
         fixes perigee problems- RJS 7/18/97
     Reduced 512 sps data to 128 sps in get_mag_tweak - RJS 7/19/97
     Included TW_MAT keyword, for calibration - RJS 7/26/97
     Modified get_mag_tweak to read MagDC.cal - RJS 7/26/97
     Corrected update of offsets to occur before tweaker update - RJS 8/1/97
     Changed diagnostic output in SPIN_TONE_FIT - RJS 9/6/97
     Tested for Magnetometer DQIS before attempting to read - RJS 9/6/97
     Use MAGDC as well as other quantities - RJS 9/6/97
     Also return respun, smoothed, deglitched field - RJS 9/8/97
     Return detrended field - RJS 9/9/97
     Return orbit number and deduced spin axis orientation - RJS 9/9/97
     Flag bad detrend - RJS 9/29/97
     Include code version specifier to check library match - RJS 9/29/97 - V2.1
     Included repair flag in get_fa_fields calls - RJS 12/5/97 - V2.2
     Included torquer calculation - RJS 3/19/98 - V2.3
     Fixed bug where tw_xy not used in recomputing fields from psuedo
        sensor values - RJS 4/16/97 - V2.4
     Reject bad spin period estimates - RJS 4/17/98 - V2.5

     Major revison - RJS 5/12/98 - V3.0
         Version 3.0 changes:
           Included GET_TORQUER_MAG in the library
           Added no_query and default keywords
           Try to use raw magnetometer data if default set
           Use housekeeping (AttitudeCtrl) data for spin phase
           Added MAG_FLAGS as quality indicators
           Use model fits to fix up spacecraft attitude
           Return delta-B's in Spacecraft, GEI, SM and field-aligned
              coordinates
           Included FIX_UP_SPIN in the library
           Included GET_SUN_RA_DEC in the library
           Included INTERPOLATE_MATRIX in the library
           Included INTERPOLATE_PHASE in the library
           Included VECTOR_CROSS_PRODUCT in the library
           Included VECTOR_DOT_PRODUCT in the library
           Included SET_DIPOLE_ORIENT in the library
           Included TRANSFORM_VECTOR in the library

      Version 3.1 - Bug fixes and improvements of 3.0 - RJS 
           Corrected and modified information message at end - 5/14/98
           No longer interpolate MAG_FLAGS - not necessary and slow - 5/14/98
           Fixed bug where final spin-axis tweak not applied - 5/17/98
           Modified INTERPOLATE_PHASE to check both spin and phase for 
               finite - 5/18/98
           Final spin-axis fix before spin-phase adjustment - 5/18/98
           Fixed bkeep error in deglitch (applying wrong phase) - 5/19/98
           Added warning for large deviations from expected attitude - 5/20/98
           Use in-code FDF predict to replace first spin-axis estimate
              if deviation too large - 5/20/98
           Revised outlier rejection to use relative value - RJS 6/11/98
           Fixed bug in respinning data - RJS 6/11/98
           Revised outlier rejection to use residual along model field,
              previous schemes over reject - RJS 6/19/98
           Modified GET_TORQUER_MAG to use piece-wise interpolation - 6/19/98

      Version 3.2  - Bug fixes and improvements of 3.1 - RJS
           Add a zero-crossing deglitcher to GET_MAG_TWEAK - RJS 6/11/98
           Revised SPIN_TONE_FIT and SPINBASE_MAG to center fit interval
              - RJS 6/16/98
           Modified x/y correlation factor (0.04) in GET_TORQUER_MAG
              - RJS 8/21/98
           Modified OUTLIER_REJECTION to check for finite - RJS 8/27/98
              - V3.2a
           GET_CAL_HISTORY now echoes cal file ID - RJS 9/17/98 - V3.2b
           Force spin_zero monotonic - RJS 10/1/98 - V3.2c
           Updated  FDF in code FDF predict - RJS 10/7/98 - V3.2c
           Modified SPIN_TONE_FIT to return fit - RJS 10/7/98 - V3.2c
           Modified x/y upper scale factor (3.) in GET_TORQUER_MAG
              - RJS 10/13/98 -V3.2c

      Version 3.3 - Co-I release - RJS 03/27/99
           Included use_fdf flag to force use of FDF predict for spin_axis
               use_fdf is set for default
           Corrected single eclipse point bug in FIX_UP_SPIN
           Allowed is_sun to be passed into FIX_UP_SPIN in preparation for 
               spin phase patch
           Read the FDF predict from the calibration file - if available 
               Read by GET_CAL_HISTORY and passed up via GET_MAG_TWEAK
           Recalculate IGRF, included old_igrf keyword
               Included GET_NEW_IGRF in the library
               Included SET_IGRF_COEFFICIENTS in the library
               Included CALCULATE_IGRF in the library

      Version 3.3a - Improvements to 3.3
           Double Right Ascension pass in attitude tweak - RJS 4/14/99
           Include FDF predict in spin_axis structure - RJS 4/14/99
           Warning for data after end of calibration file 
              in GET_MAG_TWEAK - RJS 4/14/99
           Warning/Danger messages for data acquired during P12S7V
              anomaly, in GET_MAG_TWEAK - RJS 4/15/99
           Interim (not definitive) calibration for orbits 
              &gt; 9936 hard-wired in GET_MAG_TWEAK - RJS 4/14/99 
           No spline interpolation to model data in large
              (&gt; 60 s) data gaps - RJS 4/19/99

      Version 3.3b - Bug fix
           Fixed bug in INTERP_MAG, occurs when component does 
              not change sign - RJS 5/18/99

      Version 3.3c - Keyword addition
           Added USE_RGB keyword to force red green blue for vectors
              Allows for different color tables without affecting 
              vector plot. Set by Default - RJS 5/27/99

      Version 3.3d - Development version of nadir/sun phase patch - RJS 7/6/99
           1) Force the Sun-phase data into the &quot;OBJECT&quot;, takes
              care off cases where nadir data is used in sunlight (!)
              This cannot be turned off - applied when OBJECT NE 176
           2) Recalculate nadir-phase-derived sun-phase from ephemeris
              and FDF predict spin-axis
           3) Included a NO_PATCH keyword to disable the eclipse phase patch
           4) Rationalized keywords, so that a keyword not set is same 
              as default
                  NOT_RAW replaces USERAW
                  NO_TORQ replaces CALCTORQ
                  QUERY replaces NO_QUERY
                  NOT_FDF replaces USE_FDF
                  NOT_RGB replaces USE_RGB
           5) Included FORCE_PATCH keyword, forcing patch of eclipse data 
              even when data are good
         This version has a major bug in the use of get_fa_orbit -
         Fixed in version 3.3e

      Version 3.3e - Bug fixes  RJS 7/14/99
           1) Improved NOT_RAW switch - can use calibrated data, even
              if NOT_RAW isn't set, but issues a warning
           2) Force second call of GET_FA_ORBIT to force ephemeris data
              to have same time range as magnetometer data

      Version 3.3f - Clean up of V3.3e RJS 11/30/99
           1) Truncate orbit data, rather than recall GET_FA_ORBIT
           2) Sun phase determination and patches now in separate 
              routines - GET_PHASE_FROM_ATTCTRL and PATCH_SPIN_PHASE
           3) Replaced variable has_model with no_model for greater
              readability of code

      Version 3.4 - Interpolate calibration data - RJS 02/08/00
           1) Revised GET_CAL_HISTORY to preassign storage and
              determine reference orbits
           2) Revised GET_MAG_TWEAK to use linear interpolation 
              for coupling matrix, with constraint that one
              coupling matrix applies for the whole orbit 

      Version 3.5 - Spin-tone harmonic removal - RJS 06/10/00
           Use &quot;running average&quot; of spin tone residuals to remove
           spin-tone harmonics in the time domain.
           Disabled with NO_SPIN_TONE
           Under test at this version level.

      Version 3.6 - Include John Bonnell changes - RJS and JB 09/20/00
           1) Also store a velocity vector aligned delta-B
           2) Pass vector colors via VEC_COLS=[3,4,6] (e.g)
              to over-ride RGB default
           3) Pass the LABFLAG keyword to the vector tplot quantities
           Also included minor changes to version verification
           Modifications to documentation
           Included &quot;non-documented&quot; do_develop keyword

      Version 3.7 - Attitude tweak adjustments - RJS 01/17/01
           1) Revised diagnostic and timing output
           2) Re-instated the second attitude tweak
           3) Included an additional polynomial for the FDF
              predict structure, returned via GET_CAL_HISTORY

      Version 3.8 - Fix errors associated with large gaps - RJS 09/28/01
           1) Bug Fix - array dimension mismatch on vector rotation
           2) Disable torquer fix if over data gap
           3) Improve attitude and spin-phase tweaks including large gaps

      Version 3.8a - Bug Fix - RJS 11/26/01
           Fix problems with marking data gaps - code incorrectly
           handled multiple data gaps.

</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_despin.pro">general/missions/fast/fa_ops/ucla_mag_despin.pro</A>)</STRONG><P>
<HR>
 
<A NAME="UNWRAP">
<H2>UNWRAP</H2></A>
<A HREF="#UCLA_MAG_DESPIN">[Previous Routine]</A>
<A HREF="#UPDATE_FA_ATT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: UNWRAP

 PURPOSE:
 This function unwraps things that have been modulo'd by x, (like the
 output from atan), and positions the first point between 0 and x. X
 is 2Pi by default.
 
 INPUTS: PHASEC - an array of numbers, which may or may not have some
         jumps in it, which need to be unwrapped.

 KEYWORD PARAMETERS: DIVISOR - the size of the current range of
                     X. The default is 2Pi. 

 OUTPUTS: The return value is the unwrapped version of X. 

 EXAMPLE: big_long_line = unwrap(phase_angle)

 MODIFICATION HISTORY: Removed from FA_FIELDS_PHASE, 9-March-1998, by
                       Bill Peria UCB/SSL. 

</PRE><P>
<STRONG>(See <A href="fa_ops/unwrap.pro">general/missions/fast/fa_ops/unwrap.pro</A>)</STRONG><P>
<HR>
 
<A NAME="UPDATE_FA_ATT">
<H2>UPDATE_FA_ATT</H2></A>
<A HREF="#UNWRAP">[Previous Routine]</A>
<A HREF="#VAR_RANGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PRO: update_fa_att, start, finish
NAME: update_fa_att
PURPOSE:
Update attitude rows in database with level 0 attitude from FDF files.

INPUT:
  start   Any time acceptable by time_string()
  finish  Any time acceptable by time_string()

KEYWORDS:
  null    update only null rows. 

NOTE:
Affects events_data table. Uses $FASTCONFIG/fast_dbupdate.conf file
to get user, password, and database name to access the database to update.
</PRE><P>
<STRONG>(See <A href="fa_ops/update_fa_att.pro">general/missions/fast/fa_ops/update_fa_att.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VAR_RANGE">
<H2>VAR_RANGE</H2></A>
<A HREF="#UPDATE_FA_ATT">[Previous Routine]</A>
<A HREF="#VEL_DISP_FIT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: VAR_RANGE

 PURPOSE: To obtain the max and min values of an array, ignoring
          NaN's. Useful for passing to [XYZ]RANGE keywords. 

 CALLING SEQUENCE: yrange = var_range(y)
 
 INPUTS: Y - the array whose range is sought.  

 OUTPUTS: YRANGE - a two element array of the same type as Y. 

 RESTRICTIONS: If Y is of an improper type, then a message is
               displayed and NaN's are returned. The improper types
               are UNDEFINED, COMPLEX, DOUBLE COMPLEX, STRUCTURE, and
               STRING. 

 EXAMPLE: plot,x,y,xrange=var_range(x),yrange=var_range(y). 

 MODIFICATION HISTORY: Written summer 1996 by Bill Peria, UCB/SSL. 

</PRE><P>
<STRONG>(See <A href="fa_ops/var_range.pro">general/missions/fast/fa_ops/var_range.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VEL_DISP_FIT">
<H2>VEL_DISP_FIT</H2></A>
<A HREF="#VAR_RANGE">[Previous Routine]</A>
<A HREF="#VTH_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

 This program assumes a multi-line tplot is already in an
 IDL window, and allows users to click on dispersive peaks
 and plots time offset vs inverse velocity.  The slope of the
 line is the source distance.  The program assumes field-aligned
 fluxes in its source distance calculation.

 INPUTS:  None
 OUTPUT: Produces plot of time offset vs inverse velocity

 KEYWORDS:
 IONMASS  if keyword not set, assumes electrons.  Otherwise, set to
          m/q (in units of H+ m/q).
          Set to
          1 for H+
          2 for He++
          4 for He+
          16 for O+

  Written by Y-K Tung  96-11-29

  Modification history:   97-5-7  Y-K Tung  added keyword IONMASS
                          
</PRE><P>
<STRONG>(See <A href="fa_ops/vel_disp_fit.pro">general/missions/fast/fa_ops/vel_disp_fit.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VTH_2D">
<H2>VTH_2D</H2></A>
<A HREF="#VEL_DISP_FIT">[Previous Routine]</A>
<A HREF="#VTH_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	vth_2d((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the thermal velocity, [Vthx,Vthy,Vthz,Vthavg], km/s
NOTES:	
	Function calls p_2d.pro and n_2d.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	96-7-5
LAST MODIFICATION:
	98-8-18		J.McFadden	fixed factor of 2^.5 in vth definition
</PRE><P>
<STRONG>(See <A href="fa_ops/vth_2d.pro">general/missions/fast/fa_ops/vth_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="VTH_2D_FS">
<H2>VTH_2D_FS</H2></A>
<A HREF="#VTH_2D">[Previous Routine]</A>
<A HREF="#V_2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	vth_2d_fs((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the thermal velocity, [Vthx,Vthy,Vthz,Vthavg], km/s
NOTES:	
	Function calls p_2d_fs.pro and n_2d_fs.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden	98-8-19
LAST MODIFICATION:
	98-8-19		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/vth_2d_fs.pro">general/missions/fast/fa_ops/vth_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="V_2D">
<H2>V_2D</H2></A>
<A HREF="#VTH_2D_FS">[Previous Routine]</A>
<A HREF="#V_2D_B">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	v_2d((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the velocity, [Vx,Vy,Vz], km/s
NOTES:	
	Function calls j_2d.pro and n_2d.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden
LAST MODIFICATION:
	96-7-5		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/v_2d.pro">general/missions/fast/fa_ops/v_2d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="V_2D_B">
<H2>V_2D_B</H2></A>
<A HREF="#V_2D">[Previous Routine]</A>
<A HREF="#V_2D_FS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	v_2d_b((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the velocity, [Vx,Vy,Vz], km/s
NOTES:	
	Function calls j_2d_b.pro and n_2d_b.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden		97-7-11	
LAST MODIFICATION:
	97-7-11		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/v_2d_b.pro">general/missions/fast/fa_ops/v_2d_b.pro</A>)</STRONG><P>
<HR>
 
<A NAME="V_2D_FS">
<H2>V_2D_FS</H2></A>
<A HREF="#V_2D_B">[Previous Routine]</A>
<A HREF="#WCOPY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
FUNCTION:	v_2d_fs((dat,ENERGY=en,ERANGE=er,EBINS=ebins,ANGLE=an,ARANGE=ar,BINS=bins)
INPUT:	
	dat:	structure,	2d data structure filled by get_eesa_surv, get_eesa_burst, etc.
KEYWORDS
	ENERGY:	fltarr(2),	optional, min,max energy range for integration
	ERANGE:	fltarr(2),	optional, min,max energy bin numbers for integration
	EBINS:	bytarr(na),	optional, energy bins array for integration
					0,1=exclude,include,  
					na = dat.nenergy
	ANGLE:	fltarr(2),	optional, min,max pitch angle range for integration
	ARANGE:	fltarr(2),	optional, min,max angle bin numbers for integration
	BINS:	bytarr(nb),	optional, angle bins array for integration
					0,1=exclude,include,  
					nb = dat.ntheta
	BINS:	bytarr(na,nb),	optional, energy/angle bins array for integration
					0,1=exclude,include
PURPOSE:
	Returns the velocity, [Vx,Vy,Vz], km/s
NOTES:	
	Function calls j_2d_fs.pro and n_2d_fs.pro
	Function normally called by &quot;get_2dt.pro&quot; to generate 
	time series data for &quot;tplot.pro&quot;.

CREATED BY:
	J.McFadden		97-8-13	
LAST MODIFICATION:
	97-8-13		J.McFadden
</PRE><P>
<STRONG>(See <A href="fa_ops/v_2d_fs.pro">general/missions/fast/fa_ops/v_2d_fs.pro</A>)</STRONG><P>
<HR>
 
<A NAME="WCOPY">
<H2>WCOPY</H2></A>
<A HREF="#V_2D_FS">[Previous Routine]</A>
<A HREF="#WHAT_FA_SEES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>

  Copies the contents of one IDL window into another. By default,
  current graphics window is copied into a new window. Very handy to
  save a previous plot, for comparison with a new one. Tested only
  with X. 

</PRE><P>
<STRONG>(See <A href="fa_ops/wcopy.pro">general/missions/fast/fa_ops/wcopy.pro</A>)</STRONG><P>
<HR>
 
<A NAME="WHAT_FA_SEES">
<H2>WHAT_FA_SEES</H2></A>
<A HREF="#WCOPY">[Previous Routine]</A>
<A HREF="#WHAT_ORBIT_IS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

   what_fa_sees

 PURPOSE:

   Animation shows view of the Earth from FAST perspective.
   Includes Auroral ovals, footprint, and geographic path.
   Objects are correct at all time points rather than at just
   one reference point.
   This is just a skeleton of a procedure.

 ARGUMENTS:

   orbit

</PRE><P>
<STRONG>(See <A href="fa_ops/what_fa_sees.pro">general/missions/fast/fa_ops/what_fa_sees.pro</A>)</STRONG><P>
<HR>
 
<A NAME="WHAT_ORBIT_IS">
<H2>WHAT_ORBIT_IS</H2></A>
<A HREF="#WHAT_FA_SEES">[Previous Routine]</A>
<A HREF="#WRITE_AU_ULAW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: WHAT_ORBIT_IS

 PURPOSE: To quickly determine the orbit number at a particular time. 

 CALLING SEQUENCE: ORBIT = what_orbit_is(TIME)
 
 INPUTS: TIME - a string (YYYY-MM-DD/HH:MM) or a double precision
         number of seconds since 1970. If TIME is not defined, then
         the orbit number of the current orbit is given (provided
         your computers clock is set right. Check if
         time_to_str(systime(1)) gives you the current UT. 
        

 OUTPUTS: ORBIT - the orbit number, as defined by ORBGEN. 

 EXAMPLE: my_orbit = what_orbit_is('1996-08-21/12:00') (Note
                   that the correct answer is 1!)

 MODIFICATION HISTORY: Written 4-Mar-97 by Bill Peria UCB/SSL
       Re-written to use fast_archive database by Ken Bromund UCB/SSL

</PRE><P>
<STRONG>(See <A href="fa_ops/what_orbit_is.pro">general/missions/fast/fa_ops/what_orbit_is.pro</A>)</STRONG><P>
<HR>
 
<A NAME="WRITE_AU_ULAW">
<H2>WRITE_AU_ULAW</H2></A>
<A HREF="#WHAT_ORBIT_IS">[Previous Routine]</A>
<A HREF="#XYOUTS2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 PROCEDURE:

   write_au_ulaw.pro

 PURPOSE;

   Accepts an array of sound data to place into a Sun Audio file.

 ARGUMENTS:

   FILE     The name of the file to create.
   DATA     The data array.

 KEYWORDS:

   NOSCALE  Do not scale the data array to fit exactly in the range
            [0,255].  Normally, if the maximum value in the array is
            not 255, the array is scaled to take full advantage of
            the range available.  This keyword disables this scaling.
   RATE     The sampling rate.  Default is 8000 Hz.
   TEXT     A textual description to embed in the audio file.

 CREATED:

   By Joseph Rauchleiba
   1998/4/22
</PRE><P>
<STRONG>(See <A href="fa_ops/write_au_ulaw.pro">general/missions/fast/fa_ops/write_au_ulaw.pro</A>)</STRONG><P>
<HR>
 
<A NAME="XYOUTS2">
<H2>XYOUTS2</H2></A>
<A HREF="#WRITE_AU_ULAW">[Previous Routine]</A>
<A HREF="#YRFROM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
PROCEDURE:  xyouts2,[x,y,],string,pnorm=pnorm,_extra=e
INPUT:
	x,y	real,fltarr(n)		position on plot for string (optional)
					if not set, default to xyouts.pro
	string	string,strarr(n)	character string(s) to add to plot

KEYWORDS:
	PNORM:	0,1		If set, normalize to the current plot box
				If not set, default to xyouts.pro
PURPOSE:  
	Same as xyouts except will normalize to the current plot box

CREATED BY:	J.McFadden	97-3-10
LAST MODIFICATION:  97-3-10
MOD HISTORY
</PRE><P>
<STRONG>(See <A href="fa_ops/xyouts2.pro">general/missions/fast/fa_ops/xyouts2.pro</A>)</STRONG><P>
<HR>
 
<A NAME="YRFROM">
<H2>YRFROM</H2></A>
<A HREF="#XYOUTS2">[Previous Routine]</A>
<A HREF="#[6]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 FUNCTION:
 	 YRFROM

 DESCRIPTION:

	 Function to build an array of strings of the format:
 
	'YR-1-1' 

	given a start time in seconds since 1970.  

	The date in each string increases monotonically, in one year
	increments for the number of strings requested, from the 
	start time given.

 	Input parameters are the time to start the strings in seconds 
	since 1970, Jan 1, 00:00, and the number of strings to output.


 USAGE (SAMPLE CODE FRAGMENT):
 
    ; set an array of strings to month and year date representions

	date_strings = yrfrom(16156800.0,8)       ; 8 dates starting at 
                                                 ; 7 Jul 1970 0:0:0.00
    ; output result

	PRINT, date_strings

 --- Sample output would be

	70-1-1 71-1-1 72-1-1 73-1-1 74-1-1 75-1-1 76-1-1 77-1-1

 NOTES:

 	The start time in seconds is normally a float type, though
	this isn't necessary.

	If the input start time is negitive, this is an error, and the string
	'ERROR' is returned.

	If an array of start times is given, then a two dimensional array
	of dimensions (n_dates,N_ELEMENTS(inputs vals)) of stings will 
	be returned.

	This routine calls the function &quot;secdate&quot;.

 REVISION HISTORY:

	@(#)yrfrom.pro	1.3 08/18/95 	
 	Originally written by Jonathan M. Loran,  University of 
 	California at Berkeley, Space Sciences Lab.   Feb. '92

</PRE><P>
<STRONG>(See <A href="fa_ops/yrfrom.pro">general/missions/fast/fa_ops/yrfrom.pro</A>)</STRONG><P>
<HR>
 
<A NAME="[6]">
<H2>[6]</H2></A>
<A HREF="#YRFROM">[Previous Routine]</A>
<A HREF="#[7]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:

   INTERP_MAG

 PURPOSE:

   Interpolate the magnetometer data before backing out the recursive
   filter - this procedure should be applied to either raw or pseudo-
   sensor data

 CALLING SEQUENCE

   mag_int = interp_mag(mag_in)

 INPUTS:

   mag_in = vector of raw or pseudo sensor data

 OPTIONAL INPUTS:

   none

 KEYWORD PARAMETERS:

   none

 OUTPUTS:

   mag_int = interpolated magnetometer data

 EXAMPLE:

   magx_int = interp_mag(magx)

   The routine is usually called as part of the magnetometer analysis
     e.g. (NOTE this requires FAST_CALIBRATE = 0 in SDT), 
       mag1dc = get_fa_fields('Mag1dc_S',/all)
       mag2dc = get_fa_fields('Mag2dc_S',/all)
       mag3dc = get_fa_fields('Mag3dc_S',/all)
       raw2pseudo,mag1dc,mag2dc,mag3dc,mag_ps
       magx_int = interp_mag(mag_ps.x.nt)
       magy_int = interp_mag(mag_ps.y.nt)
       magz_int = interp_mag(mag_ps.z.nt)
       mag_ps.x.nt = magx_int
       mag_ps.y.nt = magy_int
       mag_ps.z.nt = magz_int
       fix_magx,mag_ps.x,magx_fix,timex_fix
       fix_magy,mag_ps.y,magy_fix,timey_fix
       fix_magz,mag_ps.z,magz_fix,timez_fix
       Apply/determine coupling matrix: 
       Matrix from orbit 601 determined 11/15/96
       0.984672    0.000000   -0.008604
       0.008272    0.928669   -0.014153 
       0.006700    0.006234    0.957579
       -65.60      20.52      -71.75           Offset
   mag_x = 0.984672d0*magx_fix+0.000000d0*magy_fix-0.008604d0*magz_fix + 65.60d0
   mag_y = 0.008272d0*magx_fix+0.928669d0*magy_fix-0.014153d0*magz_fix - 20.52d0
   mag_z = 0.006700d0*magx_fix+0.006234d0*magy_fix+0.957579d0*magz_fix + 71.75d0

       ?smooth?

   (eventually this sequence should be rationalized)

 MODIFICATION HISTORY:

   written by R. J. Strangeway 1/31/97
   Modified by R. J. Strangeway 1/22/99 to ensure end points kept

   Modified by R. J. Strangeway 5/18/99 to correct &quot;-1&quot; in index arrays

</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_lib.pro">general/missions/fast/fa_ops/ucla_mag_lib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="[7]">
<H2>[7]</H2></A>
<A HREF="#[6]">[Previous Routine]</A>
<A HREF="#[8]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 

   FIX_MAGX

 PURPOSE:

   Fix the mag dc data by backing out the recursive filter

   This procedure returns the &quot;fixed&quot; data at the same time steps
   as input. i.e., this procedure should be used on the reference
   component - bx or mag3

 CALLING SEQUENCE:

   fix_magx,magx,mag_fix,time_fix

 INPUTS:

   magx = structure of pseudo spacecraft x-component magnetometer data
          Usually returned as sub-structure from raw2pseudo

 OPTIONAL INPUTS:

   none

 KEYWORD PARAMETERS:

   none

 OUTPUTS:

   mag_fix = fixed magnetometer data
   time_fix = time tag array for the fixed data

 EXAMPLE:

   fix_magx,mag_ps.x,fix_mag_x,fix_time_x

 MODIFICATION HISTORY

   written by R. J. Strangeway 11/12/96
   modified by RJS 2/27/97 to take into account 1/64 delta-t time shift
   between components
   modified by R. J. Strangeway 4/30/97 to include a time shift
   of -1/16 delta-t (earlier) to correct for absolute timing errors

</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_lib.pro">general/missions/fast/fa_ops/ucla_mag_lib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="[8]">
<H2>[8]</H2></A>
<A HREF="#[7]">[Previous Routine]</A>
<A HREF="#[9]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 

   FIX_MAGY

 PURPOSE:

   Fix the mag dc data by backing out the recursive filter and
   interpolate the data to 1/4 of a time_step later

   This procedure returns the &quot;fixed&quot; data with a quarter time step shift.
   This procedure should be used on the component acquired just
   before the reference component - i.e. by or mag2

 CALLING SEQUENCE:

   fix_magy,magy,mag_fix,time_fix

 INPUTS:

   magy = structure of pseudo spacecraft y-component magnetometer data
          Usually returned as sub-structure from raw2pseudo

 OPTIONAL INPUTS:

   none

 KEYWORD PARAMETERS:

   none

 OUTPUTS:

   mag_fix = fixed magnetometer data
   time_fix = time tag array for the fixed data

 EXAMPLE:

   fix_magy,mag_ps.y,fix_mag_y,fix_time_y

 MODIFICATION HISTORY

   written by R. J. Strangeway 11/12/96
   modified by RJS 2/27/97 to take into account 1/64 delta-t time shift
   between components
   modified by R. J. Strangeway 4/30/97 to include a time shift
   of -1/16 delta-t (earlier) to correct for absolute timing errors

</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_lib.pro">general/missions/fast/fa_ops/ucla_mag_lib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="[9]">
<H2>[9]</H2></A>
<A HREF="#[8]">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 

   FIX_MAGZ

 PURPOSE:

   Fix the mag dc data by backing out the recursive filter and
   interpolate the data to 1/2 of a time_step later

   This procedure returns the &quot;fixed&quot; data with a half time step shift.
   This procedure should be used on the component acquired first
   before the reference component - i.e. bz or mag1

 CALLING SEQUENCE:

   fix_magz,magz,mag_fix,time_fix

 INPUTS:

   magz = structure of pseudo spacecraft z-component magnetometer data
          Usually returned as sub-structure from raw2pseudo

 OPTIONAL INPUTS:

   none

 KEYWORD PARAMETERS:

   none

 OUTPUTS:

   mag_fix = fixed magnetometer data
   time_fix = time tag array for the fixed data

 EXAMPLE:

   fix_magz,mag_ps.z,fix_mag_z,fix_time_z

 MODIFICATION HISTORY

   written by R. J. Strangeway 11/12/96
   modified by RJS 2/27/97 to take into account 1/64 delta-t time shift
   between components
   modified by R. J. Strangeway 4/30/97 to include a time shift
   of -1/16 delta-t (earlier) to correct for absolute timing errors

</PRE><P>
<STRONG>(See <A href="fa_ops/ucla_mag_lib.pro">general/missions/fast/fa_ops/ucla_mag_lib.pro</A>)</STRONG><P>
<HR>
 
